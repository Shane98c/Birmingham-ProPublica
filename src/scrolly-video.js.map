{"version":3,"file":"scrolly-video.js","sources":["../node_modules/svelte/internal/index.mjs","../node_modules/ua-parser-js/src/ua-parser.js","../node_modules/mp4box/dist/mp4box.all.js","../src/videoDecoder.js","../src/ScrollyVideo.svelte"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element.sheet;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentElement !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes, is_svg) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration(undefined, is_svg);\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes, is_svg);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    if (value === null) {\n        node.style.removeProperty(key);\n    }\n    else {\n        node.style.setProperty(key, value, important ? 'important' : '');\n    }\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    select.selectedIndex = -1; // no option should be selected\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, cancelable, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(is_svg = false) {\n        this.is_svg = false;\n        this.is_svg = is_svg;\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            if (this.is_svg)\n                this.e = svg_element(target.nodeName);\n            else\n                this.e = element(target.nodeName);\n            this.t = target;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes, is_svg = false) {\n        super(is_svg);\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\nconst managed_styles = new Map();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_style_information(doc, node) {\n    const info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n    managed_styles.set(doc, info);\n    return info;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    const { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n    if (!rules[name]) {\n        rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        managed_styles.forEach(info => {\n            const { stylesheet } = info;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            info.rules = {};\n        });\n        managed_styles.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail, { cancelable = false } = {}) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail, { cancelable });\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n            return !event.defaultPrevented;\n        }\n        return true;\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n    return context;\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\nlet flushidx = 0; // Do *not* move this inside the flush() function\nfunction flush() {\n    const saved_component = current_component;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        while (flushidx < dirty_components.length) {\n            const component = dirty_components[flushidx];\n            flushidx++;\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        flushidx = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    seen_callbacks.clear();\n    set_current_component(saved_component);\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n    else if (callback) {\n        callback();\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst void_element_names = /^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;\nfunction is_void(name) {\n    return void_element_names.test(name) || name.toLowerCase() === '!doctype';\n}\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, attrs_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (attrs_to_add) {\n        const classes_to_add = attrs_to_add.classes;\n        const styles_to_add = attrs_to_add.styles;\n        if (classes_to_add) {\n            if (attributes.class == null) {\n                attributes.class = classes_to_add;\n            }\n            else {\n                attributes.class += ' ' + classes_to_add;\n            }\n        }\n        if (styles_to_add) {\n            if (attributes.style == null) {\n                attributes.style = style_object_to_string(styles_to_add);\n            }\n            else {\n                attributes.style = style_object_to_string(merge_ssr_styles(attributes.style, styles_to_add));\n            }\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nfunction merge_ssr_styles(style_attribute, style_directive) {\n    const style_object = {};\n    for (const individual_style of style_attribute.split(';')) {\n        const colon_index = individual_style.indexOf(':');\n        const name = individual_style.slice(0, colon_index).trim();\n        const value = individual_style.slice(colon_index + 1).trim();\n        if (!name)\n            continue;\n        style_object[name] = value;\n    }\n    for (const name in style_directive) {\n        const value = style_directive[name];\n        if (value) {\n            style_object[name] = value;\n        }\n        else {\n            delete style_object[name];\n        }\n    }\n    return style_object;\n}\nconst ATTR_REGEX = /[&\"]/g;\nconst CONTENT_REGEX = /[&<]/g;\n/**\n * Note: this method is performance sensitive and has been optimized\n * https://github.com/sveltejs/svelte/pull/5701\n */\nfunction escape(value, is_attr = false) {\n    const str = String(value);\n    const pattern = is_attr ? ATTR_REGEX : CONTENT_REGEX;\n    pattern.lastIndex = 0;\n    let escaped = '';\n    let last = 0;\n    while (pattern.test(str)) {\n        const i = pattern.lastIndex - 1;\n        const ch = str[i];\n        escaped += str.substring(last, i) + (ch === '&' ? '&amp;' : (ch === '\"' ? '&quot;' : '&lt;'));\n        last = i + 1;\n    }\n    return escaped + str.substring(last);\n}\nfunction escape_attribute_value(value) {\n    // keep booleans, null, and undefined for the sake of `spread`\n    const should_escape = typeof value === 'string' || (value && typeof value === 'object');\n    return should_escape ? escape(value, true) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    const assignment = (boolean && value === true) ? '' : `=\"${escape(value, true)}\"`;\n    return ` ${name}${assignment}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\nfunction style_object_to_string(style_object) {\n    return Object.keys(style_object)\n        .filter(key => style_object[key])\n        .map(key => `${key}: ${style_object[key]};`)\n        .join(' ');\n}\nfunction add_styles(style_object) {\n    const styles = style_object_to_string(style_object);\n    return styles ? ` style=\"${styles}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = on_mount.map(run).filter(is_function);\n            if (on_destroy) {\n                on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.49.0' }, detail), { bubbles: true }));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nfunction validate_dynamic_element(tag) {\n    const is_string = typeof tag === 'string';\n    if (tag && !is_string) {\n        throw new Error('<svelte:element> expects \"this\" attribute to be a string.');\n    }\n}\nfunction validate_void_dynamic_element(tag) {\n    if (tag && is_void(tag)) {\n        throw new Error(`<svelte:element this=\"${tag}\"> is self-closing and cannot have content.`);\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_styles, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, is_void, listen, listen_dev, loop, loop_guard, merge_ssr_styles, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, src_url_equal, start_hydrating, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_dynamic_element, validate_each_argument, validate_each_keys, validate_slots, validate_store, validate_void_dynamic_element, xlink_attr };\n","/////////////////////////////////////////////////////////////////////////////////\n/* UAParser.js v1.0.2\n   Copyright © 2012-2021 Faisal Salman <f@faisalman.com>\n   MIT License *//*\n   Detect Browser, Engine, OS, CPU, and Device type/model from User-Agent data.\n   Supports browser & node.js environment. \n   Demo   : https://faisalman.github.io/ua-parser-js\n   Source : https://github.com/faisalman/ua-parser-js */\n/////////////////////////////////////////////////////////////////////////////////\n\n(function (window, undefined) {\n\n    'use strict';\n\n    //////////////\n    // Constants\n    /////////////\n\n\n    var LIBVERSION  = '1.0.2',\n        EMPTY       = '',\n        UNKNOWN     = '?',\n        FUNC_TYPE   = 'function',\n        UNDEF_TYPE  = 'undefined',\n        OBJ_TYPE    = 'object',\n        STR_TYPE    = 'string',\n        MAJOR       = 'major',\n        MODEL       = 'model',\n        NAME        = 'name',\n        TYPE        = 'type',\n        VENDOR      = 'vendor',\n        VERSION     = 'version',\n        ARCHITECTURE= 'architecture',\n        CONSOLE     = 'console',\n        MOBILE      = 'mobile',\n        TABLET      = 'tablet',\n        SMARTTV     = 'smarttv',\n        WEARABLE    = 'wearable',\n        EMBEDDED    = 'embedded',\n        UA_MAX_LENGTH = 255;\n\n    var AMAZON  = 'Amazon',\n        APPLE   = 'Apple',\n        ASUS    = 'ASUS',\n        BLACKBERRY = 'BlackBerry',\n        BROWSER = 'Browser',\n        CHROME  = 'Chrome',\n        EDGE    = 'Edge',\n        FIREFOX = 'Firefox',\n        GOOGLE  = 'Google',\n        HUAWEI  = 'Huawei',\n        LG      = 'LG',\n        MICROSOFT = 'Microsoft',\n        MOTOROLA  = 'Motorola',\n        OPERA   = 'Opera',\n        SAMSUNG = 'Samsung',\n        SONY    = 'Sony',\n        XIAOMI  = 'Xiaomi',\n        ZEBRA   = 'Zebra',\n        FACEBOOK   = 'Facebook';\n\n    ///////////\n    // Helper\n    //////////\n\n    var extend = function (regexes, extensions) {\n            var mergedRegexes = {};\n            for (var i in regexes) {\n                if (extensions[i] && extensions[i].length % 2 === 0) {\n                    mergedRegexes[i] = extensions[i].concat(regexes[i]);\n                } else {\n                    mergedRegexes[i] = regexes[i];\n                }\n            }\n            return mergedRegexes;\n        },\n        enumerize = function (arr) {\n            var enums = {};\n            for (var i=0; i<arr.length; i++) {\n                enums[arr[i].toUpperCase()] = arr[i];\n            }\n            return enums;\n        },\n        has = function (str1, str2) {\n            return typeof str1 === STR_TYPE ? lowerize(str2).indexOf(lowerize(str1)) !== -1 : false;\n        },\n        lowerize = function (str) {\n            return str.toLowerCase();\n        },\n        majorize = function (version) {\n            return typeof(version) === STR_TYPE ? version.replace(/[^\\d\\.]/g, EMPTY).split('.')[0] : undefined;\n        },\n        trim = function (str, len) {\n            if (typeof(str) === STR_TYPE) {\n                str = str.replace(/^\\s\\s*/, EMPTY).replace(/\\s\\s*$/, EMPTY);\n                return typeof(len) === UNDEF_TYPE ? str : str.substring(0, UA_MAX_LENGTH);\n            }\n    };\n\n    ///////////////\n    // Map helper\n    //////////////\n\n    var rgxMapper = function (ua, arrays) {\n\n            var i = 0, j, k, p, q, matches, match;\n\n            // loop through all regexes maps\n            while (i < arrays.length && !matches) {\n\n                var regex = arrays[i],       // even sequence (0,2,4,..)\n                    props = arrays[i + 1];   // odd sequence (1,3,5,..)\n                j = k = 0;\n\n                // try matching uastring with regexes\n                while (j < regex.length && !matches) {\n\n                    matches = regex[j++].exec(ua);\n\n                    if (!!matches) {\n                        for (p = 0; p < props.length; p++) {\n                            match = matches[++k];\n                            q = props[p];\n                            // check if given property is actually array\n                            if (typeof q === OBJ_TYPE && q.length > 0) {\n                                if (q.length === 2) {\n                                    if (typeof q[1] == FUNC_TYPE) {\n                                        // assign modified match\n                                        this[q[0]] = q[1].call(this, match);\n                                    } else {\n                                        // assign given value, ignore regex match\n                                        this[q[0]] = q[1];\n                                    }\n                                } else if (q.length === 3) {\n                                    // check whether function or regex\n                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                                        // call function (usually string mapper)\n                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n                                    } else {\n                                        // sanitize match using given regex\n                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n                                    }\n                                } else if (q.length === 4) {\n                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n                                }\n                            } else {\n                                this[q] = match ? match : undefined;\n                            }\n                        }\n                    }\n                }\n                i += 2;\n            }\n        },\n\n        strMapper = function (str, map) {\n\n            for (var i in map) {\n                // check if current value is array\n                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n                    for (var j = 0; j < map[i].length; j++) {\n                        if (has(map[i][j], str)) {\n                            return (i === UNKNOWN) ? undefined : i;\n                        }\n                    }\n                } else if (has(map[i], str)) {\n                    return (i === UNKNOWN) ? undefined : i;\n                }\n            }\n            return str;\n    };\n\n    ///////////////\n    // String map\n    //////////////\n\n    // Safari < 3.0\n    var oldSafariMap = {\n            '1.0'   : '/8',\n            '1.2'   : '/1',\n            '1.3'   : '/3',\n            '2.0'   : '/412',\n            '2.0.2' : '/416',\n            '2.0.3' : '/417',\n            '2.0.4' : '/419',\n            '?'     : '/'\n        },\n        windowsVersionMap = {\n            'ME'        : '4.90',\n            'NT 3.11'   : 'NT3.51',\n            'NT 4.0'    : 'NT4.0',\n            '2000'      : 'NT 5.0',\n            'XP'        : ['NT 5.1', 'NT 5.2'],\n            'Vista'     : 'NT 6.0',\n            '7'         : 'NT 6.1',\n            '8'         : 'NT 6.2',\n            '8.1'       : 'NT 6.3',\n            '10'        : ['NT 6.4', 'NT 10.0'],\n            'RT'        : 'ARM'\n    };\n\n    //////////////\n    // Regex map\n    /////////////\n\n    var regexes = {\n\n        browser : [[\n\n            /\\b(?:crmo|crios)\\/([\\w\\.]+)/i                                      // Chrome for Android/iOS\n            ], [VERSION, [NAME, 'Chrome']], [\n            /edg(?:e|ios|a)?\\/([\\w\\.]+)/i                                       // Microsoft Edge\n            ], [VERSION, [NAME, 'Edge']], [\n\n            // Presto based\n            /(opera mini)\\/([-\\w\\.]+)/i,                                        // Opera Mini\n            /(opera [mobiletab]{3,6})\\b.+version\\/([-\\w\\.]+)/i,                 // Opera Mobi/Tablet\n            /(opera)(?:.+version\\/|[\\/ ]+)([\\w\\.]+)/i                           // Opera\n            ], [NAME, VERSION], [\n            /opios[\\/ ]+([\\w\\.]+)/i                                             // Opera mini on iphone >= 8.0\n            ], [VERSION, [NAME, OPERA+' Mini']], [\n            /\\bopr\\/([\\w\\.]+)/i                                                 // Opera Webkit\n            ], [VERSION, [NAME, OPERA]], [\n\n            // Mixed\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(lunascape|maxthon|netfront|jasmine|blazer)[\\/ ]?([\\w\\.]*)/i,      // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n            // Trident based\n            /(avant |iemobile|slim)(?:browser)?[\\/ ]?([\\w\\.]*)/i,               // Avant/IEMobile/SlimBrowser\n            /(ba?idubrowser)[\\/ ]?([\\w\\.]+)/i,                                  // Baidu Browser\n            /(?:ms|\\()(ie) ([\\w\\.]+)/i,                                         // Internet Explorer\n\n            // Webkit/KHTML based                                               // Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon\n            /(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\\/([-\\w\\.]+)/i,\n                                                                                // Rekonq/Puffin/Brave/Whale/QQBrowserLite/QQ, aka ShouQ\n            /(weibo)__([\\d\\.]+)/i                                               // Weibo\n            ], [NAME, VERSION], [\n            /(?:\\buc? ?browser|(?:juc.+)ucweb)[\\/ ]?([\\w\\.]+)/i                 // UCBrowser\n            ], [VERSION, [NAME, 'UC'+BROWSER]], [\n            /\\bqbcore\\/([\\w\\.]+)/i                                              // WeChat Desktop for Windows Built-in Browser\n            ], [VERSION, [NAME, 'WeChat(Win) Desktop']], [\n            /micromessenger\\/([\\w\\.]+)/i                                        // WeChat\n            ], [VERSION, [NAME, 'WeChat']], [\n            /konqueror\\/([\\w\\.]+)/i                                             // Konqueror\n            ], [VERSION, [NAME, 'Konqueror']], [\n            /trident.+rv[: ]([\\w\\.]{1,9})\\b.+like gecko/i                       // IE11\n            ], [VERSION, [NAME, 'IE']], [\n            /yabrowser\\/([\\w\\.]+)/i                                             // Yandex\n            ], [VERSION, [NAME, 'Yandex']], [\n            /(avast|avg)\\/([\\w\\.]+)/i                                           // Avast/AVG Secure Browser\n            ], [[NAME, /(.+)/, '$1 Secure '+BROWSER], VERSION], [\n            /\\bfocus\\/([\\w\\.]+)/i                                               // Firefox Focus\n            ], [VERSION, [NAME, FIREFOX+' Focus']], [\n            /\\bopt\\/([\\w\\.]+)/i                                                 // Opera Touch\n            ], [VERSION, [NAME, OPERA+' Touch']], [\n            /coc_coc\\w+\\/([\\w\\.]+)/i                                            // Coc Coc Browser\n            ], [VERSION, [NAME, 'Coc Coc']], [\n            /dolfin\\/([\\w\\.]+)/i                                                // Dolphin\n            ], [VERSION, [NAME, 'Dolphin']], [\n            /coast\\/([\\w\\.]+)/i                                                 // Opera Coast\n            ], [VERSION, [NAME, OPERA+' Coast']], [\n            /miuibrowser\\/([\\w\\.]+)/i                                           // MIUI Browser\n            ], [VERSION, [NAME, 'MIUI '+BROWSER]], [\n            /fxios\\/([-\\w\\.]+)/i                                                // Firefox for iOS\n            ], [VERSION, [NAME, FIREFOX]], [\n            /\\bqihu|(qi?ho?o?|360)browser/i                                     // 360\n            ], [[NAME, '360 '+BROWSER]], [\n            /(oculus|samsung|sailfish)browser\\/([\\w\\.]+)/i\n            ], [[NAME, /(.+)/, '$1 '+BROWSER], VERSION], [                      // Oculus/Samsung/Sailfish Browser\n            /(comodo_dragon)\\/([\\w\\.]+)/i                                       // Comodo Dragon\n            ], [[NAME, /_/g, ' '], VERSION], [\n            /(electron)\\/([\\w\\.]+) safari/i,                                    // Electron-based App\n            /(tesla)(?: qtcarbrowser|\\/(20\\d\\d\\.[-\\w\\.]+))/i,                   // Tesla\n            /m?(qqbrowser|baiduboxapp|2345Explorer)[\\/ ]?([\\w\\.]+)/i            // QQBrowser/Baidu App/2345 Browser\n            ], [NAME, VERSION], [\n            /(metasr)[\\/ ]?([\\w\\.]+)/i,                                         // SouGouBrowser\n            /(lbbrowser)/i                                                      // LieBao Browser\n            ], [NAME], [\n\n            // WebView\n            /((?:fban\\/fbios|fb_iab\\/fb4a)(?!.+fbav)|;fbav\\/([\\w\\.]+);)/i       // Facebook App for iOS & Android\n            ], [[NAME, FACEBOOK], VERSION], [\n            /safari (line)\\/([\\w\\.]+)/i,                                        // Line App for iOS\n            /\\b(line)\\/([\\w\\.]+)\\/iab/i,                                        // Line App for Android\n            /(chromium|instagram)[\\/ ]([-\\w\\.]+)/i                              // Chromium/Instagram\n            ], [NAME, VERSION], [\n            /\\bgsa\\/([\\w\\.]+) .*safari\\//i                                      // Google Search Appliance on iOS\n            ], [VERSION, [NAME, 'GSA']], [\n\n            /headlesschrome(?:\\/([\\w\\.]+)| )/i                                  // Chrome Headless\n            ], [VERSION, [NAME, CHROME+' Headless']], [\n\n            / wv\\).+(chrome)\\/([\\w\\.]+)/i                                       // Chrome WebView\n            ], [[NAME, CHROME+' WebView'], VERSION], [\n\n            /droid.+ version\\/([\\w\\.]+)\\b.+(?:mobile safari|safari)/i           // Android Browser\n            ], [VERSION, [NAME, 'Android '+BROWSER]], [\n\n            /(chrome|omniweb|arora|[tizenoka]{5} ?browser)\\/v?([\\w\\.]+)/i       // Chrome/OmniWeb/Arora/Tizen/Nokia\n            ], [NAME, VERSION], [\n\n            /version\\/([\\w\\.]+) .*mobile\\/\\w+ (safari)/i                        // Mobile Safari\n            ], [VERSION, [NAME, 'Mobile Safari']], [\n            /version\\/([\\w\\.]+) .*(mobile ?safari|safari)/i                     // Safari & Safari Mobile\n            ], [VERSION, NAME], [\n            /webkit.+?(mobile ?safari|safari)(\\/[\\w\\.]+)/i                      // Safari < 3.0\n            ], [NAME, [VERSION, strMapper, oldSafariMap]], [\n\n            /(webkit|khtml)\\/([\\w\\.]+)/i\n            ], [NAME, VERSION], [\n\n            // Gecko based\n            /(navigator|netscape\\d?)\\/([-\\w\\.]+)/i                              // Netscape\n            ], [[NAME, 'Netscape'], VERSION], [\n            /mobile vr; rv:([\\w\\.]+)\\).+firefox/i                               // Firefox Reality\n            ], [VERSION, [NAME, FIREFOX+' Reality']], [\n            /ekiohf.+(flow)\\/([\\w\\.]+)/i,                                       // Flow\n            /(swiftfox)/i,                                                      // Swiftfox\n            /(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\\/ ]?([\\w\\.\\+]+)/i,\n                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror/Klar\n            /(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([-\\w\\.]+)$/i,\n                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n            /(firefox)\\/([\\w\\.]+)/i,                                            // Other Firefox-based\n            /(mozilla)\\/([\\w\\.]+) .+rv\\:.+gecko\\/\\d+/i,                         // Mozilla\n\n            // Other\n            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\\. ]?browser)[-\\/ ]?v?([\\w\\.]+)/i,\n                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir/Obigo/Mosaic/Go/ICE/UP.Browser\n            /(links) \\(([\\w\\.]+)/i                                              // Links\n            ], [NAME, VERSION]\n        ],\n\n        cpu : [[\n\n            /(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\\)]/i                     // AMD64 (x64)\n            ], [[ARCHITECTURE, 'amd64']], [\n\n            /(ia32(?=;))/i                                                      // IA32 (quicktime)\n            ], [[ARCHITECTURE, lowerize]], [\n\n            /((?:i[346]|x)86)[;\\)]/i                                            // IA32 (x86)\n            ], [[ARCHITECTURE, 'ia32']], [\n\n            /\\b(aarch64|arm(v?8e?l?|_?64))\\b/i                                 // ARM64\n            ], [[ARCHITECTURE, 'arm64']], [\n\n            /\\b(arm(?:v[67])?ht?n?[fl]p?)\\b/i                                   // ARMHF\n            ], [[ARCHITECTURE, 'armhf']], [\n\n            // PocketPC mistakenly identified as PowerPC\n            /windows (ce|mobile); ppc;/i\n            ], [[ARCHITECTURE, 'arm']], [\n\n            /((?:ppc|powerpc)(?:64)?)(?: mac|;|\\))/i                            // PowerPC\n            ], [[ARCHITECTURE, /ower/, EMPTY, lowerize]], [\n\n            /(sun4\\w)[;\\)]/i                                                    // SPARC\n            ], [[ARCHITECTURE, 'sparc']], [\n\n            /((?:avr32|ia64(?=;))|68k(?=\\))|\\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\\b|pa-risc)/i\n                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n            ], [[ARCHITECTURE, lowerize]]\n        ],\n\n        device : [[\n\n            //////////////////////////\n            // MOBILES & TABLETS\n            // Ordered by popularity\n            /////////////////////////\n\n            // Samsung\n            /\\b(sch-i[89]0\\d|shw-m380s|sm-[pt]\\w{2,4}|gt-[pn]\\d{2,4}|sgh-t8[56]9|nexus 10)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, TABLET]], [\n            /\\b((?:s[cgp]h|gt|sm)-\\w+|galaxy nexus)/i,\n            /samsung[- ]([-\\w]+)/i,\n            /sec-(sgh\\w+)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, MOBILE]], [\n\n            // Apple\n            /\\((ip(?:hone|od)[\\w ]*);/i                                         // iPod/iPhone\n            ], [MODEL, [VENDOR, APPLE], [TYPE, MOBILE]], [\n            /\\((ipad);[-\\w\\),; ]+apple/i,                                       // iPad\n            /applecoremedia\\/[\\w\\.]+ \\((ipad)/i,\n            /\\b(ipad)\\d\\d?,\\d\\d?[;\\]].+ios/i\n            ], [MODEL, [VENDOR, APPLE], [TYPE, TABLET]], [\n\n            // Huawei\n            /\\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\\d{2})\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, TABLET]], [\n            /(?:huawei|honor)([-\\w ]+)[;\\)]/i,\n            /\\b(nexus 6p|\\w{2,4}-[atu]?[ln][01259x][012359][an]?)\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, MOBILE]], [\n\n            // Xiaomi\n            /\\b(poco[\\w ]+)(?: bui|\\))/i,                                       // Xiaomi POCO\n            /\\b; (\\w+) build\\/hm\\1/i,                                           // Xiaomi Hongmi 'numeric' models\n            /\\b(hm[-_ ]?note?[_ ]?(?:\\d\\w)?) bui/i,                             // Xiaomi Hongmi\n            /\\b(redmi[\\-_ ]?(?:note|k)?[\\w_ ]+)(?: bui|\\))/i,                   // Xiaomi Redmi\n            /\\b(mi[-_ ]?(?:a\\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\\d?\\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\\))/i // Xiaomi Mi\n            ], [[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, MOBILE]], [\n            /\\b(mi[-_ ]?(?:pad)(?:[\\w_ ]+))(?: bui|\\))/i                        // Mi Pad tablets\n            ],[[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, TABLET]], [\n\n            // OPPO\n            /; (\\w+) bui.+ oppo/i,\n            /\\b(cph[12]\\d{3}|p(?:af|c[al]|d\\w|e[ar])[mt]\\d0|x9007|a101op)\\b/i\n            ], [MODEL, [VENDOR, 'OPPO'], [TYPE, MOBILE]], [\n\n            // Vivo\n            /vivo (\\w+)(?: bui|\\))/i,\n            /\\b(v[12]\\d{3}\\w?[at])(?: bui|;)/i\n            ], [MODEL, [VENDOR, 'Vivo'], [TYPE, MOBILE]], [\n\n            // Realme\n            /\\b(rmx[12]\\d{3})(?: bui|;|\\))/i\n            ], [MODEL, [VENDOR, 'Realme'], [TYPE, MOBILE]], [\n\n            // Motorola\n            /\\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\\b[\\w ]+build\\//i,\n            /\\bmot(?:orola)?[- ](\\w*)/i,\n            /((?:moto[\\w\\(\\) ]+|xt\\d{3,4}|nexus 6)(?= bui|\\)))/i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, MOBILE]], [\n            /\\b(mz60\\d|xoom[2 ]{0,2}) build\\//i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, TABLET]], [\n\n            // LG\n            /((?=lg)?[vl]k\\-?\\d{3}) bui| 3\\.[-\\w; ]{10}lg?-([06cv9]{3,4})/i\n            ], [MODEL, [VENDOR, LG], [TYPE, TABLET]], [\n            /(lm(?:-?f100[nv]?|-[\\w\\.]+)(?= bui|\\))|nexus [45])/i,\n            /\\blg[-e;\\/ ]+((?!browser|netcast|android tv)\\w+)/i,\n            /\\blg-?([\\d\\w]+) bui/i\n            ], [MODEL, [VENDOR, LG], [TYPE, MOBILE]], [\n\n            // Lenovo\n            /(ideatab[-\\w ]+)/i,\n            /lenovo ?(s[56]000[-\\w]+|tab(?:[\\w ]+)|yt[-\\d\\w]{6}|tb[-\\d\\w]{6})/i\n            ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [\n\n            // Nokia\n            /(?:maemo|nokia).*(n900|lumia \\d+)/i,\n            /nokia[-_ ]?([-\\w\\.]*)/i\n            ], [[MODEL, /_/g, ' '], [VENDOR, 'Nokia'], [TYPE, MOBILE]], [\n\n            // Google\n            /(pixel c)\\b/i                                                      // Google Pixel C\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, TABLET]], [\n            /droid.+; (pixel[\\daxl ]{0,6})(?: bui|\\))/i                         // Google Pixel\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, MOBILE]], [\n\n            // Sony\n            /droid.+ ([c-g]\\d{4}|so[-gl]\\w+|xq-a\\w[4-7][12])(?= bui|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i\n            ], [MODEL, [VENDOR, SONY], [TYPE, MOBILE]], [\n            /sony tablet [ps]/i,\n            /\\b(?:sony)?sgp\\w+(?: bui|\\))/i\n            ], [[MODEL, 'Xperia Tablet'], [VENDOR, SONY], [TYPE, TABLET]], [\n\n            // OnePlus\n            / (kb2005|in20[12]5|be20[12][59])\\b/i,\n            /(?:one)?(?:plus)? (a\\d0\\d\\d)(?: b|\\))/i\n            ], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [\n\n            // Amazon\n            /(alexa)webm/i,\n            /(kf[a-z]{2}wi)( bui|\\))/i,                                         // Kindle Fire without Silk\n            /(kf[a-z]+)( bui|\\)).+silk\\//i                                      // Kindle Fire HD\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, TABLET]], [\n            /((?:sd|kf)[0349hijorstuw]+)( bui|\\)).+silk\\//i                     // Fire Phone\n            ], [[MODEL, /(.+)/g, 'Fire Phone $1'], [VENDOR, AMAZON], [TYPE, MOBILE]], [\n\n            // BlackBerry\n            /(playbook);[-\\w\\),; ]+(rim)/i                                      // BlackBerry PlayBook\n            ], [MODEL, VENDOR, [TYPE, TABLET]], [\n            /\\b((?:bb[a-f]|st[hv])100-\\d)/i,\n            /\\(bb10; (\\w+)/i                                                    // BlackBerry 10\n            ], [MODEL, [VENDOR, BLACKBERRY], [TYPE, MOBILE]], [\n\n            // Asus\n            /(?:\\b|asus_)(transfo[prime ]{4,10} \\w+|eeepc|slider \\w+|nexus 7|padfone|p00[cj])/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, TABLET]], [\n            / (z[bes]6[027][012][km][ls]|zenfone \\d\\w?)\\b/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, MOBILE]], [\n\n            // HTC\n            /(nexus 9)/i                                                        // HTC Nexus 9\n            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [\n            /(htc)[-;_ ]{1,2}([\\w ]+(?=\\)| bui)|\\w+)/i,                         // HTC\n\n            // ZTE\n            /(zte)[- ]([\\w ]+?)(?: bui|\\/|\\))/i,\n            /(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\\w]*)/i         // Alcatel/GeeksPhone/Nexian/Panasonic/Sony\n            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [\n\n            // Acer\n            /droid.+; ([ab][1-7]-?[0178a]\\d\\d?)/i\n            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [\n\n            // Meizu\n            /droid.+; (m[1-5] note) bui/i,\n            /\\bmz-([-\\w]{2,})/i\n            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [\n\n            // Sharp\n            /\\b(sh-?[altvz]?\\d\\d[a-ekm]?)/i\n            ], [MODEL, [VENDOR, 'Sharp'], [TYPE, MOBILE]], [\n\n            // MIXED\n            /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\\w]*)/i,\n                                                                                // BlackBerry/BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron\n            /(hp) ([\\w ]+\\w)/i,                                                 // HP iPAQ\n            /(asus)-?(\\w+)/i,                                                   // Asus\n            /(microsoft); (lumia[\\w ]+)/i,                                      // Microsoft Lumia\n            /(lenovo)[-_ ]?([-\\w]+)/i,                                          // Lenovo\n            /(jolla)/i,                                                         // Jolla\n            /(oppo) ?([\\w ]+) bui/i                                             // OPPO\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /(archos) (gamepad2?)/i,                                            // Archos\n            /(hp).+(touchpad(?!.+tablet)|tablet)/i,                             // HP TouchPad\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(nook)[\\w ]+build\\/(\\w+)/i,                                        // Nook\n            /(dell) (strea[kpr\\d ]*[\\dko])/i,                                   // Dell Streak\n            /(le[- ]+pan)[- ]+(\\w{1,9}) bui/i,                                  // Le Pan Tablets\n            /(trinity)[- ]*(t\\d{3}) bui/i,                                      // Trinity Tablets\n            /(gigaset)[- ]+(q\\w{1,9}) bui/i,                                    // Gigaset Tablets\n            /(vodafone) ([\\w ]+)(?:\\)| bui)/i                                   // Vodafone\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(surface duo)/i                                                    // Surface Duo\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, TABLET]], [\n            /droid [\\d\\.]+; (fp\\du?)(?: b|\\))/i                                 // Fairphone\n            ], [MODEL, [VENDOR, 'Fairphone'], [TYPE, MOBILE]], [\n            /(u304aa)/i                                                         // AT&T\n            ], [MODEL, [VENDOR, 'AT&T'], [TYPE, MOBILE]], [\n            /\\bsie-(\\w*)/i                                                      // Siemens\n            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [\n            /\\b(rct\\w+) b/i                                                     // RCA Tablets\n            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [\n            /\\b(venue[\\d ]{2,7}) b/i                                            // Dell Venue Tablets\n            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [\n            /\\b(q(?:mv|ta)\\w+) b/i                                              // Verizon Tablet\n            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [\n            /\\b(?:barnes[& ]+noble |bn[rt])([\\w\\+ ]*) b/i                       // Barnes & Noble Tablet\n            ], [MODEL, [VENDOR, 'Barnes & Noble'], [TYPE, TABLET]], [\n            /\\b(tm\\d{3}\\w+) b/i\n            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [\n            /\\b(k88) b/i                                                        // ZTE K Series Tablet\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [\n            /\\b(nx\\d{3}j) b/i                                                   // ZTE Nubia\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, MOBILE]], [\n            /\\b(gen\\d{3}) b.+49h/i                                              // Swiss GEN Mobile\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [\n            /\\b(zur\\d{3}) b/i                                                   // Swiss ZUR Tablet\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [\n            /\\b((zeki)?tb.*\\b) b/i                                              // Zeki Tablets\n            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [\n            /\\b([yr]\\d{2}) b/i,\n            /\\b(dragon[- ]+touch |dt)(\\w{5}) b/i                                // Dragon Touch Tablet\n            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [\n            /\\b(ns-?\\w{0,9}) b/i                                                // Insignia Tablets\n            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [\n            /\\b((nxa|next)-?\\w{0,9}) b/i                                        // NextBook Tablets\n            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [\n            /\\b(xtreme\\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i                  // Voice Xtreme Phones\n            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [\n            /\\b(lvtel\\-)?(v1[12]) b/i                                           // LvTel Phones\n            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [\n            /\\b(ph-1) /i                                                        // Essential PH-1\n            ], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [\n            /\\b(v(100md|700na|7011|917g).*\\b) b/i                               // Envizen Tablets\n            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [\n            /\\b(trio[-\\w\\. ]+) b/i                                              // MachSpeed Tablets\n            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [\n            /\\btu_(1491) b/i                                                    // Rotor Tablets\n            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [\n            /(shield[\\w ]+) b/i                                                 // Nvidia Shield Tablets\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, TABLET]], [\n            /(sprint) (\\w+)/i                                                   // Sprint Phones\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(kin\\.[onetw]{3})/i                                                // Microsoft Kin\n            ], [[MODEL, /\\./g, ' '], [VENDOR, MICROSOFT], [TYPE, MOBILE]], [\n            /droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\\)/i             // Zebra\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, TABLET]], [\n            /droid.+; (ec30|ps20|tc[2-8]\\d[kx])\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, MOBILE]], [\n\n            ///////////////////\n            // CONSOLES\n            ///////////////////\n\n            /(ouya)/i,                                                          // Ouya\n            /(nintendo) ([wids3utch]+)/i                                        // Nintendo\n            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [\n            /droid.+; (shield) bui/i                                            // Nvidia\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [\n            /(playstation [345portablevi]+)/i                                   // Playstation\n            ], [MODEL, [VENDOR, SONY], [TYPE, CONSOLE]], [\n            /\\b(xbox(?: one)?(?!; xbox))[\\); ]/i                                // Microsoft Xbox\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, CONSOLE]], [\n\n            ///////////////////\n            // SMARTTVS\n            ///////////////////\n\n            /smart-tv.+(samsung)/i                                              // Samsung\n            ], [VENDOR, [TYPE, SMARTTV]], [\n            /hbbtv.+maple;(\\d+)/i\n            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, SAMSUNG], [TYPE, SMARTTV]], [\n            /(nux; netcast.+smarttv|lg (netcast\\.tv-201\\d|android tv))/i        // LG SmartTV\n            ], [[VENDOR, LG], [TYPE, SMARTTV]], [\n            /(apple) ?tv/i                                                      // Apple TV\n            ], [VENDOR, [MODEL, APPLE+' TV'], [TYPE, SMARTTV]], [\n            /crkey/i                                                            // Google Chromecast\n            ], [[MODEL, CHROME+'cast'], [VENDOR, GOOGLE], [TYPE, SMARTTV]], [\n            /droid.+aft(\\w)( bui|\\))/i                                          // Fire TV\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, SMARTTV]], [\n            /\\(dtv[\\);].+(aquos)/i                                              // Sharp\n            ], [MODEL, [VENDOR, 'Sharp'], [TYPE, SMARTTV]], [\n            /\\b(roku)[\\dx]*[\\)\\/]((?:dvp-)?[\\d\\.]*)/i,                          // Roku\n            /hbbtv\\/\\d+\\.\\d+\\.\\d+ +\\([\\w ]*; *(\\w[^;]*);([^;]*)/i               // HbbTV devices\n            ], [[VENDOR, trim], [MODEL, trim], [TYPE, SMARTTV]], [\n            /\\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\\b/i                   // SmartTV from Unidentified Vendors\n            ], [[TYPE, SMARTTV]], [\n\n            ///////////////////\n            // WEARABLES\n            ///////////////////\n\n            /((pebble))app/i                                                    // Pebble\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n            /droid.+; (glass) \\d/i                                              // Google Glass\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, WEARABLE]], [\n            /droid.+; (wt63?0{2,3})\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, WEARABLE]], [\n            /(quest( 2)?)/i                                                     // Oculus Quest\n            ], [MODEL, [VENDOR, FACEBOOK], [TYPE, WEARABLE]], [\n\n            ///////////////////\n            // EMBEDDED\n            ///////////////////\n\n            /(tesla)(?: qtcarbrowser|\\/[-\\w\\.]+)/i                              // Tesla\n            ], [VENDOR, [TYPE, EMBEDDED]], [\n\n            ////////////////////\n            // MIXED (GENERIC)\n            ///////////////////\n\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+? mobile safari/i           // Android Phones from Unidentified Vendors\n            ], [MODEL, [TYPE, MOBILE]], [\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+?(?! mobile) safari/i       // Android Tablets from Unidentified Vendors\n            ], [MODEL, [TYPE, TABLET]], [\n            /\\b((tablet|tab)[;\\/]|focus\\/\\d(?!.+mobile))/i                      // Unidentifiable Tablet\n            ], [[TYPE, TABLET]], [\n            /(phone|mobile(?:[;\\/]| safari)|pda(?=.+windows ce))/i              // Unidentifiable Mobile\n            ], [[TYPE, MOBILE]], [\n            /(android[-\\w\\. ]{0,9});.+buil/i                                    // Generic Android Device\n            ], [MODEL, [VENDOR, 'Generic']]\n        ],\n\n        engine : [[\n\n            /windows.+ edge\\/([\\w\\.]+)/i                                       // EdgeHTML\n            ], [VERSION, [NAME, EDGE+'HTML']], [\n\n            /webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i                         // Blink\n            ], [VERSION, [NAME, 'Blink']], [\n\n            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\\/([\\w\\.]+)/i, // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna\n            /ekioh(flow)\\/([\\w\\.]+)/i,                                          // Flow\n            /(khtml|tasman|links)[\\/ ]\\(?([\\w\\.]+)/i,                           // KHTML/Tasman/Links\n            /(icab)[\\/ ]([23]\\.[\\d\\.]+)/i                                       // iCab\n            ], [NAME, VERSION], [\n\n            /rv\\:([\\w\\.]{1,9})\\b.+(gecko)/i                                     // Gecko\n            ], [VERSION, NAME]\n        ],\n\n        os : [[\n\n            // Windows\n            /microsoft (windows) (vista|xp)/i                                   // Windows (iTunes)\n            ], [NAME, VERSION], [\n            /(windows) nt 6\\.2; (arm)/i,                                        // Windows RT\n            /(windows (?:phone(?: os)?|mobile))[\\/ ]?([\\d\\.\\w ]*)/i,            // Windows Phone\n            /(windows)[\\/ ]?([ntce\\d\\. ]+\\w)(?!.+xbox)/i\n            ], [NAME, [VERSION, strMapper, windowsVersionMap]], [\n            /(win(?=3|9|n)|win 9x )([nt\\d\\.]+)/i\n            ], [[NAME, 'Windows'], [VERSION, strMapper, windowsVersionMap]], [\n\n            // iOS/macOS\n            /ip[honead]{2,4}\\b(?:.*os ([\\w]+) like mac|; opera)/i,              // iOS\n            /cfnetwork\\/.+darwin/i\n            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [\n            /(mac os x) ?([\\w\\. ]*)/i,\n            /(macintosh|mac_powerpc\\b)(?!.+haiku)/i                             // Mac OS\n            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [\n\n            // Mobile OSes\n            /droid ([\\w\\.]+)\\b.+(android[- ]x86)/i                              // Android-x86\n            ], [VERSION, NAME], [                                               // Android/WebOS/QNX/Bada/RIM/Maemo/MeeGo/Sailfish OS\n            /(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\\/ ]?([\\w\\.]*)/i,\n            /(blackberry)\\w*\\/([\\w\\.]*)/i,                                      // Blackberry\n            /(tizen|kaios)[\\/ ]([\\w\\.]+)/i,                                     // Tizen/KaiOS\n            /\\((series40);/i                                                    // Series 40\n            ], [NAME, VERSION], [\n            /\\(bb(10);/i                                                        // BlackBerry 10\n            ], [VERSION, [NAME, BLACKBERRY]], [\n            /(?:symbian ?os|symbos|s60(?=;)|series60)[-\\/ ]?([\\w\\.]*)/i         // Symbian\n            ], [VERSION, [NAME, 'Symbian']], [\n            /mozilla\\/[\\d\\.]+ \\((?:mobile|tablet|tv|mobile; [\\w ]+); rv:.+ gecko\\/([\\w\\.]+)/i // Firefox OS\n            ], [VERSION, [NAME, FIREFOX+' OS']], [\n            /web0s;.+rt(tv)/i,\n            /\\b(?:hp)?wos(?:browser)?\\/([\\w\\.]+)/i                              // WebOS\n            ], [VERSION, [NAME, 'webOS']], [\n\n            // Google Chromecast\n            /crkey\\/([\\d\\.]+)/i                                                 // Google Chromecast\n            ], [VERSION, [NAME, CHROME+'cast']], [\n            /(cros) [\\w]+ ([\\w\\.]+\\w)/i                                         // Chromium OS\n            ], [[NAME, 'Chromium OS'], VERSION],[\n\n            // Console\n            /(nintendo|playstation) ([wids345portablevuch]+)/i,                 // Nintendo/Playstation\n            /(xbox); +xbox ([^\\);]+)/i,                                         // Microsoft Xbox (360, One, X, S, Series X, Series S)\n\n            // Other\n            /\\b(joli|palm)\\b ?(?:os)?\\/?([\\w\\.]*)/i,                            // Joli/Palm\n            /(mint)[\\/\\(\\) ]?(\\w*)/i,                                           // Mint\n            /(mageia|vectorlinux)[; ]/i,                                        // Mageia/VectorLinux\n            /([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\\/ ]?(?!chrom|package)([-\\w\\.]*)/i,\n                                                                                // Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware/Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus/Raspbian/Plan9/Minix/RISCOS/Contiki/Deepin/Manjaro/elementary/Sabayon/Linspire\n            /(hurd|linux) ?([\\w\\.]*)/i,                                         // Hurd/Linux\n            /(gnu) ?([\\w\\.]*)/i,                                                // GNU\n            /\\b([-frentopcghs]{0,5}bsd|dragonfly)[\\/ ]?(?!amd|[ix346]{1,2}86)([\\w\\.]*)/i, // FreeBSD/NetBSD/OpenBSD/PC-BSD/GhostBSD/DragonFly\n            /(haiku) (\\w+)/i                                                    // Haiku\n            ], [NAME, VERSION], [\n            /(sunos) ?([\\w\\.\\d]*)/i                                             // Solaris\n            ], [[NAME, 'Solaris'], VERSION], [\n            /((?:open)?solaris)[-\\/ ]?([\\w\\.]*)/i,                              // Solaris\n            /(aix) ((\\d)(?=\\.|\\)| )[\\w\\.])*/i,                                  // AIX\n            /\\b(beos|os\\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,            // BeOS/OS2/AmigaOS/MorphOS/OpenVMS/Fuchsia/HP-UX\n            /(unix) ?([\\w\\.]*)/i                                                // UNIX\n            ], [NAME, VERSION]\n        ]\n    };\n\n    /////////////////\n    // Constructor\n    ////////////////\n\n    var UAParser = function (ua, extensions) {\n\n        if (typeof ua === OBJ_TYPE) {\n            extensions = ua;\n            ua = undefined;\n        }\n\n        if (!(this instanceof UAParser)) {\n            return new UAParser(ua, extensions).getResult();\n        }\n\n        var _ua = ua || ((typeof window !== UNDEF_TYPE && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);\n        var _rgxmap = extensions ? extend(regexes, extensions) : regexes;\n\n        this.getBrowser = function () {\n            var _browser = {};\n            _browser[NAME] = undefined;\n            _browser[VERSION] = undefined;\n            rgxMapper.call(_browser, _ua, _rgxmap.browser);\n            _browser.major = majorize(_browser.version);\n            return _browser;\n        };\n        this.getCPU = function () {\n            var _cpu = {};\n            _cpu[ARCHITECTURE] = undefined;\n            rgxMapper.call(_cpu, _ua, _rgxmap.cpu);\n            return _cpu;\n        };\n        this.getDevice = function () {\n            var _device = {};\n            _device[VENDOR] = undefined;\n            _device[MODEL] = undefined;\n            _device[TYPE] = undefined;\n            rgxMapper.call(_device, _ua, _rgxmap.device);\n            return _device;\n        };\n        this.getEngine = function () {\n            var _engine = {};\n            _engine[NAME] = undefined;\n            _engine[VERSION] = undefined;\n            rgxMapper.call(_engine, _ua, _rgxmap.engine);\n            return _engine;\n        };\n        this.getOS = function () {\n            var _os = {};\n            _os[NAME] = undefined;\n            _os[VERSION] = undefined;\n            rgxMapper.call(_os, _ua, _rgxmap.os);\n            return _os;\n        };\n        this.getResult = function () {\n            return {\n                ua      : this.getUA(),\n                browser : this.getBrowser(),\n                engine  : this.getEngine(),\n                os      : this.getOS(),\n                device  : this.getDevice(),\n                cpu     : this.getCPU()\n            };\n        };\n        this.getUA = function () {\n            return _ua;\n        };\n        this.setUA = function (ua) {\n            _ua = (typeof ua === STR_TYPE && ua.length > UA_MAX_LENGTH) ? trim(ua, UA_MAX_LENGTH) : ua;\n            return this;\n        };\n        this.setUA(_ua);\n        return this;\n    };\n\n    UAParser.VERSION = LIBVERSION;\n    UAParser.BROWSER =  enumerize([NAME, VERSION, MAJOR]);\n    UAParser.CPU = enumerize([ARCHITECTURE]);\n    UAParser.DEVICE = enumerize([MODEL, VENDOR, TYPE, CONSOLE, MOBILE, SMARTTV, TABLET, WEARABLE, EMBEDDED]);\n    UAParser.ENGINE = UAParser.OS = enumerize([NAME, VERSION]);\n\n    ///////////\n    // Export\n    //////////\n\n    // check js environment\n    if (typeof(exports) !== UNDEF_TYPE) {\n        // nodejs env\n        if (typeof module !== UNDEF_TYPE && module.exports) {\n            exports = module.exports = UAParser;\n        }\n        exports.UAParser = UAParser;\n    } else {\n        // requirejs env (optional)\n        if (typeof(define) === FUNC_TYPE && define.amd) {\n            define(function () {\n                return UAParser;\n            });\n        } else if (typeof window !== UNDEF_TYPE) {\n            // browser env\n            window.UAParser = UAParser;\n        }\n    }\n\n    // jQuery/Zepto specific (optional)\n    // Note:\n    //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n    //   and we should catch that.\n    var $ = typeof window !== UNDEF_TYPE && (window.jQuery || window.Zepto);\n    if ($ && !$.ua) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n        $.ua.get = function () {\n            return parser.getUA();\n        };\n        $.ua.set = function (ua) {\n            parser.setUA(ua);\n            var result = parser.getResult();\n            for (var prop in result) {\n                $.ua[prop] = result[prop];\n            }\n        };\n    }\n\n})(typeof window === 'object' ? window : this);\n","// file:src/log.js\n/* \n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar Log = (function (){\n\t\tvar start = new Date();\n\t\tvar LOG_LEVEL_ERROR \t= 4;\n\t\tvar LOG_LEVEL_WARNING \t= 3;\n\t\tvar LOG_LEVEL_INFO \t\t= 2;\n\t\tvar LOG_LEVEL_DEBUG\t\t= 1;\n\t\tvar log_level = LOG_LEVEL_ERROR;\n\t\tvar logObject = {\n\t\t\tsetLogLevel : function(level) {\n\t\t\t\tif (level == this.debug) log_level = LOG_LEVEL_DEBUG;\n\t\t\t\telse if (level == this.info) log_level = LOG_LEVEL_INFO;\n\t\t\t\telse if (level == this.warn) log_level = LOG_LEVEL_WARNING;\n\t\t\t\telse if (level == this.error) log_level = LOG_LEVEL_ERROR;\n\t\t\t\telse log_level = LOG_LEVEL_ERROR;\n\t\t\t},\n\t\t\tdebug : function(module, msg) {\n\t\t\t\tif (console.debug === undefined) {\n\t\t\t\t\tconsole.debug = console.log;\n\t\t\t\t}\n\t\t\t\tif (LOG_LEVEL_DEBUG >= log_level) {\n\t\t\t\t\tconsole.debug(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\tlog : function(module, msg) {\n\t\t\t\tthis.debug(module.msg)\n\t\t\t},\n\t\t\tinfo : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_INFO >= log_level) {\n\t\t\t\t\tconsole.info(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\twarn : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_WARNING >= log_level) {\n\t\t\t\t\tconsole.warn(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_ERROR >= log_level) {\n\t\t\t\t\tconsole.error(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn logObject;\n\t})();\n\t\n/* Helper function to print a duration value in the form H:MM:SS.MS */\nLog.getDurationString = function(duration, _timescale) {\n\tvar neg;\n\t/* Helper function to print a number on a fixed number of digits */\n\tfunction pad(number, length) {\n\t\tvar str = '' + number;\n\t\tvar a = str.split('.');\t\t\n\t\twhile (a[0].length < length) {\n\t\t\ta[0] = '0' + a[0];\n\t\t}\n\t\treturn a.join('.');\n\t}\n\tif (duration < 0) {\n\t\tneg = true;\n\t\tduration = -duration;\n\t} else {\n\t\tneg = false;\t\n\t}\n\tvar timescale = _timescale || 1;\n\tvar duration_sec = duration/timescale;\n\tvar hours = Math.floor(duration_sec/3600);\n\tduration_sec -= hours * 3600;\n\tvar minutes = Math.floor(duration_sec/60);\n\tduration_sec -= minutes * 60;\t\t\n\tvar msec = duration_sec*1000;\n\tduration_sec = Math.floor(duration_sec);\n\tmsec -= duration_sec*1000;\n\tmsec = Math.floor(msec);\n\treturn (neg ? \"-\": \"\")+hours+\":\"+pad(minutes,2)+\":\"+pad(duration_sec,2)+\".\"+pad(msec,3);\n}\n\t\n/* Helper function to stringify HTML5 TimeRanges objects */\t\nLog.printRanges = function(ranges) {\n\tvar length = ranges.length;\n\tif (length > 0) {\n\t\tvar str = \"\";\n\t\tfor (var i = 0; i < length; i++) {\n\t\t  if (i > 0) str += \",\";\n\t\t  str += \"[\"+Log.getDurationString(ranges.start(i))+ \",\"+Log.getDurationString(ranges.end(i))+\"]\";\n\t\t}\n\t\treturn str;\n\t} else {\n\t\treturn \"(empty)\";\n\t}\n}\n\nif (typeof exports !== 'undefined') {\n\texports.Log = Log;\n}\n// file:src/stream.js\nvar MP4BoxStream = function(arrayBuffer) {\n  if (arrayBuffer instanceof ArrayBuffer) {\n    this.buffer = arrayBuffer;\n    this.dataview = new DataView(arrayBuffer);\n  } else {\n    throw (\"Needs an array buffer\");\n  }\n  this.position = 0;\n};\n\n/*************************************************************************\n  Common API between MultiBufferStream and SimpleStream\n *************************************************************************/\nMP4BoxStream.prototype.getPosition = function() {\n  return this.position;\n}\n\nMP4BoxStream.prototype.getEndPosition = function() {\n  return this.buffer.byteLength;\n}\n\nMP4BoxStream.prototype.getLength = function() {\n  return this.buffer.byteLength;\n}\n\nMP4BoxStream.prototype.seek = function (pos) {\n  var npos = Math.max(0, Math.min(this.buffer.byteLength, pos));\n  this.position = (isNaN(npos) || !isFinite(npos)) ? 0 : npos;\n  return true;\n}\n\nMP4BoxStream.prototype.isEos = function () {\n  return this.getPosition() >= this.getEndPosition();\n}\n\n/*************************************************************************\n  Read methods, simimar to DataStream but simpler\n *************************************************************************/\nMP4BoxStream.prototype.readAnyInt = function(size, signed) {\n  var res = 0;\n  if (this.position + size <= this.buffer.byteLength) {\n    switch (size) {\n      case 1:\n        if (signed) {\n          res = this.dataview.getInt8(this.position);\n        } else {\n          res = this.dataview.getUint8(this.position);\n        }\n        break;\n      case 2:\n        if (signed) {\n          res = this.dataview.getInt16(this.position);\n        } else {\n          res = this.dataview.getUint16(this.position);\n        }\n        break;\n      case 3:\n        if (signed) {\n          throw (\"No method for reading signed 24 bits values\");\n        } else {\n          res = this.dataview.getUint8(this.position) << 16;\n          res |= this.dataview.getUint8(this.position+1) << 8;\n          res |= this.dataview.getUint8(this.position+2);\n        }\n        break;\n      case 4:\n        if (signed) {\n          res = this.dataview.getInt32(this.position);\n        } else {\n          res = this.dataview.getUint32(this.position);\n        }\n        break;\n      case 8:\n        if (signed) {\n          throw (\"No method for reading signed 64 bits values\");\n        } else {\n          res = this.dataview.getUint32(this.position) << 32;\n          res |= this.dataview.getUint32(this.position+4);\n        }\n        break;\n      default:\n        throw (\"readInt method not implemented for size: \"+size);\n    }\n    this.position+= size;\n    return res;\n  } else {\n    throw (\"Not enough bytes in buffer\");\n  }\n}\n\nMP4BoxStream.prototype.readUint8 = function() {\n  return this.readAnyInt(1, false);\n}\n\nMP4BoxStream.prototype.readUint16 = function() {\n  return this.readAnyInt(2, false);\n}\n\nMP4BoxStream.prototype.readUint24 = function() {\n  return this.readAnyInt(3, false);\n}\n\nMP4BoxStream.prototype.readUint32 = function() {\n  return this.readAnyInt(4, false);\n}\n\nMP4BoxStream.prototype.readUint64 = function() {\n  return this.readAnyInt(8, false);\n}\n\nMP4BoxStream.prototype.readString = function(length) {\n  if (this.position + length <= this.buffer.byteLength) {\n    var s = \"\";\n    for (var i = 0; i < length; i++) {\n      s += String.fromCharCode(this.readUint8());\n    }\n    return s;\n  } else {\n    throw (\"Not enough bytes in buffer\");\n  }\n}\n\nMP4BoxStream.prototype.readCString = function() {\n  var arr = [];\n  while(true) {\n    var b = this.readUint8();\n    if (b !== 0) {\n      arr.push(b);\n    } else {\n      break;\n    }\n  }\n  return String.fromCharCode.apply(null, arr); \n}\n\nMP4BoxStream.prototype.readInt8 = function() {\n  return this.readAnyInt(1, true);\n}\n\nMP4BoxStream.prototype.readInt16 = function() {\n  return this.readAnyInt(2, true);\n}\n\nMP4BoxStream.prototype.readInt32 = function() {\n  return this.readAnyInt(4, true);\n}\n\nMP4BoxStream.prototype.readInt64 = function() {\n  return this.readAnyInt(8, false);\n}\n\nMP4BoxStream.prototype.readUint8Array = function(length) {\n  var arr = new Uint8Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint8();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readInt16Array = function(length) {\n  var arr = new Int16Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readInt16();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readUint16Array = function(length) {\n  var arr = new Int16Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint16();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readUint32Array = function(length) {\n  var arr = new Uint32Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint32();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readInt32Array = function(length) {\n  var arr = new Int32Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readInt32();\n  }\n  return arr;\n}\n\nif (typeof exports !== 'undefined') {\n  exports.MP4BoxStream = MP4BoxStream;\n}// file:src/DataStream.js\n/**\n  DataStream reads scalars, arrays and structs of data from an ArrayBuffer.\n  It's like a file-like DataView on steroids.\n\n  @param {ArrayBuffer} arrayBuffer ArrayBuffer to read from.\n  @param {?Number} byteOffset Offset from arrayBuffer beginning for the DataStream.\n  @param {?Boolean} endianness DataStream.BIG_ENDIAN or DataStream.LITTLE_ENDIAN (the default).\n  */\nvar DataStream = function(arrayBuffer, byteOffset, endianness) {\n  this._byteOffset = byteOffset || 0;\n  if (arrayBuffer instanceof ArrayBuffer) {\n    this.buffer = arrayBuffer;\n  } else if (typeof arrayBuffer == \"object\") {\n    this.dataView = arrayBuffer;\n    if (byteOffset) {\n      this._byteOffset += byteOffset;\n    }\n  } else {\n    this.buffer = new ArrayBuffer(arrayBuffer || 0);\n  }\n  this.position = 0;\n  this.endianness = endianness == null ? DataStream.LITTLE_ENDIAN : endianness;\n};\nDataStream.prototype = {};\n\nDataStream.prototype.getPosition = function() {\n  return this.position;\n}\n\n/**\n  Internal function to resize the DataStream buffer when required.\n  @param {number} extra Number of bytes to add to the buffer allocation.\n  @return {null}\n  */\nDataStream.prototype._realloc = function(extra) {\n  if (!this._dynamicSize) {\n    return;\n  }\n  var req = this._byteOffset + this.position + extra;\n  var blen = this._buffer.byteLength;\n  if (req <= blen) {\n    if (req > this._byteLength) {\n      this._byteLength = req;\n    }\n    return;\n  }\n  if (blen < 1) {\n    blen = 1;\n  }\n  while (req > blen) {\n    blen *= 2;\n  }\n  var buf = new ArrayBuffer(blen);\n  var src = new Uint8Array(this._buffer);\n  var dst = new Uint8Array(buf, 0, src.length);\n  dst.set(src);\n  this.buffer = buf;\n  this._byteLength = req;\n};\n\n/**\n  Internal function to trim the DataStream buffer when required.\n  Used for stripping out the extra bytes from the backing buffer when\n  the virtual byteLength is smaller than the buffer byteLength (happens after\n  growing the buffer with writes and not filling the extra space completely).\n\n  @return {null}\n  */\nDataStream.prototype._trimAlloc = function() {\n  if (this._byteLength == this._buffer.byteLength) {\n    return;\n  }\n  var buf = new ArrayBuffer(this._byteLength);\n  var dst = new Uint8Array(buf);\n  var src = new Uint8Array(this._buffer, 0, dst.length);\n  dst.set(src);\n  this.buffer = buf;\n};\n\n\n/**\n  Big-endian const to use as default endianness.\n  @type {boolean}\n  */\nDataStream.BIG_ENDIAN = false;\n\n/**\n  Little-endian const to use as default endianness.\n  @type {boolean}\n  */\nDataStream.LITTLE_ENDIAN = true;\n\n/**\n  Virtual byte length of the DataStream backing buffer.\n  Updated to be max of original buffer size and last written size.\n  If dynamicSize is false is set to buffer size.\n  @type {number}\n  */\nDataStream.prototype._byteLength = 0;\n\n/**\n  Returns the byte length of the DataStream object.\n  @type {number}\n  */\nObject.defineProperty(DataStream.prototype, 'byteLength',\n  { get: function() {\n    return this._byteLength - this._byteOffset;\n  }});\n\n/**\n  Set/get the backing ArrayBuffer of the DataStream object.\n  The setter updates the DataView to point to the new buffer.\n  @type {Object}\n  */\nObject.defineProperty(DataStream.prototype, 'buffer',\n  { get: function() {\n      this._trimAlloc();\n      return this._buffer;\n    },\n    set: function(v) {\n      this._buffer = v;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._buffer.byteLength;\n    } });\n\n/**\n  Set/get the byteOffset of the DataStream object.\n  The setter updates the DataView to point to the new byteOffset.\n  @type {number}\n  */\nObject.defineProperty(DataStream.prototype, 'byteOffset',\n  { get: function() {\n      return this._byteOffset;\n    },\n    set: function(v) {\n      this._byteOffset = v;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._buffer.byteLength;\n    } });\n\n/**\n  Set/get the backing DataView of the DataStream object.\n  The setter updates the buffer and byteOffset to point to the DataView values.\n  @type {Object}\n  */\nObject.defineProperty(DataStream.prototype, 'dataView',\n  { get: function() {\n      return this._dataView;\n    },\n    set: function(v) {\n      this._byteOffset = v.byteOffset;\n      this._buffer = v.buffer;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._byteOffset + v.byteLength;\n    } });\n\n/**\n  Sets the DataStream read/write position to given position.\n  Clamps between 0 and DataStream length.\n\n  @param {number} pos Position to seek to.\n  @return {null}\n  */\nDataStream.prototype.seek = function(pos) {\n  var npos = Math.max(0, Math.min(this.byteLength, pos));\n  this.position = (isNaN(npos) || !isFinite(npos)) ? 0 : npos;\n};\n\n/**\n  Returns true if the DataStream seek pointer is at the end of buffer and\n  there's no more data to read.\n\n  @return {boolean} True if the seek pointer is at the end of the buffer.\n  */\nDataStream.prototype.isEof = function() {\n  return (this.position >= this._byteLength);\n};\n\n\n/**\n  Maps a Uint8Array into the DataStream buffer.\n\n  Nice for quickly reading in data.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint8Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint8Array = function(length) {\n  this._realloc(length * 1);\n  var arr = new Uint8Array(this._buffer, this.byteOffset+this.position, length);\n  this.position += length * 1;\n  return arr;\n};\n\n\n/**\n  Reads an Int32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int32Array.\n */\nDataStream.prototype.readInt32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Int32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads an Int16Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int16Array.\n */\nDataStream.prototype.readInt16Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 2) : length;\n  var arr = new Int16Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads an Int8Array of desired length from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int8Array.\n */\nDataStream.prototype.readInt8Array = function(length) {\n  length = length == null ? (this.byteLength-this.position) : length;\n  var arr = new Int8Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint32Array.\n */\nDataStream.prototype.readUint32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Uint32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint16Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint16Array.\n */\nDataStream.prototype.readUint16Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 2) : length;\n  var arr = new Uint16Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint8Array of desired length from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint8Array.\n */\nDataStream.prototype.readUint8Array = function(length) {\n  length = length == null ? (this.byteLength-this.position) : length;\n  var arr = new Uint8Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Float64Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Float64Array.\n */\nDataStream.prototype.readFloat64Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 8) : length;\n  var arr = new Float64Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Float32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Float32Array.\n */\nDataStream.prototype.readFloat32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Float32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n\n/**\n  Reads a 32-bit int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readInt32 = function(e) {\n  var v = this._dataView.getInt32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 16-bit int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readInt16 = function(e) {\n  var v = this._dataView.getInt16(this.position, e == null ? this.endianness : e);\n  this.position += 2;\n  return v;\n};\n\n/**\n  Reads an 8-bit int from the DataStream.\n\n  @return {number} The read number.\n */\nDataStream.prototype.readInt8 = function() {\n  var v = this._dataView.getInt8(this.position);\n  this.position += 1;\n  return v;\n};\n\n/**\n  Reads a 32-bit unsigned int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readUint32 = function(e) {\n  var v = this._dataView.getUint32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 16-bit unsigned int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readUint16 = function(e) {\n  var v = this._dataView.getUint16(this.position, e == null ? this.endianness : e);\n  this.position += 2;\n  return v;\n};\n\n/**\n  Reads an 8-bit unsigned int from the DataStream.\n\n  @return {number} The read number.\n */\nDataStream.prototype.readUint8 = function() {\n  var v = this._dataView.getUint8(this.position);\n  this.position += 1;\n  return v;\n};\n\n/**\n  Reads a 32-bit float from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readFloat32 = function(e) {\n  var v = this._dataView.getFloat32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 64-bit float from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readFloat64 = function(e) {\n  var v = this._dataView.getFloat64(this.position, e == null ? this.endianness : e);\n  this.position += 8;\n  return v;\n};\n\n/**\n  Native endianness. Either DataStream.BIG_ENDIAN or DataStream.LITTLE_ENDIAN\n  depending on the platform endianness.\n\n  @type {boolean}\n */\nDataStream.endianness = new Int8Array(new Int16Array([1]).buffer)[0] > 0;\n\n/**\n  Copies byteLength bytes from the src buffer at srcOffset to the\n  dst buffer at dstOffset.\n\n  @param {Object} dst Destination ArrayBuffer to write to.\n  @param {number} dstOffset Offset to the destination ArrayBuffer.\n  @param {Object} src Source ArrayBuffer to read from.\n  @param {number} srcOffset Offset to the source ArrayBuffer.\n  @param {number} byteLength Number of bytes to copy.\n */\nDataStream.memcpy = function(dst, dstOffset, src, srcOffset, byteLength) {\n  var dstU8 = new Uint8Array(dst, dstOffset, byteLength);\n  var srcU8 = new Uint8Array(src, srcOffset, byteLength);\n  dstU8.set(srcU8);\n};\n\n/**\n  Converts array to native endianness in-place.\n\n  @param {Object} array Typed array to convert.\n  @param {boolean} arrayIsLittleEndian True if the data in the array is\n                                       little-endian. Set false for big-endian.\n  @return {Object} The converted typed array.\n */\nDataStream.arrayToNative = function(array, arrayIsLittleEndian) {\n  if (arrayIsLittleEndian == this.endianness) {\n    return array;\n  } else {\n    return this.flipArrayEndianness(array);\n  }\n};\n\n/**\n  Converts native endianness array to desired endianness in-place.\n\n  @param {Object} array Typed array to convert.\n  @param {boolean} littleEndian True if the converted array should be\n                                little-endian. Set false for big-endian.\n  @return {Object} The converted typed array.\n */\nDataStream.nativeToEndian = function(array, littleEndian) {\n  if (this.endianness == littleEndian) {\n    return array;\n  } else {\n    return this.flipArrayEndianness(array);\n  }\n};\n\n/**\n  Flips typed array endianness in-place.\n\n  @param {Object} array Typed array to flip.\n  @return {Object} The converted typed array.\n */\nDataStream.flipArrayEndianness = function(array) {\n  var u8 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n  for (var i=0; i<array.byteLength; i+=array.BYTES_PER_ELEMENT) {\n    for (var j=i+array.BYTES_PER_ELEMENT-1, k=i; j>k; j--, k++) {\n      var tmp = u8[k];\n      u8[k] = u8[j];\n      u8[j] = tmp;\n    }\n  }\n  return array;\n};\n\n/**\n  Seek position where DataStream#readStruct ran into a problem.\n  Useful for debugging struct parsing.\n\n  @type {number}\n */\nDataStream.prototype.failurePosition = 0;\n\nString.fromCharCodeUint8 = function(uint8arr) {\n    var arr = [];\n    for (var i = 0; i < uint8arr.length; i++) {\n      arr[i] = uint8arr[i];\n    }\n    return String.fromCharCode.apply(null, arr);\n}\n/**\n  Read a string of desired length and encoding from the DataStream.\n\n  @param {number} length The length of the string to read in bytes.\n  @param {?string} encoding The encoding of the string data in the DataStream.\n                            Defaults to ASCII.\n  @return {string} The read string.\n */\nDataStream.prototype.readString = function(length, encoding) {\n  if (encoding == null || encoding == \"ASCII\") {\n    return String.fromCharCodeUint8.apply(null, [this.mapUint8Array(length == null ? this.byteLength-this.position : length)]);\n  } else {\n    return (new TextDecoder(encoding)).decode(this.mapUint8Array(length));\n  }\n};\n\n/**\n  Read null-terminated string of desired length from the DataStream. Truncates\n  the returned string so that the null byte is not a part of it.\n\n  @param {?number} length The length of the string to read.\n  @return {string} The read string.\n */\nDataStream.prototype.readCString = function(length) {\n  var blen = this.byteLength-this.position;\n  var u8 = new Uint8Array(this._buffer, this._byteOffset + this.position);\n  var len = blen;\n  if (length != null) {\n    len = Math.min(length, blen);\n  }\n  for (var i = 0; i < len && u8[i] !== 0; i++); // find first zero byte\n  var s = String.fromCharCodeUint8.apply(null, [this.mapUint8Array(i)]);\n  if (length != null) {\n    this.position += len-i;\n  } else if (i != blen) {\n    this.position += 1; // trailing zero if not at end of buffer\n  }\n  return s;\n};\n\n/* \n   TODO: fix endianness for 24/64-bit fields\n   TODO: check range/support for 64-bits numbers in JavaScript\n*/\nvar MAX_SIZE = Math.pow(2, 32);\n\nDataStream.prototype.readInt64 = function () {\n  return (this.readInt32()*MAX_SIZE)+this.readUint32();\n}\nDataStream.prototype.readUint64 = function () {\n\treturn (this.readUint32()*MAX_SIZE)+this.readUint32();\n}\n\nDataStream.prototype.readInt64 = function () {\n  return (this.readUint32()*MAX_SIZE)+this.readUint32();\n}\n\nDataStream.prototype.readUint24 = function () {\n\treturn (this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8();\n}\n\nif (typeof exports !== 'undefined') {\n  exports.DataStream = DataStream;  \n}\n// file:src/DataStream-write.js\n/**\n  Saves the DataStream contents to the given filename.\n  Uses Chrome's anchor download property to initiate download.\n \n  @param {string} filename Filename to save as.\n  @return {null}\n  */\nDataStream.prototype.save = function(filename) {\n  var blob = new Blob([this.buffer]);\n  if (window.URL && URL.createObjectURL) {\n      var url = window.URL.createObjectURL(blob);\n      var a = document.createElement('a');\n      // Required in Firefox:\n      document.body.appendChild(a);\n      a.setAttribute('href', url);\n      a.setAttribute('download', filename);\n      // Required in Firefox:\n      a.setAttribute('target', '_self');\n      a.click();\n      window.URL.revokeObjectURL(url);\n  } else {\n      throw(\"DataStream.save: Can't create object URL.\");\n  }\n};\n\n/**\n  Whether to extend DataStream buffer when trying to write beyond its size.\n  If set, the buffer is reallocated to twice its current size until the\n  requested write fits the buffer.\n  @type {boolean}\n  */\nDataStream.prototype._dynamicSize = true;\nObject.defineProperty(DataStream.prototype, 'dynamicSize',\n  { get: function() {\n      return this._dynamicSize;\n    },\n    set: function(v) {\n      if (!v) {\n        this._trimAlloc();\n      }\n      this._dynamicSize = v;\n    } });\n\n/**\n  Internal function to trim the DataStream buffer when required.\n  Used for stripping out the first bytes when not needed anymore.\n\n  @return {null}\n  */\nDataStream.prototype.shift = function(offset) {\n  var buf = new ArrayBuffer(this._byteLength-offset);\n  var dst = new Uint8Array(buf);\n  var src = new Uint8Array(this._buffer, offset, dst.length);\n  dst.set(src);\n  this.buffer = buf;\n  this.position -= offset;\n};\n\n/**\n  Writes an Int32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeInt32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Int32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt32(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes an Int16Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeInt16Array = function(arr, e) {\n  this._realloc(arr.length * 2);\n  if (arr instanceof Int16Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt16Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt16(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes an Int8Array to the DataStream.\n\n  @param {Object} arr The array to write.\n */\nDataStream.prototype.writeInt8Array = function(arr) {\n  this._realloc(arr.length * 1);\n  if (arr instanceof Int8Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt8Array(arr.length);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt8(arr[i]);\n    }\n  }\n};\n\n/**\n  Writes a Uint32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeUint32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Uint32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint32(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Uint16Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeUint16Array = function(arr, e) {\n  this._realloc(arr.length * 2);\n  if (arr instanceof Uint16Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint16Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint16(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Uint8Array to the DataStream.\n\n  @param {Object} arr The array to write.\n */\nDataStream.prototype.writeUint8Array = function(arr) {\n  this._realloc(arr.length * 1);\n  if (arr instanceof Uint8Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint8Array(arr.length);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint8(arr[i]);\n    }\n  }\n};\n\n/**\n  Writes a Float64Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeFloat64Array = function(arr, e) {\n  this._realloc(arr.length * 8);\n  if (arr instanceof Float64Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapFloat64Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeFloat64(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Float32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeFloat32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Float32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapFloat32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeFloat32(arr[i], e);\n    }\n  }\n};\n\n\n/**\n  Writes a 32-bit int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeInt32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setInt32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 16-bit int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeInt16 = function(v, e) {\n  this._realloc(2);\n  this._dataView.setInt16(this.position, v, e == null ? this.endianness : e);\n  this.position += 2;\n};\n\n/**\n  Writes an 8-bit int to the DataStream.\n\n  @param {number} v Number to write.\n */\nDataStream.prototype.writeInt8 = function(v) {\n  this._realloc(1);\n  this._dataView.setInt8(this.position, v);\n  this.position += 1;\n};\n\n/**\n  Writes a 32-bit unsigned int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeUint32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setUint32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 16-bit unsigned int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeUint16 = function(v, e) {\n  this._realloc(2);\n  this._dataView.setUint16(this.position, v, e == null ? this.endianness : e);\n  this.position += 2;\n};\n\n/**\n  Writes an 8-bit unsigned  int to the DataStream.\n\n  @param {number} v Number to write.\n */\nDataStream.prototype.writeUint8 = function(v) {\n  this._realloc(1);\n  this._dataView.setUint8(this.position, v);\n  this.position += 1;\n};\n\n/**\n  Writes a 32-bit float to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeFloat32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setFloat32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 64-bit float to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeFloat64 = function(v, e) {\n  this._realloc(8);\n  this._dataView.setFloat64(this.position, v, e == null ? this.endianness : e);\n  this.position += 8;\n};\n\n/**\n  Write a UCS-2 string of desired endianness to the DataStream. The\n  lengthOverride argument lets you define the number of characters to write.\n  If the string is shorter than lengthOverride, the extra space is padded with\n  zeroes.\n\n  @param {string} str The string to write.\n  @param {?boolean} endianness The endianness to use for the written string data.\n  @param {?number} lengthOverride The number of characters to write.\n */\nDataStream.prototype.writeUCS2String = function(str, endianness, lengthOverride) {\n  if (lengthOverride == null) {\n    lengthOverride = str.length;\n  }\n  for (var i = 0; i < str.length && i < lengthOverride; i++) {\n    this.writeUint16(str.charCodeAt(i), endianness);\n  }\n  for (; i<lengthOverride; i++) {\n    this.writeUint16(0);\n  }\n};\n\n/**\n  Writes a string of desired length and encoding to the DataStream.\n\n  @param {string} s The string to write.\n  @param {?string} encoding The encoding for the written string data.\n                            Defaults to ASCII.\n  @param {?number} length The number of characters to write.\n */\nDataStream.prototype.writeString = function(s, encoding, length) {\n  var i = 0;\n  if (encoding == null || encoding == \"ASCII\") {\n    if (length != null) {\n      var len = Math.min(s.length, length);\n      for (i=0; i<len; i++) {\n        this.writeUint8(s.charCodeAt(i));\n      }\n      for (; i<length; i++) {\n        this.writeUint8(0);\n      }\n    } else {\n      for (i=0; i<s.length; i++) {\n        this.writeUint8(s.charCodeAt(i));\n      }\n    }\n  } else {\n    this.writeUint8Array((new TextEncoder(encoding)).encode(s.substring(0, length)));\n  }\n};\n\n/**\n  Writes a null-terminated string to DataStream and zero-pads it to length\n  bytes. If length is not given, writes the string followed by a zero.\n  If string is longer than length, the written part of the string does not have\n  a trailing zero.\n\n  @param {string} s The string to write.\n  @param {?number} length The number of characters to write.\n */\nDataStream.prototype.writeCString = function(s, length) {\n  var i = 0;\n  if (length != null) {\n    var len = Math.min(s.length, length);\n    for (i=0; i<len; i++) {\n      this.writeUint8(s.charCodeAt(i));\n    }\n    for (; i<length; i++) {\n      this.writeUint8(0);\n    }\n  } else {\n    for (i=0; i<s.length; i++) {\n      this.writeUint8(s.charCodeAt(i));\n    }\n    this.writeUint8(0);\n  }\n};\n\n/**\n  Writes a struct to the DataStream. Takes a structDefinition that gives the\n  types and a struct object that gives the values. Refer to readStruct for the\n  structure of structDefinition.\n\n  @param {Object} structDefinition Type definition of the struct.\n  @param {Object} struct The struct data object.\n  */\nDataStream.prototype.writeStruct = function(structDefinition, struct) {\n  for (var i = 0; i < structDefinition.length; i+=2) {\n    var t = structDefinition[i+1];\n    this.writeType(t, struct[structDefinition[i]], struct);\n  }\n};\n\n/**\n  Writes object v of type t to the DataStream.\n\n  @param {Object} t Type of data to write.\n  @param {Object} v Value of data to write.\n  @param {Object} struct Struct to pass to write callback functions.\n  */\nDataStream.prototype.writeType = function(t, v, struct) {\n  var tp;\n  if (typeof t == \"function\") {\n    return t(this, v);\n  } else if (typeof t == \"object\" && !(t instanceof Array)) {\n    return t.set(this, v, struct);\n  }\n  var lengthOverride = null;\n  var charset = \"ASCII\";\n  var pos = this.position;\n  if (typeof(t) == 'string' && /:/.test(t)) {\n    tp = t.split(\":\");\n    t = tp[0];\n    lengthOverride = parseInt(tp[1]);\n  }\n  if (typeof t == 'string' && /,/.test(t)) {\n    tp = t.split(\",\");\n    t = tp[0];\n    charset = parseInt(tp[1]);\n  }\n\n  switch(t) {\n    case 'uint8':\n      this.writeUint8(v);\n      break;\n    case 'int8':\n      this.writeInt8(v);\n      break;\n\n    case 'uint16':\n      this.writeUint16(v, this.endianness);\n      break;\n    case 'int16':\n      this.writeInt16(v, this.endianness);\n      break;\n    case 'uint32':\n      this.writeUint32(v, this.endianness);\n      break;\n    case 'int32':\n      this.writeInt32(v, this.endianness);\n      break;\n    case 'float32':\n      this.writeFloat32(v, this.endianness);\n      break;\n    case 'float64':\n      this.writeFloat64(v, this.endianness);\n      break;\n\n    case 'uint16be':\n      this.writeUint16(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'int16be':\n      this.writeInt16(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'uint32be':\n      this.writeUint32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'int32be':\n      this.writeInt32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'float32be':\n      this.writeFloat32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'float64be':\n      this.writeFloat64(v, DataStream.BIG_ENDIAN);\n      break;\n\n    case 'uint16le':\n      this.writeUint16(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'int16le':\n      this.writeInt16(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'uint32le':\n      this.writeUint32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'int32le':\n      this.writeInt32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'float32le':\n      this.writeFloat32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'float64le':\n      this.writeFloat64(v, DataStream.LITTLE_ENDIAN);\n      break;\n\n    case 'cstring':\n      this.writeCString(v, lengthOverride);\n      break;\n\n    case 'string':\n      this.writeString(v, charset, lengthOverride);\n      break;\n\n    case 'u16string':\n      this.writeUCS2String(v, this.endianness, lengthOverride);\n      break;\n\n    case 'u16stringle':\n      this.writeUCS2String(v, DataStream.LITTLE_ENDIAN, lengthOverride);\n      break;\n\n    case 'u16stringbe':\n      this.writeUCS2String(v, DataStream.BIG_ENDIAN, lengthOverride);\n      break;\n\n    default:\n      if (t.length == 3) {\n        var ta = t[1];\n        for (var i=0; i<v.length; i++) {\n          this.writeType(ta, v[i]);\n        }\n        break;\n      } else {\n        this.writeStruct(t, v);\n        break;\n      }\n  }\n  if (lengthOverride != null) {\n    this.position = pos;\n    this._realloc(lengthOverride);\n    this.position = pos + lengthOverride;\n  }\n};\n\n\nDataStream.prototype.writeUint64 = function (v) {\n\tvar h = Math.floor(v / MAX_SIZE);\n\tthis.writeUint32(h);\n\tthis.writeUint32(v & 0xFFFFFFFF);\n}\n\nDataStream.prototype.writeUint24 = function (v) {\n\tthis.writeUint8((v & 0x00FF0000)>>16);\n\tthis.writeUint8((v & 0x0000FF00)>>8);\n\tthis.writeUint8((v & 0x000000FF));\n}\n\nDataStream.prototype.adjustUint32 = function(position, value) {\n\tvar pos = this.position;\n\tthis.seek(position);\n\tthis.writeUint32(value);\n\tthis.seek(pos);\n}\n// file:src/DataStream-map.js\n/**\n  Maps an Int32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Int32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n\n/**\n  Maps an Int16Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int16Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt16Array = function(length, e) {\n  this._realloc(length * 2);\n  var arr = new Int16Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 2;\n  return arr;\n};\n\n/**\n  Maps an Int8Array into the DataStream buffer.\n\n  Nice for quickly reading in data.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int8Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt8Array = function(length) {\n  this._realloc(length * 1);\n  var arr = new Int8Array(this._buffer, this.byteOffset+this.position, length);\n  this.position += length * 1;\n  return arr;\n};\n\n/**\n  Maps a Uint32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Uint32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n\n/**\n  Maps a Uint16Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint16Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint16Array = function(length, e) {\n  this._realloc(length * 2);\n  var arr = new Uint16Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 2;\n  return arr;\n};\n\n/**\n  Maps a Float64Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Float64Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapFloat64Array = function(length, e) {\n  this._realloc(length * 8);\n  var arr = new Float64Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 8;\n  return arr;\n};\n\n/**\n  Maps a Float32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Float32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapFloat32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Float32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n// file:src/buffer.js\n/**\n * MultiBufferStream is a class that acts as a SimpleStream for parsing \n * It holds several, possibly non-contiguous ArrayBuffer objects, each with a fileStart property \n * containing the offset for the buffer data in an original/virtual file \n *\n * It inherits also from DataStream for all read/write/alloc operations\n */\n\n/**\n * Constructor\n */\nvar MultiBufferStream = function(buffer) {\n\t/* List of ArrayBuffers, with a fileStart property, sorted in fileStart order and non overlapping */\n\tthis.buffers = [];\t\n\tthis.bufferIndex = -1;\n\tif (buffer) {\n\t\tthis.insertBuffer(buffer);\n\t\tthis.bufferIndex = 0;\n\t}\n}\nMultiBufferStream.prototype = new DataStream(new ArrayBuffer(), 0, DataStream.BIG_ENDIAN);\n\n/************************************************************************************\n  Methods for the managnement of the buffers (insertion, removal, concatenation, ...)\n ***********************************************************************************/\n\nMultiBufferStream.prototype.initialized = function() {\n\tvar firstBuffer;\n\tif (this.bufferIndex > -1) {\n\t\treturn true;\n\t} else if (this.buffers.length > 0) {\n\t\tfirstBuffer = this.buffers[0];\n\t\tif (firstBuffer.fileStart === 0) {\n\t\t\tthis.buffer = firstBuffer;\n\t\t\tthis.bufferIndex = 0;\n\t\t\tLog.debug(\"MultiBufferStream\", \"Stream ready for parsing\");\n\t\t\treturn true;\n\t\t} else {\n\t\t\tLog.warn(\"MultiBufferStream\", \"The first buffer should have a fileStart of 0\");\n\t\t\tthis.logBufferLevel();\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\tLog.warn(\"MultiBufferStream\", \"No buffer to start parsing from\");\n\t\tthis.logBufferLevel();\n\t\treturn false;\n\t}\t\t\t\n}\n\n/**\n * helper functions to concatenate two ArrayBuffer objects\n * @param  {ArrayBuffer} buffer1 \n * @param  {ArrayBuffer} buffer2 \n * @return {ArrayBuffer} the concatenation of buffer1 and buffer2 in that order\n */\nArrayBuffer.concat = function(buffer1, buffer2) {\n  Log.debug(\"ArrayBuffer\", \"Trying to create a new buffer of size: \"+(buffer1.byteLength + buffer2.byteLength));\n  var tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);\n  tmp.set(new Uint8Array(buffer1), 0);\n  tmp.set(new Uint8Array(buffer2), buffer1.byteLength);\n  return tmp.buffer;\n};\n\n/**\n * Reduces the size of a given buffer, but taking the part between offset and offset+newlength\n * @param  {ArrayBuffer} buffer    \n * @param  {Number}      offset    the start of new buffer\n * @param  {Number}      newLength the length of the new buffer\n * @return {ArrayBuffer}           the new buffer\n */\nMultiBufferStream.prototype.reduceBuffer = function(buffer, offset, newLength) {\n\tvar smallB;\n\tsmallB = new Uint8Array(newLength);\n\tsmallB.set(new Uint8Array(buffer, offset, newLength));\n\tsmallB.buffer.fileStart = buffer.fileStart+offset;\n\tsmallB.buffer.usedBytes = 0;\n\treturn smallB.buffer;\t\n}\n\n/**\n * Inserts the new buffer in the sorted list of buffers,\n *  making sure, it is not overlapping with existing ones (possibly reducing its size).\n *  if the new buffer overrides/replaces the 0-th buffer (for instance because it is bigger), \n *  updates the DataStream buffer for parsing \n*/\nMultiBufferStream.prototype.insertBuffer = function(ab) {\t\n\tvar to_add = true;\n\t/* TODO: improve insertion if many buffers */\n\tfor (var i = 0; i < this.buffers.length; i++) {\n\t\tvar b = this.buffers[i];\n\t\tif (ab.fileStart <= b.fileStart) {\n\t\t\t/* the insertion position is found */\n\t\t\tif (ab.fileStart === b.fileStart) {\n\t\t\t\t/* The new buffer overlaps with an existing buffer */\n\t\t\t\tif (ab.byteLength >  b.byteLength) {\n\t\t\t\t\t/* the new buffer is bigger than the existing one\n\t\t\t\t\t   remove the existing buffer and try again to insert \n\t\t\t\t\t   the new buffer to check overlap with the next ones */\n\t\t\t\t\tthis.buffers.splice(i, 1);\n\t\t\t\t\ti--; \n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\t/* the new buffer is smaller than the existing one, just drop it */\n\t\t\t\t\tLog.warn(\"MultiBufferStream\", \"Buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\") already appended, ignoring\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t/* The beginning of the new buffer is not overlapping with an existing buffer\n\t\t\t\t   let's check the end of it */\n\t\t\t\tif (ab.fileStart + ab.byteLength <= b.fileStart) {\n\t\t\t\t\t/* no overlap, we can add it as is */\n\t\t\t\t} else {\n\t\t\t\t\t/* There is some overlap, cut the new buffer short, and add it*/\n\t\t\t\t\tab = this.reduceBuffer(ab, 0, b.fileStart - ab.fileStart);\n\t\t\t\t}\n\t\t\t\tLog.debug(\"MultiBufferStream\", \"Appending new buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\")\");\n\t\t\t\tthis.buffers.splice(i, 0, ab);\n\t\t\t\t/* if this new buffer is inserted in the first place in the list of the buffer, \n\t\t\t\t   and the DataStream is initialized, make it the buffer used for parsing */\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.buffer = ab;\n\t\t\t\t}\n\t\t\t}\n\t\t\tto_add = false;\n\t\t\tbreak;\n\t\t} else if (ab.fileStart < b.fileStart + b.byteLength) {\n\t\t\t/* the new buffer overlaps its beginning with the end of the current buffer */\n\t\t\tvar offset = b.fileStart + b.byteLength - ab.fileStart;\n\t\t\tvar newLength = ab.byteLength - offset;\n\t\t\tif (newLength > 0) {\n\t\t\t\t/* the new buffer is bigger than the current overlap, drop the overlapping part and try again inserting the remaining buffer */\n\t\t\t\tab = this.reduceBuffer(ab, offset, newLength);\n\t\t\t} else {\n\t\t\t\t/* the content of the new buffer is entirely contained in the existing buffer, drop it entirely */\n\t\t\t\tto_add = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t/* if the buffer has not been added, we can add it at the end */\n\tif (to_add) {\n\t\tLog.debug(\"MultiBufferStream\", \"Appending new buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\")\");\n\t\tthis.buffers.push(ab);\n\t\t/* if this new buffer is inserted in the first place in the list of the buffer, \n\t\t   and the DataStream is initialized, make it the buffer used for parsing */\n\t\tif (i === 0) {\n\t\t\tthis.buffer = ab;\n\t\t}\n\t}\n}\n\n/**\n * Displays the status of the buffers (number and used bytes)\n * @param  {Object} info callback method for display\n */\nMultiBufferStream.prototype.logBufferLevel = function(info) {\n\tvar i;\n\tvar buffer;\n\tvar used, total;\n\tvar ranges = [];\n\tvar range;\n\tvar bufferedString = \"\";\n\tused = 0;\n\ttotal = 0;\n\tfor (i = 0; i < this.buffers.length; i++) {\n\t\tbuffer = this.buffers[i];\n\t\tif (i === 0) {\n\t\t\trange = {};\n\t\t\tranges.push(range);\n\t\t\trange.start = buffer.fileStart;\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t\tbufferedString += \"[\"+range.start+\"-\";\n\t\t} else if (range.end === buffer.fileStart) {\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t} else {\n\t\t\trange = {};\n\t\t\trange.start = buffer.fileStart;\n\t\t\tbufferedString += (ranges[ranges.length-1].end-1)+\"], [\"+range.start+\"-\";\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t\tranges.push(range);\n\t\t}\n\t\tused += buffer.usedBytes;\n\t\ttotal += buffer.byteLength;\n\t}\n\tif (ranges.length > 0) {\n\t\tbufferedString += (range.end-1)+\"]\";\n\t}\n\tvar log = (info ? Log.info : Log.debug)\n\tif (this.buffers.length === 0) {\n\t\tlog(\"MultiBufferStream\", \"No more buffer in memory\");\n\t} else {\n\t\tlog(\"MultiBufferStream\", \"\"+this.buffers.length+\" stored buffer(s) (\"+used+\"/\"+total+\" bytes), continuous ranges: \"+bufferedString);\n\t}\n}\n\nMultiBufferStream.prototype.cleanBuffers = function () {\n\tvar i;\n\tvar buffer;\n\tfor (i = 0; i < this.buffers.length; i++) {\n\t\tbuffer = this.buffers[i];\n\t\tif (buffer.usedBytes === buffer.byteLength) {\n\t\t\tLog.debug(\"MultiBufferStream\", \"Removing buffer #\"+i);\n\t\t\tthis.buffers.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n}\n\nMultiBufferStream.prototype.mergeNextBuffer = function() {\n\tvar next_buffer;\n\tif (this.bufferIndex+1 < this.buffers.length) {\n\t\tnext_buffer = this.buffers[this.bufferIndex+1];\n\t\tif (next_buffer.fileStart === this.buffer.fileStart + this.buffer.byteLength) {\n\t\t\tvar oldLength = this.buffer.byteLength;\n\t\t\tvar oldUsedBytes = this.buffer.usedBytes;\n\t\t\tvar oldFileStart = this.buffer.fileStart;\n\t\t\tthis.buffers[this.bufferIndex] = ArrayBuffer.concat(this.buffer, next_buffer);\n\t\t\tthis.buffer = this.buffers[this.bufferIndex];\n\t\t\tthis.buffers.splice(this.bufferIndex+1, 1);\n\t\t\tthis.buffer.usedBytes = oldUsedBytes; /* TODO: should it be += ? */\n\t\t\tthis.buffer.fileStart = oldFileStart;\n\t\t\tLog.debug(\"ISOFile\", \"Concatenating buffer for box parsing (length: \"+oldLength+\"->\"+this.buffer.byteLength+\")\");\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n}\n\n\n/*************************************************************************\n  Seek-related functions\n *************************************************************************/\n\n/**\n * Finds the buffer that holds the given file position\n * @param  {Boolean} fromStart    indicates if the search should start from the current buffer (false) \n *                                or from the first buffer (true)\n * @param  {Number}  filePosition position in the file to seek to\n * @param  {Boolean} markAsUsed   indicates if the bytes in between the current position and the seek position \n *                                should be marked as used for garbage collection\n * @return {Number}               the index of the buffer holding the seeked file position, -1 if not found.\n */\nMultiBufferStream.prototype.findPosition = function(fromStart, filePosition, markAsUsed) {\n\tvar i;\n\tvar abuffer = null;\n\tvar index = -1;\n\n\t/* find the buffer with the largest position smaller than the given position */\n\tif (fromStart === true) {\n\t   /* the reposition can be in the past, we need to check from the beginning of the list of buffers */\n\t\ti = 0;\n\t} else {\n\t\ti = this.bufferIndex;\n\t}\n\n\twhile (i < this.buffers.length) {\n\t\tabuffer = this.buffers[i];\n\t\tif (abuffer.fileStart <= filePosition) {\n\t\t\tindex = i;\n\t\t\tif (markAsUsed) {\n\t\t\t\tif (abuffer.fileStart + abuffer.byteLength <= filePosition) {\n\t\t\t\t\tabuffer.usedBytes = abuffer.byteLength;\t\n\t\t\t\t} else {\n\t\t\t\t\tabuffer.usedBytes = filePosition - abuffer.fileStart;\n\t\t\t\t}\t\t\n\t\t\t\tthis.logBufferLevel();\t\n\t\t\t}\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t\ti++;\n\t}\n\n\tif (index !== -1) {\n\t\tabuffer = this.buffers[index];\n\t\tif (abuffer.fileStart + abuffer.byteLength >= filePosition) {\t\t\t\n\t\t\tLog.debug(\"MultiBufferStream\", \"Found position in existing buffer #\"+index);\n\t\t\treturn index;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t} else {\n\t\treturn -1;\n\t}\n}\n\n/**\n * Finds the largest file position contained in a buffer or in the next buffers if they are contiguous (no gap)\n * starting from the given buffer index or from the current buffer if the index is not given\n *\n * @param  {Number} inputindex Index of the buffer to start from\n * @return {Number}            The largest file position found in the buffers\n */\nMultiBufferStream.prototype.findEndContiguousBuf = function(inputindex) {\n\tvar i;\n\tvar currentBuf;\n\tvar nextBuf;\n\tvar index = (inputindex !== undefined ? inputindex : this.bufferIndex);\n\tcurrentBuf = this.buffers[index];\n\t/* find the end of the contiguous range of data */\n\tif (this.buffers.length > index+1) {\n\t\tfor (i = index+1; i < this.buffers.length; i++) {\n\t\t\tnextBuf = this.buffers[i];\n\t\t\tif (nextBuf.fileStart === currentBuf.fileStart + currentBuf.byteLength) {\n\t\t\t\tcurrentBuf = nextBuf;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t/* return the position of last byte in the file that we have */\n\treturn currentBuf.fileStart + currentBuf.byteLength;\n}\n\n/**\n * Returns the largest file position contained in the buffers, larger than the given position\n * @param  {Number} pos the file position to start from\n * @return {Number}     the largest position in the current buffer or in the buffer and the next contiguous \n *                      buffer that holds the given position\n */\nMultiBufferStream.prototype.getEndFilePositionAfter = function(pos) {\n\tvar index = this.findPosition(true, pos, false);\n\tif (index !== -1) {\n\t\treturn this.findEndContiguousBuf(index);\n\t} else {\n\t\treturn pos;\n\t}\n}\n\n/*************************************************************************\n  Garbage collection related functions\n *************************************************************************/\n\n/**\n * Marks a given number of bytes as used in the current buffer for garbage collection\n * @param {Number} nbBytes \n */\nMultiBufferStream.prototype.addUsedBytes = function(nbBytes) {\n\tthis.buffer.usedBytes += nbBytes;\n\tthis.logBufferLevel();\n}\n\n/**\n * Marks the entire current buffer as used, ready for garbage collection\n */\nMultiBufferStream.prototype.setAllUsedBytes = function() {\n\tthis.buffer.usedBytes = this.buffer.byteLength;\n\tthis.logBufferLevel();\n}\n\n/*************************************************************************\n  Common API between MultiBufferStream and SimpleStream\n *************************************************************************/\n\n/**\n * Tries to seek to a given file position\n * if possible, repositions the parsing from there and returns true \n * if not possible, does not change anything and returns false \n * @param  {Number}  filePosition position in the file to seek to\n * @param  {Boolean} fromStart    indicates if the search should start from the current buffer (false) \n *                                or from the first buffer (true)\n * @param  {Boolean} markAsUsed   indicates if the bytes in between the current position and the seek position \n *                                should be marked as used for garbage collection\n * @return {Boolean}              true if the seek succeeded, false otherwise\n */\nMultiBufferStream.prototype.seek = function(filePosition, fromStart, markAsUsed) {\n\tvar index;\n\tindex = this.findPosition(fromStart, filePosition, markAsUsed);\n\tif (index !== -1) {\n\t\tthis.buffer = this.buffers[index];\n\t\tthis.bufferIndex = index;\n\t\tthis.position = filePosition - this.buffer.fileStart;\n\t\tLog.debug(\"MultiBufferStream\", \"Repositioning parser at buffer position: \"+this.position);\n\t\treturn true;\n\t} else {\n\t\tLog.debug(\"MultiBufferStream\", \"Position \"+filePosition+\" not found in buffered data\");\n\t\treturn false;\n\t}\n}\n\n/**\n * Returns the current position in the file\n * @return {Number} the position in the file\n */\nMultiBufferStream.prototype.getPosition = function() {\n\tif (this.bufferIndex === -1 || this.buffers[this.bufferIndex] === null) {\n\t\tthrow \"Error accessing position in the MultiBufferStream\";\n\t}\n\treturn this.buffers[this.bufferIndex].fileStart+this.position;\n}\n\n/**\n * Returns the length of the current buffer\n * @return {Number} the length of the current buffer\n */\nMultiBufferStream.prototype.getLength = function() {\n\treturn this.byteLength;\n}\n\nMultiBufferStream.prototype.getEndPosition = function() {\n\tif (this.bufferIndex === -1 || this.buffers[this.bufferIndex] === null) {\n\t\tthrow \"Error accessing position in the MultiBufferStream\";\n\t}\n\treturn this.buffers[this.bufferIndex].fileStart+this.byteLength;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.MultiBufferStream = MultiBufferStream;\n}// file:src/descriptor.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar MPEG4DescriptorParser = function () {\n\tvar ES_DescrTag \t\t\t= 0x03;\n\tvar DecoderConfigDescrTag \t= 0x04;\n\tvar DecSpecificInfoTag \t\t= 0x05;\n\tvar SLConfigDescrTag \t\t= 0x06;\n\n\tvar descTagToName = [];\n\tdescTagToName[ES_DescrTag] \t\t\t\t= \"ES_Descriptor\";\n\tdescTagToName[DecoderConfigDescrTag] \t= \"DecoderConfigDescriptor\";\n\tdescTagToName[DecSpecificInfoTag] \t\t= \"DecoderSpecificInfo\";\n\tdescTagToName[SLConfigDescrTag] \t\t= \"SLConfigDescriptor\";\n\n\tthis.getDescriptorName = function(tag) {\n\t\treturn descTagToName[tag];\n\t}\n\n\tvar that = this;\n\tvar classes = {};\n\n\tthis.parseOneDescriptor = function (stream) {\n\t\tvar hdrSize = 0;\n\t\tvar size = 0;\n\t\tvar tag;\n\t\tvar desc;\n\t\tvar byteRead;\n\t\ttag = stream.readUint8();\n\t\thdrSize++;\n\t\tbyteRead = stream.readUint8();\n\t\thdrSize++;\n\t\twhile (byteRead & 0x80) {\n\t\t\tsize = (byteRead & 0x7F)<<7;\n\t\t\tbyteRead = stream.readUint8();\n\t\t\thdrSize++;\n\t\t}\n\t\tsize += byteRead & 0x7F;\n\t\tLog.debug(\"MPEG4DescriptorParser\", \"Found \"+(descTagToName[tag] || \"Descriptor \"+tag)+\", size \"+size+\" at position \"+stream.getPosition());\n\t\tif (descTagToName[tag]) {\n\t\t\tdesc = new classes[descTagToName[tag]](size);\n\t\t} else {\n\t\t\tdesc = new classes.Descriptor(size);\n\t\t}\n\t\tdesc.parse(stream);\n\t\treturn desc;\n\t}\n\n\tclasses.Descriptor = function(_tag, _size) {\n\t\tthis.tag = _tag;\n\t\tthis.size = _size;\n\t\tthis.descs = [];\n\t}\n\n\tclasses.Descriptor.prototype.parse = function (stream) {\n\t\tthis.data = stream.readUint8Array(this.size);\n\t}\n\n\tclasses.Descriptor.prototype.findDescriptor = function (tag) {\n\t\tfor (var i = 0; i < this.descs.length; i++) {\n\t\t\tif (this.descs[i].tag == tag) {\n\t\t\t\treturn this.descs[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclasses.Descriptor.prototype.parseRemainingDescriptors = function (stream) {\n\t\tvar start = stream.position;\n\t\twhile (stream.position < start+this.size) {\n\t\t\tvar desc = that.parseOneDescriptor(stream);\n\t\t\tthis.descs.push(desc);\n\t\t}\n\t}\n\n\tclasses.ES_Descriptor = function (size) {\n\t\tclasses.Descriptor.call(this, ES_DescrTag, size);\n\t}\n\n\tclasses.ES_Descriptor.prototype = new classes.Descriptor();\n\n\tclasses.ES_Descriptor.prototype.parse = function(stream) {\n\t\tthis.ES_ID = stream.readUint16();\n\t\tthis.flags = stream.readUint8();\n\t\tthis.size -= 3;\n\t\tif (this.flags & 0x80) {\n\t\t\tthis.dependsOn_ES_ID = stream.readUint16();\n\t\t\tthis.size -= 2;\n\t\t} else {\n\t\t\tthis.dependsOn_ES_ID = 0;\n\t\t}\n\t\tif (this.flags & 0x40) {\n\t\t\tvar l = stream.readUint8();\n\t\t\tthis.URL = stream.readString(l);\n\t\t\tthis.size -= l+1;\n\t\t} else {\n\t\t\tthis.URL = \"\";\n\t\t}\n\t\tif (this.flags & 0x20) {\n\t\t\tthis.OCR_ES_ID = stream.readUint16();\n\t\t\tthis.size -= 2;\n\t\t} else {\n\t\t\tthis.OCR_ES_ID = 0;\n\t\t}\n\t\tthis.parseRemainingDescriptors(stream);\n\t}\n\n\tclasses.ES_Descriptor.prototype.getOTI = function(stream) {\n\t\tvar dcd = this.findDescriptor(DecoderConfigDescrTag);\n\t\tif (dcd) {\n\t\t\treturn dcd.oti;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tclasses.ES_Descriptor.prototype.getAudioConfig = function(stream) {\n\t\tvar dcd = this.findDescriptor(DecoderConfigDescrTag);\n\t\tif (!dcd) return null;\n\t\tvar dsi = dcd.findDescriptor(DecSpecificInfoTag);\n\t\tif (dsi && dsi.data) {\n\t\t\tvar audioObjectType = (dsi.data[0]& 0xF8) >> 3;\n\t\t\tif (audioObjectType === 31 && dsi.data.length >= 2) {\n\t\t\t\taudioObjectType = 32 + ((dsi.data[0] & 0x7) << 3) + ((dsi.data[1] & 0xE0) >> 5);\n\t\t\t}\n\t\t\treturn audioObjectType;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tclasses.DecoderConfigDescriptor = function (size) {\n\t\tclasses.Descriptor.call(this, DecoderConfigDescrTag, size);\n\t}\n\tclasses.DecoderConfigDescriptor.prototype = new classes.Descriptor();\n\n\tclasses.DecoderConfigDescriptor.prototype.parse = function(stream) {\n\t\tthis.oti = stream.readUint8();\n\t\tthis.streamType = stream.readUint8();\n\t\tthis.bufferSize = stream.readUint24();\n\t\tthis.maxBitrate = stream.readUint32();\n\t\tthis.avgBitrate = stream.readUint32();\n\t\tthis.size -= 13;\n\t\tthis.parseRemainingDescriptors(stream);\n\t}\n\n\tclasses.DecoderSpecificInfo = function (size) {\n\t\tclasses.Descriptor.call(this, DecSpecificInfoTag, size);\n\t}\n\tclasses.DecoderSpecificInfo.prototype = new classes.Descriptor();\n\n\tclasses.SLConfigDescriptor = function (size) {\n\t\tclasses.Descriptor.call(this, SLConfigDescrTag, size);\n\t}\n\tclasses.SLConfigDescriptor.prototype = new classes.Descriptor();\n\n\treturn this;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.MPEG4DescriptorParser = MPEG4DescriptorParser;\n}// file:src/box.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar BoxParser = {\n\tERR_INVALID_DATA : -1,\n\tERR_NOT_ENOUGH_DATA : 0,\n\tOK : 1,\n\n\t// Boxes to be created with default parsing\n\tBASIC_BOXES: [ \"mdat\", \"idat\", \"free\", \"skip\", \"meco\", \"strk\" ],\n\tFULL_BOXES: [ \"hmhd\", \"nmhd\", \"iods\", \"xml \", \"bxml\", \"ipro\", \"mere\" ],\n\tCONTAINER_BOXES: [\n\t\t[ \"moov\", [ \"trak\", \"pssh\" ] ],\n\t\t[ \"trak\" ],\n\t\t[ \"edts\" ],\n\t\t[ \"mdia\" ],\n\t\t[ \"minf\" ],\n\t\t[ \"dinf\" ],\n\t\t[ \"stbl\", [ \"sgpd\", \"sbgp\" ] ],\n\t\t[ \"mvex\", [ \"trex\" ] ],\n\t\t[ \"moof\", [ \"traf\" ] ],\n\t\t[ \"traf\", [ \"trun\", \"sgpd\", \"sbgp\" ] ],\n\t\t[ \"vttc\" ],\n\t\t[ \"tref\" ],\n\t\t[ \"iref\" ],\n\t\t[ \"mfra\", [ \"tfra\" ] ],\n\t\t[ \"meco\" ],\n\t\t[ \"hnti\" ],\n\t\t[ \"hinf\" ],\n\t\t[ \"strk\" ],\n\t\t[ \"strd\" ],\n\t\t[ \"sinf\" ],\n\t\t[ \"rinf\" ],\n\t\t[ \"schi\" ],\n\t\t[ \"trgr\" ],\n\t\t[ \"udta\", [\"kind\"] ],\n\t\t[ \"iprp\", [\"ipma\"] ],\n\t\t[ \"ipco\"]\n\t],\n\t// Boxes effectively created\n\tboxCodes : [],\n\tfullBoxCodes : [],\n\tcontainerBoxCodes : [],\n\tsampleEntryCodes : {},\n\tsampleGroupEntryCodes: [],\n\ttrackGroupTypes: [],\n\tUUIDBoxes: {},\n\tUUIDs: [],\n\tinitialize: function() {\n\t\tBoxParser.FullBox.prototype = new BoxParser.Box();\n\t\tBoxParser.ContainerBox.prototype = new BoxParser.Box();\n\t\tBoxParser.SampleEntry.prototype = new BoxParser.Box();\n\t\tBoxParser.TrackGroupTypeBox.prototype = new BoxParser.FullBox();\n\n\t\t/* creating constructors for simple boxes */\n\t\tBoxParser.BASIC_BOXES.forEach(function(type) {\n\t\t\tBoxParser.createBoxCtor(type)\n\t\t});\n\t\tBoxParser.FULL_BOXES.forEach(function(type) {\n\t\t\tBoxParser.createFullBoxCtor(type);\n\t\t});\n\t\tBoxParser.CONTAINER_BOXES.forEach(function(types) {\n\t\t\tBoxParser.createContainerBoxCtor(types[0], null, types[1]);\n\t\t});\n\t},\n\tBox: function(_type, _size, _uuid) {\n\t\tthis.type = _type;\n\t\tthis.size = _size;\n\t\tthis.uuid = _uuid;\n\t},\n\tFullBox: function(type, size, uuid) {\n\t\tBoxParser.Box.call(this, type, size, uuid);\n\t\tthis.flags = 0;\n\t\tthis.version = 0;\n\t},\n\tContainerBox: function(type, size, uuid) {\n\t\tBoxParser.Box.call(this, type, size, uuid);\n\t\tthis.boxes = [];\n\t},\n\tSampleEntry: function(type, size, hdr_size, start) {\n\t\tBoxParser.ContainerBox.call(this, type, size);\n\t\tthis.hdr_size = hdr_size;\n\t\tthis.start = start;\n\t},\n\tSampleGroupEntry: function(type) {\n\t\tthis.grouping_type = type;\n\t},\n\tTrackGroupTypeBox: function(type, size) {\n\t\tBoxParser.FullBox.call(this, type, size);\n\t},\n\tcreateBoxCtor: function(type, parseMethod){\n\t\tBoxParser.boxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.Box.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.Box();\n\t\tif (parseMethod) BoxParser[type+\"Box\"].prototype.parse = parseMethod;\n\t},\n\tcreateFullBoxCtor: function(type, parseMethod) {\n\t\t//BoxParser.fullBoxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.FullBox.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.FullBox();\n\t\tBoxParser[type+\"Box\"].prototype.parse = function(stream) {\n\t\t\tthis.parseFullHeader(stream);\n\t\t\tif (parseMethod) {\n\t\t\t\tparseMethod.call(this, stream);\n\t\t\t}\n\t\t};\n\t},\n\taddSubBoxArrays: function(subBoxNames) {\n\t\tif (subBoxNames) {\n\t\t\tthis.subBoxNames = subBoxNames;\n\t\t\tvar nbSubBoxes = subBoxNames.length;\n\t\t\tfor (var k = 0; k<nbSubBoxes; k++) {\n\t\t\t\tthis[subBoxNames[k]+\"s\"] = [];\n\t\t\t}\n\t\t}\n\t},\n\tcreateContainerBoxCtor: function(type, parseMethod, subBoxNames) {\n\t\t//BoxParser.containerBoxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.ContainerBox.call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.ContainerBox();\n\t\tif (parseMethod) BoxParser[type+\"Box\"].prototype.parse = parseMethod;\n\t},\n\tcreateMediaSampleEntryCtor: function(mediaType, parseMethod, subBoxNames) {\n\t\tBoxParser.sampleEntryCodes[mediaType] = [];\n\t\tBoxParser[mediaType+\"SampleEntry\"] = function(type, size) {\n\t\t\tBoxParser.SampleEntry.call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t};\n\t\tBoxParser[mediaType+\"SampleEntry\"].prototype = new BoxParser.SampleEntry();\n\t\tif (parseMethod) BoxParser[mediaType+\"SampleEntry\"].prototype .parse = parseMethod;\n\t},\n\tcreateSampleEntryCtor: function(mediaType, type, parseMethod, subBoxNames) {\n\t\tBoxParser.sampleEntryCodes[mediaType].push(type);\n\t\tBoxParser[type+\"SampleEntry\"] = function(size) {\n\t\t\tBoxParser[mediaType+\"SampleEntry\"].call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t};\n\t\tBoxParser[type+\"SampleEntry\"].prototype = new BoxParser[mediaType+\"SampleEntry\"]();\n\t\tif (parseMethod) BoxParser[type+\"SampleEntry\"].prototype.parse = parseMethod;\n\t},\n\tcreateEncryptedSampleEntryCtor: function(mediaType, type, parseMethod) {\n\t\tBoxParser.createSampleEntryCtor.call(this, mediaType, type, parseMethod, [\"sinf\"]);\n\t},\n\tcreateSampleGroupCtor: function(type, parseMethod) {\n\t\t//BoxParser.sampleGroupEntryCodes.push(type);\n\t\tBoxParser[type+\"SampleGroupEntry\"] = function(size) {\n\t\t\tBoxParser.SampleGroupEntry.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"SampleGroupEntry\"].prototype = new BoxParser.SampleGroupEntry();\n\t\tif (parseMethod) BoxParser[type+\"SampleGroupEntry\"].prototype.parse = parseMethod;\n\t},\n\tcreateTrackGroupCtor: function(type, parseMethod) {\n\t\t//BoxParser.trackGroupTypes.push(type);\n\t\tBoxParser[type+\"TrackGroupTypeBox\"] = function(size) {\n\t\t\tBoxParser.TrackGroupTypeBox.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"TrackGroupTypeBox\"].prototype = new BoxParser.TrackGroupTypeBox();\n\t\tif (parseMethod) BoxParser[type+\"TrackGroupTypeBox\"].prototype.parse = parseMethod;\n\t},\n\tcreateUUIDBox: function(uuid, isFullBox, isContainerBox, parseMethod) {\n\t\tBoxParser.UUIDs.push(uuid);\n\t\tBoxParser.UUIDBoxes[uuid] = function(size) {\n\t\t\tif (isFullBox) {\n\t\t\t\tBoxParser.FullBox.call(this, \"uuid\", size, uuid);\n\t\t\t} else {\n\t\t\t\tif (isContainerBox) {\n\t\t\t\t\tBoxParser.ContainerBox.call(this, \"uuid\", size, uuid);\n\t\t\t\t} else {\n\t\t\t\t\tBoxParser.Box.call(this, \"uuid\", size, uuid);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBoxParser.UUIDBoxes[uuid].prototype = (isFullBox ? new BoxParser.FullBox() : (isContainerBox ? new BoxParser.ContainerBox() : new BoxParser.Box()));\n\t\tif (parseMethod) {\n\t\t\tif (isFullBox) {\n\t\t\t\tBoxParser.UUIDBoxes[uuid].prototype.parse = function(stream) {\n\t\t\t\t\tthis.parseFullHeader(stream);\n\t\t\t\t\tif (parseMethod) {\n\t\t\t\t\t\tparseMethod.call(this, stream);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tBoxParser.UUIDBoxes[uuid].prototype.parse = parseMethod;\n\t\t\t}\n\t\t}\n\t}\n}\n\nBoxParser.initialize();\n\nBoxParser.TKHD_FLAG_ENABLED    = 0x000001;\nBoxParser.TKHD_FLAG_IN_MOVIE   = 0x000002;\nBoxParser.TKHD_FLAG_IN_PREVIEW = 0x000004;\n\nBoxParser.TFHD_FLAG_BASE_DATA_OFFSET\t= 0x01;\nBoxParser.TFHD_FLAG_SAMPLE_DESC\t\t\t= 0x02;\nBoxParser.TFHD_FLAG_SAMPLE_DUR\t\t\t= 0x08;\nBoxParser.TFHD_FLAG_SAMPLE_SIZE\t\t\t= 0x10;\nBoxParser.TFHD_FLAG_SAMPLE_FLAGS\t\t= 0x20;\nBoxParser.TFHD_FLAG_DUR_EMPTY\t\t\t= 0x10000;\nBoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF= 0x20000;\n\nBoxParser.TRUN_FLAGS_DATA_OFFSET= 0x01;\nBoxParser.TRUN_FLAGS_FIRST_FLAG\t= 0x04;\nBoxParser.TRUN_FLAGS_DURATION\t= 0x100;\nBoxParser.TRUN_FLAGS_SIZE\t\t= 0x200;\nBoxParser.TRUN_FLAGS_FLAGS\t\t= 0x400;\nBoxParser.TRUN_FLAGS_CTS_OFFSET\t= 0x800;\n\nBoxParser.Box.prototype.add = function(name) {\n\treturn this.addBox(new BoxParser[name+\"Box\"]());\n}\n\nBoxParser.Box.prototype.addBox = function(box) {\n\tthis.boxes.push(box);\n\tif (this[box.type+\"s\"]) {\n\t\tthis[box.type+\"s\"].push(box);\n\t} else {\n\t\tthis[box.type] = box;\n\t}\n\treturn box;\n}\n\nBoxParser.Box.prototype.set = function(prop, value) {\n\tthis[prop] = value;\n\treturn this;\n}\n\nBoxParser.Box.prototype.addEntry = function(value, _prop) {\n\tvar prop = _prop || \"entries\";\n\tif (!this[prop]) {\n\t\tthis[prop] = [];\n\t}\n\tthis[prop].push(value);\n\treturn this;\n}\n\nif (typeof exports !== \"undefined\") {\n\texports.BoxParser = BoxParser;\n}\n// file:src/box-parse.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.parseUUID = function(stream) {\n\treturn BoxParser.parseHex16(stream);\n}\n\nBoxParser.parseHex16 = function(stream) {\n\tvar hex16 = \"\"\n\tfor (var i = 0; i <16; i++) {\n\t\tvar hex = stream.readUint8().toString(16);\n\t\thex16 += (hex.length === 1 ? \"0\"+hex : hex);\n\t}\n\treturn hex16;\n}\n\nBoxParser.parseOneBox = function(stream, headerOnly, parentSize) {\n\tvar box;\n\tvar start = stream.getPosition();\n\tvar hdr_size = 0;\n\tvar diff;\n\tvar uuid;\n\tif (stream.getEndPosition() - start < 8) {\n\t\tLog.debug(\"BoxParser\", \"Not enough data in stream to parse the type and size of the box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t}\n\tif (parentSize && parentSize < 8) {\n\t\tLog.debug(\"BoxParser\", \"Not enough bytes left in the parent box to parse a new box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t}\n\tvar size = stream.readUint32();\n\tvar type = stream.readString(4);\n\tvar box_type = type;\n\tLog.debug(\"BoxParser\", \"Found box of type '\"+type+\"' and size \"+size+\" at position \"+start);\n\thdr_size = 8;\n\tif (type == \"uuid\") {\n\t\tif ((stream.getEndPosition() - stream.getPosition() < 16) || (parentSize -hdr_size < 16)) {\n\t\t\tstream.seek(start);\n\t\t\tLog.debug(\"BoxParser\", \"Not enough bytes left in the parent box to parse a UUID box\");\n\t\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t\t}\n\t\tuuid = BoxParser.parseUUID(stream);\n\t\thdr_size += 16;\n\t\tbox_type = uuid;\n\t}\n\tif (size == 1) {\n\t\tif ((stream.getEndPosition() - stream.getPosition() < 8) || (parentSize && (parentSize - hdr_size) < 8)) {\n\t\t\tstream.seek(start);\n\t\t\tLog.warn(\"BoxParser\", \"Not enough data in stream to parse the extended size of the \\\"\"+type+\"\\\" box\");\n\t\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t\t}\n\t\tsize = stream.readUint64();\n\t\thdr_size += 8;\n\t} else if (size === 0) {\n\t\t/* box extends till the end of file or invalid file */\n\t\tif (parentSize) {\n\t\t\tsize = parentSize;\n\t\t} else {\n\t\t\t/* box extends till the end of file */\n\t\t\tif (type !== \"mdat\") {\n\t\t\t\tLog.error(\"BoxParser\", \"Unlimited box size not supported for type: '\"+type+\"'\");\n\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\treturn { code: BoxParser.OK, box: box, size: box.size };\n\t\t\t}\n\t\t}\n\t}\n\tif (size < hdr_size) {\n\t\tLog.error(\"BoxParser\", \"Box of type \"+type+\" has an invalid size \"+size+\" (too small to be a box)\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (parentSize && size > parentSize) {\n\t\tLog.error(\"BoxParser\", \"Box of type '\"+type+\"' has a size \"+size+\" greater than its container size \"+parentSize);\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (start + size > stream.getEndPosition()) {\n\t\tstream.seek(start);\n\t\tLog.info(\"BoxParser\", \"Not enough data in stream to parse the entire '\"+type+\"' box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (headerOnly) {\n\t\treturn { code: BoxParser.OK, type: type, size: size, hdr_size: hdr_size, start: start };\n\t} else {\n\t\tif (BoxParser[type+\"Box\"]) {\n\t\t\tbox = new BoxParser[type+\"Box\"](size);\n\t\t} else {\n\t\t\tif (type !== \"uuid\") {\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown box type: '\"+type+\"'\");\n\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\tbox.has_unparsed_data = true;\n\t\t\t} else {\n\t\t\t\tif (BoxParser.UUIDBoxes[uuid]) {\n\t\t\t\t\tbox = new BoxParser.UUIDBoxes[uuid](size);\n\t\t\t\t} else {\n\t\t\t\t\tLog.warn(\"BoxParser\", \"Unknown uuid type: '\"+uuid+\"'\");\n\t\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\t\tbox.uuid = uuid;\n\t\t\t\t\tbox.has_unparsed_data = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tbox.hdr_size = hdr_size;\n\t/* recording the position of the box in the input stream */\n\tbox.start = start;\n\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\tLog.info(\"BoxParser\", \"'\"+box_type+\"' box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\tbox.parseDataAndRewind(stream);\n\t}\n\tbox.parse(stream);\n\tdiff = stream.getPosition() - (box.start+box.size);\n\tif (diff < 0) {\n\t\tLog.warn(\"BoxParser\", \"Parsing of box '\"+box_type+\"' did not read the entire indicated box data size (missing \"+(-diff)+\" bytes), seeking forward\");\n\t\tstream.seek(box.start+box.size);\n\t} else if (diff > 0) {\n\t\tLog.error(\"BoxParser\", \"Parsing of box '\"+box_type+\"' read \"+diff+\" more bytes than the indicated box data size, seeking backwards\");\n\t\tstream.seek(box.start+box.size);\n\t}\n\treturn { code: BoxParser.OK, box: box, size: box.size };\n}\n\nBoxParser.Box.prototype.parse = function(stream) {\n\tif (this.type != \"mdat\") {\n\t\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t} else {\n\t\tif (this.size === 0) {\n\t\t\tstream.seek(stream.getEndPosition());\n\t\t} else {\n\t\t\tstream.seek(this.start+this.size);\n\t\t}\n\t}\n}\n\n/* Used to parse a box without consuming its data, to allow detailled parsing\n   Useful for boxes for which a write method is not yet implemented */\nBoxParser.Box.prototype.parseDataAndRewind = function(stream) {\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.FullBox.prototype.parseDataAndRewind = function(stream) {\n\tthis.parseFullHeader(stream);\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t// restore the header size as if the full header had not been parsed\n\tthis.hdr_size -= 4;\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.FullBox.prototype.parseFullHeader = function (stream) {\n\tthis.version = stream.readUint8();\n\tthis.flags = stream.readUint24();\n\tthis.hdr_size += 4;\n}\n\nBoxParser.FullBox.prototype.parse = function (stream) {\n\tthis.parseFullHeader(stream);\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n}\n\nBoxParser.ContainerBox.prototype.parse = function(stream) {\n\tvar ret;\n\tvar box;\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\t/* store the box in the 'boxes' array to preserve box order (for offset) but also store box in a property for more direct access */\n\t\t\tthis.boxes.push(box);\n\t\t\tif (this.subBoxNames && this.subBoxNames.indexOf(box.type) != -1) {\n\t\t\t\tthis[this.subBoxNames[this.subBoxNames.indexOf(box.type)]+\"s\"].push(box);\n\t\t\t} else {\n\t\t\t\tvar box_type = box.type !== \"uuid\" ? box.type : box.uuid;\n\t\t\t\tif (this[box_type]) {\n\t\t\t\t\tLog.warn(\"Box of type \"+box_type+\" already stored in field of this type\");\n\t\t\t\t} else {\n\t\t\t\t\tthis[box_type] = box;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nBoxParser.Box.prototype.parseLanguage = function(stream) {\n\tthis.language = stream.readUint16();\n\tvar chars = [];\n\tchars[0] = (this.language>>10)&0x1F;\n\tchars[1] = (this.language>>5)&0x1F;\n\tchars[2] = (this.language)&0x1F;\n\tthis.languageString = String.fromCharCode(chars[0]+0x60, chars[1]+0x60, chars[2]+0x60);\n}\n\n// file:src/parsing/sampleentries/sampleentry.js\nBoxParser.SAMPLE_ENTRY_TYPE_VISUAL \t\t= \"Visual\";\nBoxParser.SAMPLE_ENTRY_TYPE_AUDIO \t\t= \"Audio\";\nBoxParser.SAMPLE_ENTRY_TYPE_HINT \t\t= \"Hint\";\nBoxParser.SAMPLE_ENTRY_TYPE_METADATA \t= \"Metadata\";\nBoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE \t= \"Subtitle\";\nBoxParser.SAMPLE_ENTRY_TYPE_SYSTEM \t\t= \"System\";\nBoxParser.SAMPLE_ENTRY_TYPE_TEXT \t\t= \"Text\";\n\nBoxParser.SampleEntry.prototype.parseHeader = function(stream) {\n\tstream.readUint8Array(6);\n\tthis.data_reference_index = stream.readUint16();\n\tthis.hdr_size += 8;\n}\n\nBoxParser.SampleEntry.prototype.parse = function(stream) {\n\tthis.parseHeader(stream);\n\tthis.data = stream.readUint8Array(this.size - this.hdr_size);\n}\n\nBoxParser.SampleEntry.prototype.parseDataAndRewind = function(stream) {\n\tthis.parseHeader(stream);\n\tthis.data = stream.readUint8Array(this.size - this.hdr_size);\n\t// restore the header size as if the sample entry header had not been parsed\n\tthis.hdr_size -= 8;\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.SampleEntry.prototype.parseFooter = function(stream) {\n\tBoxParser.ContainerBox.prototype.parse.call(this, stream);\n}\n\n// Base SampleEntry types with default parsing\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_HINT);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SYSTEM);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_TEXT);\n\n//Base SampleEntry types for Audio and Video with specific parsing\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, function(stream) {\n\tvar compressorname_length;\n\tthis.parseHeader(stream);\n\tstream.readUint16();\n\tstream.readUint16();\n\tstream.readUint32Array(3);\n\tthis.width = stream.readUint16();\n\tthis.height = stream.readUint16();\n\tthis.horizresolution = stream.readUint32();\n\tthis.vertresolution = stream.readUint32();\n\tstream.readUint32();\n\tthis.frame_count = stream.readUint16();\n\tcompressorname_length = Math.min(31, stream.readUint8());\n\tthis.compressorname = stream.readString(compressorname_length);\n\tif (compressorname_length < 31) {\n\t\tstream.readString(31 - compressorname_length);\n\t}\n\tthis.depth = stream.readUint16();\n\tstream.readUint16();\n\tthis.parseFooter(stream);\n});\n\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, function(stream) {\n\tthis.parseHeader(stream);\n\tstream.readUint32Array(2);\n\tthis.channel_count = stream.readUint16();\n\tthis.samplesize = stream.readUint16();\n\tstream.readUint16();\n\tstream.readUint16();\n\tthis.samplerate = (stream.readUint32()/(1<<16));\n\tthis.parseFooter(stream);\n});\n\n// Sample entries inheriting from Audio and Video\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc4\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"av01\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hvc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hev1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mp4a\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ac-3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ec-3\");\n\n// Encrypted sample entries\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \t\"encv\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"enca\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \t\"encu\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SYSTEM, \t\"encs\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_TEXT, \t\t\"enct\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \t\"encm\");\n\n\n// file:src/parsing/a1lx.js\nBoxParser.createBoxCtor(\"a1lx\", function(stream) {\n\tvar large_size = stream.readUint8() & 1;\n\tvar FieldLength = ((large_size & 1) + 1) * 16;\n\tthis.layer_size = [];\n\tfor (var i = 0; i < 3; i++) {\n\t\tif (FieldLength == 16) {\n\t\t\tthis.layer_size[i] = stream.readUint16();\n\t\t} else {\n\t\t\tthis.layer_size[i] = stream.readUint32();\n\t\t}\n\t}\n});// file:src/parsing/a1op.js\nBoxParser.createBoxCtor(\"a1op\", function(stream) {\n\tthis.op_index = stream.readUint8();\n});// file:src/parsing/auxC.js\nBoxParser.createFullBoxCtor(\"auxC\", function(stream) {\n\tthis.aux_type = stream.readCString();\n\tvar aux_subtype_length = this.size - this.hdr_size - (this.aux_type.length + 1);\n\tthis.aux_subtype = stream.readUint8Array(aux_subtype_length);\n});// file:src/parsing/av1C.js\nBoxParser.createBoxCtor(\"av1C\", function(stream) {\n\tvar i;\n\tvar toparse;\n\tvar tmp = stream.readUint8();\n\tif ((tmp >> 7) & 0x1 !== 1) {\n\t\tLog.error(\"av1C marker problem\");\n\t\treturn;\n\t}\n\tthis.version = tmp & 0x7F;\n\tif (this.version !== 1) {\n\t\tLog.error(\"av1C version \"+this.version+\" not supported\");\n\t\treturn;\n\t}\n\ttmp = stream.readUint8();\n\tthis.seq_profile = (tmp >> 5) & 0x7;\n\tthis.seq_level_idx_0 = tmp & 0x1F;\n\ttmp = stream.readUint8();\n\tthis.seq_tier_0 = (tmp >> 7) & 0x1;\n\tthis.high_bitdepth = (tmp >> 6) & 0x1;\n\tthis.twelve_bit = (tmp >> 5) & 0x1;\n\tthis.monochrome = (tmp >> 4) & 0x1;\n\tthis.chroma_subsampling_x = (tmp >> 3) & 0x1;\n\tthis.chroma_subsampling_y = (tmp >> 2) & 0x1;\n\tthis.chroma_sample_position = (tmp & 0x3);\n\ttmp = stream.readUint8();\n\tthis.reserved_1 = (tmp >> 5) & 0x7;\n\tif (this.reserved_1 !== 0) {\n\t\tLog.error(\"av1C reserved_1 parsing problem\");\n\t\treturn;\n\t}\n\tthis.initial_presentation_delay_present = (tmp >> 4) & 0x1;\n\tif (this.initial_presentation_delay_present === 1) {\n\t\tthis.initial_presentation_delay_minus_one = (tmp & 0xF);\n\t} else {\n\t\tthis.reserved_2 = (tmp & 0xF);\n\t\tif (this.reserved_2 !== 0) {\n\t\t\tLog.error(\"av1C reserved_2 parsing problem\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tvar configOBUs_length = this.size - this.hdr_size - 4;\n\tthis.configOBUs = stream.readUint8Array(configOBUs_length);\n});\n\n// file:src/parsing/avcC.js\nBoxParser.createBoxCtor(\"avcC\", function(stream) {\n\tvar i;\n\tvar toparse;\n\tthis.configurationVersion = stream.readUint8();\n\tthis.AVCProfileIndication = stream.readUint8();\n\tthis.profile_compatibility = stream.readUint8();\n\tthis.AVCLevelIndication = stream.readUint8();\n\tthis.lengthSizeMinusOne = (stream.readUint8() & 0x3);\n\tthis.nb_SPS_nalus = (stream.readUint8() & 0x1F);\n\ttoparse = this.size - this.hdr_size - 6;\n\tthis.SPS = [];\n\tfor (i = 0; i < this.nb_SPS_nalus; i++) {\n\t\tthis.SPS[i] = {};\n\t\tthis.SPS[i].length = stream.readUint16();\n\t\tthis.SPS[i].nalu = stream.readUint8Array(this.SPS[i].length);\n\t\ttoparse -= 2+this.SPS[i].length;\n\t}\n\tthis.nb_PPS_nalus = stream.readUint8();\n\ttoparse--;\n\tthis.PPS = [];\n\tfor (i = 0; i < this.nb_PPS_nalus; i++) {\n\t\tthis.PPS[i] = {};\n\t\tthis.PPS[i].length = stream.readUint16();\n\t\tthis.PPS[i].nalu = stream.readUint8Array(this.PPS[i].length);\n\t\ttoparse -= 2+this.PPS[i].length;\n\t}\n\tif (toparse>0) {\n\t\tthis.ext = stream.readUint8Array(toparse);\n\t}\n});\n\n// file:src/parsing/btrt.js\nBoxParser.createBoxCtor(\"btrt\", function(stream) {\n\tthis.bufferSizeDB = stream.readUint32();\n\tthis.maxBitrate = stream.readUint32();\n\tthis.avgBitrate = stream.readUint32();\n});\n\n// file:src/parsing/clap.js\nBoxParser.createBoxCtor(\"clap\", function(stream) {\n\tthis.cleanApertureWidthN = stream.readUint32();\n\tthis.cleanApertureWidthD = stream.readUint32();\n\tthis.cleanApertureHeightN = stream.readUint32();\n\tthis.cleanApertureHeightD = stream.readUint32();\n\tthis.horizOffN = stream.readUint32();\n\tthis.horizOffD = stream.readUint32();\n\tthis.vertOffN = stream.readUint32();\n\tthis.vertOffD = stream.readUint32();\n});// file:src/parsing/clli.js\nBoxParser.createBoxCtor(\"clli\", function(stream) {\n\tthis.max_content_light_level = stream.readUint16();\n    this.max_pic_average_light_level = stream.readUint16();\n});\n\n// file:src/parsing/co64.js\nBoxParser.createFullBoxCtor(\"co64\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.chunk_offsets = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.chunk_offsets.push(stream.readUint64());\n\t\t}\n\t}\n});\n\n// file:src/parsing/CoLL.js\nBoxParser.createFullBoxCtor(\"CoLL\", function(stream) {\n\tthis.maxCLL = stream.readUint16();\n    this.maxFALL = stream.readUint16();\n});\n\n// file:src/parsing/colr.js\nBoxParser.createBoxCtor(\"colr\", function(stream) {\n\tthis.colour_type = stream.readString(4);\n\tif (this.colour_type === 'nclx') {\n\t\tthis.colour_primaries = stream.readUint16();\n\t\tthis.transfer_characteristics = stream.readUint16();\n\t\tthis.matrix_coefficients = stream.readUint16();\n\t\tvar tmp = stream.readUint8();\n\t\tthis.full_range_flag = tmp >> 7;\n\t} else if (this.colour_type === 'rICC') {\n\t\tthis.ICC_profile = stream.readUint8Array(this.size - 4);\n\t} else if (this.colour_type === 'prof') {\n\t\tthis.ICC_profile = stream.readUint8Array(this.size - 4);\n\t}\n});// file:src/parsing/cprt.js\nBoxParser.createFullBoxCtor(\"cprt\", function (stream) {\n\tthis.parseLanguage(stream);\n\tthis.notice = stream.readCString();\n});\n\n// file:src/parsing/cslg.js\nBoxParser.createFullBoxCtor(\"cslg\", function(stream) {\n\tvar entry_count;\n\tif (this.version === 0) {\n\t\tthis.compositionToDTSShift = stream.readInt32(); /* signed */\n\t\tthis.leastDecodeToDisplayDelta = stream.readInt32(); /* signed */\n\t\tthis.greatestDecodeToDisplayDelta = stream.readInt32(); /* signed */\n\t\tthis.compositionStartTime = stream.readInt32(); /* signed */\n\t\tthis.compositionEndTime = stream.readInt32(); /* signed */\n\t}\n});\n\n// file:src/parsing/ctts.js\nBoxParser.createFullBoxCtor(\"ctts\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.sample_counts = [];\n\tthis.sample_offsets = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\t/* some files are buggy and declare version=0 while using signed offsets.\n\t\t\t   The likelyhood of using the most significant bit in a 32-bits time offset is very low,\n\t\t\t   so using signed value here as well */\n\t\t\t   var value = stream.readInt32();\n\t\t\t   if (value < 0) {\n\t\t\t   \t\tLog.warn(\"BoxParser\", \"ctts box uses negative values without using version 1\");\n\t\t\t   }\n\t\t\tthis.sample_offsets.push(value);\n\t\t}\n\t} else if (this.version == 1) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\tthis.sample_offsets.push(stream.readInt32()); /* signed */\n\t\t}\n\t}\n});\n\n// file:src/parsing/dac3.js\nBoxParser.createBoxCtor(\"dac3\", function(stream) {\n\tvar tmp_byte1 = stream.readUint8();\n\tvar tmp_byte2 = stream.readUint8();\n\tvar tmp_byte3 = stream.readUint8();\n\tthis.fscod = tmp_byte1 >> 6;\n\tthis.bsid  = ((tmp_byte1 >> 1) & 0x1F);\n\tthis.bsmod = ((tmp_byte1 & 0x1) <<  2) | ((tmp_byte2 >> 6) & 0x3);\n\tthis.acmod = ((tmp_byte2 >> 3) & 0x7);\n\tthis.lfeon = ((tmp_byte2 >> 2) & 0x1);\n\tthis.bit_rate_code = (tmp_byte2 & 0x3) | ((tmp_byte3 >> 5) & 0x7);\n});\n\n// file:src/parsing/dec3.js\nBoxParser.createBoxCtor(\"dec3\", function(stream) {\n\tvar tmp_16 = stream.readUint16();\n\tthis.data_rate = tmp_16 >> 3;\n\tthis.num_ind_sub = tmp_16 & 0x7;\n\tthis.ind_subs = [];\n\tfor (var i = 0; i < this.num_ind_sub+1; i++) {\n\t\tvar ind_sub = {};\n\t\tthis.ind_subs.push(ind_sub);\n\t\tvar tmp_byte1 = stream.readUint8();\n\t\tvar tmp_byte2 = stream.readUint8();\n\t\tvar tmp_byte3 = stream.readUint8();\n\t\tind_sub.fscod = tmp_byte1 >> 6;\n\t\tind_sub.bsid  = ((tmp_byte1 >> 1) & 0x1F);\n\t\tind_sub.bsmod = ((tmp_byte1 & 0x1) << 4) | ((tmp_byte2 >> 4) & 0xF);\n\t\tind_sub.acmod = ((tmp_byte2 >> 1) & 0x7);\n\t\tind_sub.lfeon = (tmp_byte2 & 0x1);\n\t\tind_sub.num_dep_sub = ((tmp_byte3 >> 1) & 0xF);\n\t\tif (ind_sub.num_dep_sub > 0) {\n\t\t\tind_sub.chan_loc = ((tmp_byte3 & 0x1) << 8) | stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/dfLa.js\nBoxParser.createFullBoxCtor(\"dfLa\", function(stream) {\n    var BLOCKTYPE_MASK = 0x7F;\n    var LASTMETADATABLOCKFLAG_MASK = 0x80;\n\n    var boxesFound = [];\n    var knownBlockTypes = [\n        \"STREAMINFO\",\n        \"PADDING\",\n        \"APPLICATION\",\n        \"SEEKTABLE\",\n        \"VORBIS_COMMENT\",\n        \"CUESHEET\",\n        \"PICTURE\",\n        \"RESERVED\"\n    ];\n\n    // dfLa is a FullBox\n    this.parseFullHeader(stream);\n\n    // for (i=0; ; i++) { // to end of box\n    do {\n        var flagAndType = stream.readUint8();\n\n        var type = Math.min(\n            (flagAndType & BLOCKTYPE_MASK),\n            (knownBlockTypes.length - 1)\n        );\n\n        // if this is a STREAMINFO block, read the true samplerate since this\n        // can be different to the AudioSampleEntry samplerate.\n        if (!(type)) {\n            // read past all the other stuff\n            stream.readUint8Array(13);\n\n            // extract samplerate\n            this.samplerate = (stream.readUint32() >> 12);\n\n            // read to end of STREAMINFO\n            stream.readUint8Array(20);\n        } else {\n            // not interested in other block types so just discard length bytes\n            stream.readUint8Array(stream.readUint24());\n        }\n\n        boxesFound.push(knownBlockTypes[type]);\n\n        if (!!(flagAndType & LASTMETADATABLOCKFLAG_MASK)) {\n            break;\n        }\n    } while (true);\n\n    this.numMetadataBlocks =\n        boxesFound.length + \" (\" + boxesFound.join(\", \") + \")\";\n});\n// file:src/parsing/dimm.js\nBoxParser.createBoxCtor(\"dimm\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/dmax.js\nBoxParser.createBoxCtor(\"dmax\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/dmed.js\nBoxParser.createBoxCtor(\"dmed\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/dref.js\nBoxParser.createFullBoxCtor(\"dref\", function(stream) {\n\tvar ret;\n\tvar box;\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.entries.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/drep.js\nBoxParser.createBoxCtor(\"drep\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/elng.js\nBoxParser.createFullBoxCtor(\"elng\", function(stream) {\n\tthis.extended_language = stream.readString(this.size-this.hdr_size);\n});\n\n// file:src/parsing/elst.js\nBoxParser.createFullBoxCtor(\"elst\", function(stream) {\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry = {};\n\t\tthis.entries.push(entry);\n\t\tif (this.version === 1) {\n\t\t\tentry.segment_duration = stream.readUint64();\n\t\t\tentry.media_time = stream.readInt64();\n\t\t} else {\n\t\t\tentry.segment_duration = stream.readUint32();\n\t\t\tentry.media_time = stream.readInt32();\n\t\t}\n\t\tentry.media_rate_integer = stream.readInt16();\n\t\tentry.media_rate_fraction = stream.readInt16();\n\t}\n});\n\n// file:src/parsing/emsg.js\nBoxParser.createFullBoxCtor(\"emsg\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.timescale \t\t\t\t\t= stream.readUint32();\n\t\tthis.presentation_time \t\t\t= stream.readUint64();\n\t\tthis.event_duration\t\t\t \t= stream.readUint32();\n\t\tthis.id \t\t\t\t\t\t= stream.readUint32();\n\t\tthis.scheme_id_uri \t\t\t\t= stream.readCString();\n\t\tthis.value \t\t\t\t\t\t= stream.readCString();\n\t} else {\n\t\tthis.scheme_id_uri \t\t\t\t= stream.readCString();\n\t\tthis.value \t\t\t\t\t\t= stream.readCString();\n\t\tthis.timescale \t\t\t\t\t= stream.readUint32();\n\t\tthis.presentation_time_delta \t= stream.readUint32();\n\t\tthis.event_duration\t\t\t \t= stream.readUint32();\n\t\tthis.id \t\t\t\t\t\t= stream.readUint32();\n\t}\n\tvar message_size = this.size - this.hdr_size - (4*4 + (this.scheme_id_uri.length+1) + (this.value.length+1));\n\tif (this.version == 1) {\n\t\tmessage_size -= 4;\n\t}\n\tthis.message_data = stream.readUint8Array(message_size);\n});\n\n// file:src/parsing/esds.js\nBoxParser.createFullBoxCtor(\"esds\", function(stream) {\n\tvar esd_data = stream.readUint8Array(this.size-this.hdr_size);\n\tif (typeof MPEG4DescriptorParser !== \"undefined\") {\n\t\tvar esd_parser = new MPEG4DescriptorParser();\n\t\tthis.esd = esd_parser.parseOneDescriptor(new DataStream(esd_data.buffer, 0, DataStream.BIG_ENDIAN));\n\t}\n});\n\n// file:src/parsing/fiel.js\nBoxParser.createBoxCtor(\"fiel\", function(stream) {\n\tthis.fieldCount = stream.readUint8();\n\tthis.fieldOrdering = stream.readUint8();\n});\n\n// file:src/parsing/frma.js\nBoxParser.createBoxCtor(\"frma\", function(stream) {\n\tthis.data_format = stream.readString(4);\n});\n\n// file:src/parsing/ftyp.js\nBoxParser.createBoxCtor(\"ftyp\", function(stream) {\n\tvar toparse = this.size - this.hdr_size;\n\tthis.major_brand = stream.readString(4);\n\tthis.minor_version = stream.readUint32();\n\ttoparse -= 8;\n\tthis.compatible_brands = [];\n\tvar i = 0;\n\twhile (toparse>=4) {\n\t\tthis.compatible_brands[i] = stream.readString(4);\n\t\ttoparse -= 4;\n\t\ti++;\n\t}\n});\n\n// file:src/parsing/hdlr.js\nBoxParser.createFullBoxCtor(\"hdlr\", function(stream) {\n\tif (this.version === 0) {\n\t\tstream.readUint32();\n\t\tthis.handler = stream.readString(4);\n\t\tstream.readUint32Array(3);\n\t\tthis.name = stream.readString(this.size-this.hdr_size-20);\n\t\tif (this.name[this.name.length-1]==='\\0') {\n\t\t\tthis.name = this.name.slice(0,-1);\n\t\t}\n\t}\n});\n\n// file:src/parsing/hvcC.js\nBoxParser.createBoxCtor(\"hvcC\", function(stream) {\n\tvar i, j;\n\tvar nb_nalus;\n\tvar length;\n\tvar tmp_byte;\n\tthis.configurationVersion = stream.readUint8();\n\ttmp_byte = stream.readUint8();\n\tthis.general_profile_space = tmp_byte >> 6;\n\tthis.general_tier_flag = (tmp_byte & 0x20) >> 5;\n\tthis.general_profile_idc = (tmp_byte & 0x1F);\n\tthis.general_profile_compatibility = stream.readUint32();\n\tthis.general_constraint_indicator = stream.readUint8Array(6);\n\tthis.general_level_idc = stream.readUint8();\n\tthis.min_spatial_segmentation_idc = stream.readUint16() & 0xFFF;\n\tthis.parallelismType = (stream.readUint8() & 0x3);\n\tthis.chroma_format_idc = (stream.readUint8() & 0x3);\n\tthis.bit_depth_luma_minus8 = (stream.readUint8() & 0x7);\n\tthis.bit_depth_chroma_minus8 = (stream.readUint8() & 0x7);\n\tthis.avgFrameRate = stream.readUint16();\n\ttmp_byte = stream.readUint8();\n\tthis.constantFrameRate = (tmp_byte >> 6);\n\tthis.numTemporalLayers = (tmp_byte & 0XD) >> 3;\n\tthis.temporalIdNested = (tmp_byte & 0X4) >> 2;\n\tthis.lengthSizeMinusOne = (tmp_byte & 0X3);\n\n\tthis.nalu_arrays = [];\n\tvar numOfArrays = stream.readUint8();\n\tfor (i = 0; i < numOfArrays; i++) {\n\t\tvar nalu_array = [];\n\t\tthis.nalu_arrays.push(nalu_array);\n\t\ttmp_byte = stream.readUint8()\n\t\tnalu_array.completeness = (tmp_byte & 0x80) >> 7;\n\t\tnalu_array.nalu_type = tmp_byte & 0x3F;\n\t\tvar numNalus = stream.readUint16();\n\t\tfor (j = 0; j < numNalus; j++) {\n\t\t\tvar nalu = {}\n\t\t\tnalu_array.push(nalu);\n\t\t\tlength = stream.readUint16();\n\t\t\tnalu.data   = stream.readUint8Array(length);\n\t\t}\n\t}\n});\n\n// file:src/parsing/iinf.js\nBoxParser.createFullBoxCtor(\"iinf\", function(stream) {\n\tvar ret;\n\tif (this.version === 0) {\n\t\tthis.entry_count = stream.readUint16();\n\t} else {\n\t\tthis.entry_count = stream.readUint32();\n\t}\n\tthis.item_infos = [];\n\tfor (var i = 0; i < this.entry_count; i++) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (ret.box.type !== \"infe\") {\n\t\t\t\tLog.error(\"BoxParser\", \"Expected 'infe' box, got \"+ret.box.type);\n\t\t\t}\n\t\t\tthis.item_infos[i] = ret.box;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/iloc.js\nBoxParser.createFullBoxCtor(\"iloc\", function(stream) {\n\tvar byte;\n\tbyte = stream.readUint8();\n\tthis.offset_size = (byte >> 4) & 0xF;\n\tthis.length_size = byte & 0xF;\n\tbyte = stream.readUint8();\n\tthis.base_offset_size = (byte >> 4) & 0xF;\n\tif (this.version === 1 || this.version === 2) {\n\t\tthis.index_size = byte & 0xF;\n\t} else {\n\t\tthis.index_size = 0;\n\t\t// reserved = byte & 0xF;\n\t}\n\tthis.items = [];\n\tvar item_count = 0;\n\tif (this.version < 2) {\n\t\titem_count = stream.readUint16();\n\t} else if (this.version === 2) {\n\t\titem_count = stream.readUint32();\n\t} else {\n\t\tthrow \"version of iloc box not supported\";\n\t}\n\tfor (var i = 0; i < item_count; i++) {\n\t\tvar item = {};\n\t\tthis.items.push(item);\n\t\tif (this.version < 2) {\n\t\t\titem.item_ID = stream.readUint16();\n\t\t} else if (this.version === 2) {\n\t\t\titem.item_ID = stream.readUint16();\n\t\t} else {\n\t\t\tthrow \"version of iloc box not supported\";\n\t\t}\n\t\tif (this.version === 1 || this.version === 2) {\n\t\t\titem.construction_method = (stream.readUint16() & 0xF);\n\t\t} else {\n\t\t\titem.construction_method = 0;\n\t\t}\n\t\titem.data_reference_index = stream.readUint16();\n\t\tswitch(this.base_offset_size) {\n\t\t\tcase 0:\n\t\t\t\titem.base_offset = 0;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\titem.base_offset = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tcase 8:\n\t\t\t\titem.base_offset = stream.readUint64();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"Error reading base offset size\";\n\t\t}\n\t\tvar extent_count = stream.readUint16();\n\t\titem.extents = [];\n\t\tfor (var j=0; j < extent_count; j++) {\n\t\t\tvar extent = {};\n\t\t\titem.extents.push(extent);\n\t\t\tif (this.version === 1 || this.version === 2) {\n\t\t\t\tswitch(this.index_size) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\textent.extent_index = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\textent.extent_index = stream.readUint32();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8:\n\t\t\t\t\t\textent.extent_index = stream.readUint64();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(this.offset_size) {\n\t\t\t\tcase 0:\n\t\t\t\t\textent.extent_offset = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\textent.extent_offset = stream.readUint32();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\textent.extent_offset = stream.readUint64();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t}\n\t\t\tswitch(this.length_size) {\n\t\t\t\tcase 0:\n\t\t\t\t\textent.extent_length = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\textent.extent_length = stream.readUint32();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\textent.extent_length = stream.readUint64();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/imir.js\nBoxParser.createBoxCtor(\"imir\", function(stream) {\n\tvar tmp = stream.readUint8();\n\tthis.reserved = tmp >> 7;\n\tthis.axis = tmp & 1;\n});// file:src/parsing/infe.js\nBoxParser.createFullBoxCtor(\"infe\", function(stream) {\n\tif (this.version === 0 || this.version === 1) {\n\t\tthis.item_ID = stream.readUint16();\n\t\tthis.item_protection_index = stream.readUint16();\n\t\tthis.item_name = stream.readCString();\n\t\tthis.content_type = stream.readCString();\n\t\tthis.content_encoding = stream.readCString();\n\t}\n\tif (this.version === 1) {\n\t\tthis.extension_type = stream.readString(4);\n\t\tLog.warn(\"BoxParser\", \"Cannot parse extension type\");\n\t\tstream.seek(this.start+this.size);\n\t\treturn;\n\t}\n\tif (this.version >= 2) {\n\t\tif (this.version === 2) {\n\t\t\tthis.item_ID = stream.readUint16();\n\t\t} else if (this.version === 3) {\n\t\t\tthis.item_ID = stream.readUint32();\n\t\t}\n\t\tthis.item_protection_index = stream.readUint16();\n\t\tthis.item_type = stream.readString(4);\n\t\tthis.item_name = stream.readCString();\n\t\tif (this.item_type === \"mime\") {\n\t\t\tthis.content_type = stream.readCString();\n\t\t\tthis.content_encoding = stream.readCString();\n\t\t} else if (this.item_type === \"uri \") {\n\t\t\tthis.item_uri_type = stream.readCString();\n\t\t}\n\t}\n});\n// file:src/parsing/ipma.js\nBoxParser.createFullBoxCtor(\"ipma\", function(stream) {\n\tvar i, j;\n\tentry_count = stream.readUint32();\n\tthis.associations = [];\n\tfor(i=0; i<entry_count; i++) {\n\t\tvar item_assoc = {};\n\t\tthis.associations.push(item_assoc);\n\t\tif (this.version < 1) {\n\t\t\titem_assoc.id = stream.readUint16();\n\t\t} else {\n\t\t\titem_assoc.id = stream.readUint32();\n\t\t}\n\t\tvar association_count = stream.readUint8();\n\t\titem_assoc.props = [];\n\t\tfor (j = 0; j < association_count; j++) {\n\t\t\tvar tmp = stream.readUint8();\n\t\t\tvar p = {};\n\t\t\titem_assoc.props.push(p);\n\t\t\tp.essential = ((tmp & 0x80) >> 7) === 1;\n\t\t\tif (this.flags & 0x1) {\n\t\t\t\tp.property_index = (tmp & 0x7F) << 8 | stream.readUint8();\n\t\t\t} else {\n\t\t\t\tp.property_index = (tmp & 0x7F);\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/iref.js\nBoxParser.createFullBoxCtor(\"iref\", function(stream) {\n\tvar ret;\n\tvar entryCount;\n\tvar box;\n\tthis.references = [];\n\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (this.version === 0) {\n\t\t\t\tbox = new BoxParser.SingleItemTypeReferenceBox(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t} else {\n\t\t\t\tbox = new BoxParser.SingleItemTypeReferenceBoxLarge(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t}\n\t\t\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\t\t\tLog.warn(\"BoxParser\", box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.references.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n// file:src/parsing/irot.js\nBoxParser.createBoxCtor(\"irot\", function(stream) {\n\tthis.angle = stream.readUint8() & 0x3;\n});\n\n// file:src/parsing/ispe.js\nBoxParser.createFullBoxCtor(\"ispe\", function(stream) {\n\tthis.image_width = stream.readUint32();\n\tthis.image_height = stream.readUint32();\n});// file:src/parsing/kind.js\nBoxParser.createFullBoxCtor(\"kind\", function(stream) {\n\tthis.schemeURI = stream.readCString();\n\tthis.value = stream.readCString();\n});\n// file:src/parsing/leva.js\nBoxParser.createFullBoxCtor(\"leva\", function(stream) {\n\tvar count = stream.readUint8();\n\tthis.levels = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tvar level = {};\n\t\tthis.levels[i] = level;\n\t\tlevel.track_ID = stream.readUint32();\n\t\tvar tmp_byte = stream.readUint8();\n\t\tlevel.padding_flag = tmp_byte >> 7;\n\t\tlevel.assignment_type = tmp_byte & 0x7F;\n\t\tswitch (level.assignment_type) {\n\t\t\tcase 0:\n\t\t\t\tlevel.grouping_type = stream.readString(4);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tlevel.grouping_type = stream.readString(4);\n\t\t\t\tlevel.grouping_type_parameter = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tlevel.sub_track_id = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown leva assignement type\");\n\t\t}\n\t}\n});\n\n// file:src/parsing/lsel.js\nBoxParser.createBoxCtor(\"lsel\", function(stream) {\n\tthis.layer_id = stream.readUint16();\n});// file:src/parsing/maxr.js\nBoxParser.createBoxCtor(\"maxr\", function(stream) {\n\tthis.period = stream.readUint32();\n\tthis.bytes = stream.readUint32();\n});\n\n// file:src/parsing/mdcv.js\nBoxParser.createBoxCtor(\"mdcv\", function(stream) {\n    this.display_primaries = [];\n    this.display_primaries[0] = {};\n    this.display_primaries[0].x = stream.readUint16();\n    this.display_primaries[0].y = stream.readUint16();\n    this.display_primaries[1] = {};\n    this.display_primaries[1].x = stream.readUint16();\n    this.display_primaries[1].y = stream.readUint16();\n    this.display_primaries[2] = {};\n    this.display_primaries[2].x = stream.readUint16();\n    this.display_primaries[2].y = stream.readUint16();\n    this.white_point = {};\n    this.white_point.x = stream.readUint16();\n    this.white_point.y = stream.readUint16();\n    this.max_display_mastering_luminance = stream.readUint32();\n    this.min_display_mastering_luminance = stream.readUint32();\n});\n\n// file:src/parsing/mdhd.js\nBoxParser.createFullBoxCtor(\"mdhd\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tthis.parseLanguage(stream);\n\tstream.readUint16();\n});\n\n// file:src/parsing/mehd.js\nBoxParser.createFullBoxCtor(\"mehd\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tLog.warn(\"BoxParser\", \"mehd box incorrectly uses flags set to 1, converting version to 1\");\n\t\tthis.version = 1;\n\t}\n\tif (this.version == 1) {\n\t\tthis.fragment_duration = stream.readUint64();\n\t} else {\n\t\tthis.fragment_duration = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/meta.js\nBoxParser.createFullBoxCtor(\"meta\", function(stream) {\n\tthis.boxes = [];\n\tBoxParser.ContainerBox.prototype.parse.call(this, stream);\n});\n// file:src/parsing/mfhd.js\nBoxParser.createFullBoxCtor(\"mfhd\", function(stream) {\n\tthis.sequence_number = stream.readUint32();\n});\n\n// file:src/parsing/mfro.js\nBoxParser.createFullBoxCtor(\"mfro\", function(stream) {\n\tthis._size = stream.readUint32();\n});\n\n// file:src/parsing/mvhd.js\nBoxParser.createFullBoxCtor(\"mvhd\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tthis.rate = stream.readUint32();\n\tthis.volume = stream.readUint16()>>8;\n\tstream.readUint16();\n\tstream.readUint32Array(2);\n\tthis.matrix = stream.readUint32Array(9);\n\tstream.readUint32Array(6);\n\tthis.next_track_id = stream.readUint32();\n});\n// file:src/parsing/npck.js\nBoxParser.createBoxCtor(\"npck\", function(stream) {\n\tthis.packetssent = stream.readUint32();\n});\n\n// file:src/parsing/nump.js\nBoxParser.createBoxCtor(\"nump\", function(stream) {\n\tthis.packetssent = stream.readUint64();\n});\n\n// file:src/parsing/padb.js\nBoxParser.createFullBoxCtor(\"padb\", function(stream) {\n\tvar sample_count = stream.readUint32();\n\tthis.padbits = [];\n\tfor (var i = 0; i < Math.floor((sample_count+1)/2); i++) {\n\t\tthis.padbits = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/pasp.js\nBoxParser.createBoxCtor(\"pasp\", function(stream) {\n\tthis.hSpacing = stream.readUint32();\n\tthis.vSpacing = stream.readUint32();\n});// file:src/parsing/payl.js\nBoxParser.createBoxCtor(\"payl\", function(stream) {\n\tthis.text = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/payt.js\nBoxParser.createBoxCtor(\"payt\", function(stream) {\n\tthis.payloadID = stream.readUint32();\n\tvar count = stream.readUint8();\n\tthis.rtpmap_string = stream.readString(count);\n});\n\n// file:src/parsing/pdin.js\nBoxParser.createFullBoxCtor(\"pdin\", function(stream) {\n\tvar count = (this.size - this.hdr_size)/8;\n\tthis.rate = [];\n\tthis.initial_delay = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.rate[i] = stream.readUint32();\n\t\tthis.initial_delay[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/pitm.js\nBoxParser.createFullBoxCtor(\"pitm\", function(stream) {\n\tif (this.version === 0) {\n\t\tthis.item_id = stream.readUint16();\n\t} else {\n\t\tthis.item_id = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/pixi.js\nBoxParser.createFullBoxCtor(\"pixi\", function(stream) {\n\tvar i;\n\tthis.num_channels = stream.readUint8();\n\tthis.bits_per_channels = [];\n\tfor (i = 0; i < this.num_channels; i++) {\n\t\tthis.bits_per_channels[i] = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/pmax.js\nBoxParser.createBoxCtor(\"pmax\", function(stream) {\n\tthis.bytes = stream.readUint32();\n});\n\n// file:src/parsing/prft.js\nBoxParser.createFullBoxCtor(\"prft\", function(stream) {\n\tthis.ref_track_id = stream.readUint32();\n\tthis.ntp_timestamp = stream.readUint64();\n\tif (this.version === 0) {\n\t\tthis.media_time = stream.readUint32();\n\t} else {\n\t\tthis.media_time = stream.readUint64();\n\t}\n});\n\n// file:src/parsing/pssh.js\nBoxParser.createFullBoxCtor(\"pssh\", function(stream) {\n\tthis.system_id = BoxParser.parseHex16(stream);\n\tif (this.version > 0) {\n\t\tvar count = stream.readUint32();\n\t\tthis.kid = [];\n\t\tfor (var i = 0; i < count; i++) {\n\t\t\tthis.kid[i] = BoxParser.parseHex16(stream);\n\t\t}\n\t}\n\tvar datasize = stream.readUint32();\n\tif (datasize > 0) {\n\t\tthis.data = stream.readUint8Array(datasize);\n\t}\n});\n\n// file:src/parsing/qt/clef.js\nBoxParser.createFullBoxCtor(\"clef\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/enof.js\nBoxParser.createFullBoxCtor(\"enof\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/prof.js\nBoxParser.createFullBoxCtor(\"prof\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/tapt.js\nBoxParser.createContainerBoxCtor(\"tapt\", null, [ \"clef\", \"prof\", \"enof\"]);// file:src/parsing/rtp.js\nBoxParser.createBoxCtor(\"rtp \", function(stream) {\n\tthis.descriptionformat = stream.readString(4);\n\tthis.sdptext = stream.readString(this.size - this.hdr_size - 4);\n});\n\n// file:src/parsing/saio.js\nBoxParser.createFullBoxCtor(\"saio\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.aux_info_type = stream.readUint32();\n\t\tthis.aux_info_type_parameter = stream.readUint32();\n\t}\n\tvar count = stream.readUint32();\n\tthis.offset = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tif (this.version === 0) {\n\t\t\tthis.offset[i] = stream.readUint32();\n\t\t} else {\n\t\t\tthis.offset[i] = stream.readUint64();\n\t\t}\n\t}\n});\n// file:src/parsing/saiz.js\nBoxParser.createFullBoxCtor(\"saiz\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.aux_info_type = stream.readUint32();\n\t\tthis.aux_info_type_parameter = stream.readUint32();\n\t}\n\tthis.default_sample_info_size = stream.readUint8();\n\tvar count = stream.readUint32();\n\tthis.sample_info_size = [];\n\tif (this.default_sample_info_size === 0) {\n\t\tfor (var i = 0; i < count; i++) {\n\t\t\tthis.sample_info_size[i] = stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/sampleentries/mett.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"mett\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/metx.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"metx\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.namespace = stream.readCString();\n\tthis.schema_location = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/sbtt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"sbtt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/stpp.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"stpp\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.namespace = stream.readCString();\n\tthis.schema_location = stream.readCString();\n\tthis.auxiliary_mime_types = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/stxt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"stxt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/tx3g.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"tx3g\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.displayFlags = stream.readUint32();\n\tthis.horizontal_justification = stream.readInt8();\n\tthis.vertical_justification = stream.readInt8();\n\tthis.bg_color_rgba = stream.readUint8Array(4);\n\tthis.box_record = stream.readInt16Array(4);\n\tthis.style_record = stream.readUint8Array(12);\n\tthis.parseFooter(stream);\n});\n// file:src/parsing/sampleentries/wvtt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"wvtt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/samplegroups/alst.js\nBoxParser.createSampleGroupCtor(\"alst\", function(stream) {\n\tvar i;\n\tvar roll_count = stream.readUint16();\n\tthis.first_output_sample = stream.readUint16();\n\tthis.sample_offset = [];\n\tfor (i = 0; i < roll_count; i++) {\n\t\tthis.sample_offset[i] = stream.readUint32();\n\t}\n\tvar remaining = this.description_length - 4 - 4*roll_count;\n\tthis.num_output_samples = [];\n\tthis.num_total_samples = [];\n\tfor (i = 0; i < remaining/4; i++) {\n\t\tthis.num_output_samples[i] = stream.readUint16();\n\t\tthis.num_total_samples[i] = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/samplegroups/avll.js\nBoxParser.createSampleGroupCtor(\"avll\", function(stream) {\n\tthis.layerNumber = stream.readUint8();\n\tthis.accurateStatisticsFlag = stream.readUint8();\n\tthis.avgBitRate = stream.readUint16();\n\tthis.avgFrameRate = stream.readUint16();\n});\n\n// file:src/parsing/samplegroups/avss.js\nBoxParser.createSampleGroupCtor(\"avss\", function(stream) {\n\tthis.subSequenceIdentifier = stream.readUint16();\n\tthis.layerNumber = stream.readUint8();\n\tvar tmp_byte = stream.readUint8();\n\tthis.durationFlag = tmp_byte >> 7;\n\tthis.avgRateFlag = (tmp_byte >> 6) & 0x1;\n\tif (this.durationFlag) {\n\t\tthis.duration = stream.readUint32();\n\t}\n\tif (this.avgRateFlag) {\n\t\tthis.accurateStatisticsFlag = stream.readUint8();\n\t\tthis.avgBitRate = stream.readUint16();\n\t\tthis.avgFrameRate = stream.readUint16();\n\t}\n\tthis.dependency = [];\n\tvar numReferences = stream.readUint8();\n\tfor (var i = 0; i < numReferences; i++) {\n\t\tvar dependencyInfo = {};\n\t\tthis.dependency.push(dependencyInfo);\n\t\tdependencyInfo.subSeqDirectionFlag = stream.readUint8();\n\t\tdependencyInfo.layerNumber = stream.readUint8();\n\t\tdependencyInfo.subSequenceIdentifier = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/samplegroups/dtrt.js\nBoxParser.createSampleGroupCtor(\"dtrt\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/mvif.js\nBoxParser.createSampleGroupCtor(\"mvif\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/prol.js\nBoxParser.createSampleGroupCtor(\"prol\", function(stream) {\n\tthis.roll_distance = stream.readInt16();\n});\n\n// file:src/parsing/samplegroups/rap.js\nBoxParser.createSampleGroupCtor(\"rap \", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.num_leading_samples_known = tmp_byte >> 7;\n\tthis.num_leading_samples = tmp_byte & 0x7F;\n});\n\n// file:src/parsing/samplegroups/rash.js\nBoxParser.createSampleGroupCtor(\"rash\", function(stream) {\n\tthis.operation_point_count = stream.readUint16();\n\tif (this.description_length !== 2+(this.operation_point_count === 1?2:this.operation_point_count*6)+9) {\n\t\tLog.warn(\"BoxParser\", \"Mismatch in \"+this.grouping_type+\" sample group length\");\n\t\tthis.data =  stream.readUint8Array(this.description_length-2);\n\t} else {\n\t\tif (this.operation_point_count === 1) {\n\t\t\tthis.target_rate_share = stream.readUint16();\n\t\t} else {\n\t\t\tthis.target_rate_share = [];\n\t\t\tthis.available_bitrate = [];\n\t\t\tfor (var i = 0; i < this.operation_point_count; i++) {\n\t\t\t\tthis.available_bitrate[i] = stream.readUint32();\n\t\t\t\tthis.target_rate_share[i] = stream.readUint16();\n\t\t\t}\n\t\t}\n\t\tthis.maximum_bitrate = stream.readUint32();\n\t\tthis.minimum_bitrate = stream.readUint32();\n\t\tthis.discard_priority = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/samplegroups/roll.js\nBoxParser.createSampleGroupCtor(\"roll\", function(stream) {\n\tthis.roll_distance = stream.readInt16();\n});\n\n// file:src/parsing/samplegroups/samplegroup.js\nBoxParser.SampleGroupEntry.prototype.parse = function(stream) {\n\tLog.warn(\"BoxParser\", \"Unknown Sample Group type: \"+this.grouping_type);\n\tthis.data =  stream.readUint8Array(this.description_length);\n}\n\n// file:src/parsing/samplegroups/scif.js\nBoxParser.createSampleGroupCtor(\"scif\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/scnm.js\nBoxParser.createSampleGroupCtor(\"scnm\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/seig.js\nBoxParser.createSampleGroupCtor(\"seig\", function(stream) {\n\tthis.reserved = stream.readUint8();\n\tvar tmp = stream.readUint8();\n\tthis.crypt_byte_block = tmp >> 4;\n\tthis.skip_byte_block = tmp & 0xF;\n\tthis.isProtected = stream.readUint8();\n\tthis.Per_Sample_IV_Size = stream.readUint8();\n\tthis.KID = BoxParser.parseHex16(stream);\n\tthis.constant_IV_size = 0;\n\tthis.constant_IV = 0;\n\tif (this.isProtected === 1 && this.Per_Sample_IV_Size === 0) {\n\t\tthis.constant_IV_size = stream.readUint8();\n\t\tthis.constant_IV = stream.readUint8Array(this.constant_IV_size);\n\t}\n});\n\n// file:src/parsing/samplegroups/stsa.js\nBoxParser.createSampleGroupCtor(\"stsa\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/sync.js\nBoxParser.createSampleGroupCtor(\"sync\", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.NAL_unit_type = tmp_byte & 0x3F;\n});\n\n// file:src/parsing/samplegroups/tele.js\nBoxParser.createSampleGroupCtor(\"tele\", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.level_independently_decodable = tmp_byte >> 7;\n});\n\n// file:src/parsing/samplegroups/tsas.js\nBoxParser.createSampleGroupCtor(\"tsas\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/tscl.js\nBoxParser.createSampleGroupCtor(\"tscl\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/vipr.js\nBoxParser.createSampleGroupCtor(\"vipr\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/sbgp.js\nBoxParser.createFullBoxCtor(\"sbgp\", function(stream) {\n\tthis.grouping_type = stream.readString(4);\n\tif (this.version === 1) {\n\t\tthis.grouping_type_parameter = stream.readUint32();\n\t} else {\n\t\tthis.grouping_type_parameter = 0;\n\t}\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry = {};\n\t\tthis.entries.push(entry);\n\t\tentry.sample_count = stream.readInt32();\n\t\tentry.group_description_index = stream.readInt32();\n\t}\n});\n\n// file:src/parsing/schm.js\nBoxParser.createFullBoxCtor(\"schm\", function(stream) {\n\tthis.scheme_type = stream.readString(4);\n\tthis.scheme_version = stream.readUint32();\n\tif (this.flags & 0x000001) {\n\t\tthis.scheme_uri = stream.readString(this.size - this.hdr_size - 8);\n\t}\n});\n\n// file:src/parsing/sdp.js\nBoxParser.createBoxCtor(\"sdp \", function(stream) {\n\tthis.sdptext = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/sdtp.js\nBoxParser.createFullBoxCtor(\"sdtp\", function(stream) {\n\tvar tmp_byte;\n\tvar count = (this.size - this.hdr_size);\n\tthis.is_leading = [];\n\tthis.sample_depends_on = [];\n\tthis.sample_is_depended_on = [];\n\tthis.sample_has_redundancy = [];\n\tfor (var i = 0; i < count; i++) {\n\t\ttmp_byte = stream.readUint8();\n\t\tthis.is_leading[i] = tmp_byte >> 6;\n\t\tthis.sample_depends_on[i] = (tmp_byte >> 4) & 0x3;\n\t\tthis.sample_is_depended_on[i] = (tmp_byte >> 2) & 0x3;\n\t\tthis.sample_has_redundancy[i] = tmp_byte & 0x3;\n\t}\n});\n\n// file:src/parsing/senc.js\n// Cannot be fully parsed because Per_Sample_IV_Size needs to be known\r\nBoxParser.createFullBoxCtor(\"senc\" /*, function(stream) {\r\n\tthis.parseFullHeader(stream);\r\n\tvar sample_count = stream.readUint32();\r\n\tthis.samples = [];\r\n\tfor (var i = 0; i < sample_count; i++) {\r\n\t\tvar sample = {};\r\n\t\t// tenc.default_Per_Sample_IV_Size or seig.Per_Sample_IV_Size\r\n\t\tsample.InitializationVector = this.readUint8Array(Per_Sample_IV_Size*8);\r\n\t\tif (this.flags & 0x2) {\r\n\t\t\tsample.subsamples = [];\r\n\t\t\tsubsample_count = stream.readUint16();\r\n\t\t\tfor (var j = 0; j < subsample_count; j++) {\r\n\t\t\t\tvar subsample = {};\r\n\t\t\t\tsubsample.BytesOfClearData = stream.readUint16();\r\n\t\t\t\tsubsample.BytesOfProtectedData = stream.readUint32();\r\n\t\t\t\tsample.subsamples.push(subsample);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO\r\n\t\tthis.samples.push(sample);\r\n\t}\r\n}*/);\r\n// file:src/parsing/sgpd.js\nBoxParser.createFullBoxCtor(\"sgpd\", function(stream) {\n\tthis.grouping_type = stream.readString(4);\n\tLog.debug(\"BoxParser\", \"Found Sample Groups of type \"+this.grouping_type);\n\tif (this.version === 1) {\n\t\tthis.default_length = stream.readUint32();\n\t} else {\n\t\tthis.default_length = 0;\n\t}\n\tif (this.version >= 2) {\n\t\tthis.default_group_description_index = stream.readUint32();\n\t}\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry;\n\t\tif (BoxParser[this.grouping_type+\"SampleGroupEntry\"]) {\n\t\t\tentry = new BoxParser[this.grouping_type+\"SampleGroupEntry\"](this.grouping_type);\n\t\t}  else {\n\t\t\tentry = new BoxParser.SampleGroupEntry(this.grouping_type);\n\t\t}\n\t\tthis.entries.push(entry);\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tentry.description_length = stream.readUint32();\n\t\t\t} else {\n\t\t\t\tentry.description_length = this.default_length;\n\t\t\t}\n\t\t} else {\n\t\t\tentry.description_length = this.default_length;\n\t\t}\n\t\tif (entry.write === BoxParser.SampleGroupEntry.prototype.write) {\n\t\t\tLog.info(\"BoxParser\", \"SampleGroup for type \"+this.grouping_type+\" writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t// storing data\n\t\t\tentry.data = stream.readUint8Array(entry.description_length);\n\t\t\t// rewinding\n\t\t\tstream.position -= entry.description_length;\n\t\t}\n\t\tentry.parse(stream);\n\t}\n});\n\n// file:src/parsing/sidx.js\nBoxParser.createFullBoxCtor(\"sidx\", function(stream) {\n\tthis.reference_ID = stream.readUint32();\n\tthis.timescale = stream.readUint32();\n\tif (this.version === 0) {\n\t\tthis.earliest_presentation_time = stream.readUint32();\n\t\tthis.first_offset = stream.readUint32();\n\t} else {\n\t\tthis.earliest_presentation_time = stream.readUint64();\n\t\tthis.first_offset = stream.readUint64();\n\t}\n\tstream.readUint16();\n\tthis.references = [];\n\tvar count = stream.readUint16();\n\tfor (var i = 0; i < count; i++) {\n\t\tvar ref = {};\n\t\tthis.references.push(ref);\n\t\tvar tmp_32 = stream.readUint32();\n\t\tref.reference_type = (tmp_32 >> 31) & 0x1;\n\t\tref.referenced_size = tmp_32 & 0x7FFFFFFF;\n\t\tref.subsegment_duration = stream.readUint32();\n\t\ttmp_32 = stream.readUint32();\n\t\tref.starts_with_SAP = (tmp_32 >> 31) & 0x1;\n\t\tref.SAP_type = (tmp_32 >> 28) & 0x7;\n\t\tref.SAP_delta_time = tmp_32 & 0xFFFFFFF;\n\t}\n});\n\n// file:src/parsing/singleitemtypereference.js\nBoxParser.SingleItemTypeReferenceBox = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.SingleItemTypeReferenceBox.prototype = new BoxParser.Box();\nBoxParser.SingleItemTypeReferenceBox.prototype.parse = function(stream) {\n\tthis.from_item_ID = stream.readUint16();\n\tvar count =  stream.readUint16();\n\tthis.references = [];\n\tfor(var i = 0; i < count; i++) {\n\t\tthis.references[i] = stream.readUint16();\n\t}\n}\n\n// file:src/parsing/singleitemtypereferencelarge.js\nBoxParser.SingleItemTypeReferenceBoxLarge = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.SingleItemTypeReferenceBoxLarge.prototype = new BoxParser.Box();\nBoxParser.SingleItemTypeReferenceBoxLarge.prototype.parse = function(stream) {\n\tthis.from_item_ID = stream.readUint32();\n\tvar count =  stream.readUint16();\n\tthis.references = [];\n\tfor(var i = 0; i < count; i++) {\n\t\tthis.references[i] = stream.readUint32();\n\t}\n}\n\n// file:src/parsing/SmDm.js\nBoxParser.createFullBoxCtor(\"SmDm\", function(stream) {\n\tthis.primaryRChromaticity_x = stream.readUint16();\n    this.primaryRChromaticity_y = stream.readUint16();\n    this.primaryGChromaticity_x = stream.readUint16();\n    this.primaryGChromaticity_y = stream.readUint16();\n    this.primaryBChromaticity_x = stream.readUint16();\n    this.primaryBChromaticity_y = stream.readUint16();\n    this.whitePointChromaticity_x = stream.readUint16();\n    this.whitePointChromaticity_y = stream.readUint16();\n    this.luminanceMax = stream.readUint32();\n    this.luminanceMin = stream.readUint32();\n});\n\n// file:src/parsing/smhd.js\nBoxParser.createFullBoxCtor(\"smhd\", function(stream) {\n\tthis.balance = stream.readUint16();\n\tstream.readUint16();\n});\n\n// file:src/parsing/ssix.js\nBoxParser.createFullBoxCtor(\"ssix\", function(stream) {\n\tthis.subsegments = [];\n\tvar subsegment_count = stream.readUint32();\n\tfor (var i = 0; i < subsegment_count; i++) {\n\t\tvar subsegment = {};\n\t\tthis.subsegments.push(subsegment);\n\t\tsubsegment.ranges = [];\n\t\tvar range_count = stream.readUint32();\n\t\tfor (var j = 0; j < range_count; j++) {\n\t\t\tvar range = {};\n\t\t\tsubsegment.ranges.push(range);\n\t\t\trange.level = stream.readUint8();\n\t\t\trange.range_size = stream.readUint24();\n\t\t}\n\t}\n});\n\n// file:src/parsing/stco.js\nBoxParser.createFullBoxCtor(\"stco\", function(stream) {\n\tvar entry_count;\n\tentry_count = stream.readUint32();\n\tthis.chunk_offsets = [];\n\tif (this.version === 0) {\n\t\tfor (var i = 0; i < entry_count; i++) {\n\t\t\tthis.chunk_offsets.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stdp.js\nBoxParser.createFullBoxCtor(\"stdp\", function(stream) {\n\tvar count = (this.size - this.hdr_size)/2;\n\tthis.priority = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.priority[i] = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/sthd.js\nBoxParser.createFullBoxCtor(\"sthd\");\n\n// file:src/parsing/stri.js\nBoxParser.createFullBoxCtor(\"stri\", function(stream) {\n\tthis.switch_group = stream.readUint16();\n\tthis.alternate_group = stream.readUint16();\n\tthis.sub_track_id = stream.readUint32();\n\tvar count = (this.size - this.hdr_size - 8)/4;\n\tthis.attribute_list = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.attribute_list[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/stsc.js\nBoxParser.createFullBoxCtor(\"stsc\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.first_chunk = [];\n\tthis.samples_per_chunk = [];\n\tthis.sample_description_index = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.first_chunk.push(stream.readUint32());\n\t\t\tthis.samples_per_chunk.push(stream.readUint32());\n\t\t\tthis.sample_description_index.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsd.js\nBoxParser.createFullBoxCtor(\"stsd\", function(stream) {\n\tvar i;\n\tvar ret;\n\tvar entryCount;\n\tvar box;\n\tthis.entries = [];\n\tentryCount = stream.readUint32();\n\tfor (i = 1; i <= entryCount; i++) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (BoxParser[ret.type+\"SampleEntry\"]) {\n\t\t\t\tbox = new BoxParser[ret.type+\"SampleEntry\"](ret.size);\n\t\t\t\tbox.hdr_size = ret.hdr_size;\n\t\t\t\tbox.start = ret.start;\n\t\t\t} else {\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown sample entry type: \"+ret.type);\n\t\t\t\tbox = new BoxParser.SampleEntry(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t}\n\t\t\tif (box.write === BoxParser.SampleEntry.prototype.write) {\n\t\t\t\tLog.info(\"BoxParser\", \"SampleEntry \"+box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.entries.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsg.js\nBoxParser.createFullBoxCtor(\"stsg\", function(stream) {\n\tthis.grouping_type = stream.readUint32();\n\tvar count = stream.readUint16();\n\tthis.group_description_index = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.group_description_index[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/stsh.js\nBoxParser.createFullBoxCtor(\"stsh\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.shadowed_sample_numbers = [];\n\tthis.sync_sample_numbers = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.shadowed_sample_numbers.push(stream.readUint32());\n\t\t\tthis.sync_sample_numbers.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stss.js\nBoxParser.createFullBoxCtor(\"stss\", function(stream) {\n\tvar i;\n\tvar entry_count;\n\tentry_count = stream.readUint32();\n\tif (this.version === 0) {\n\t\tthis.sample_numbers = [];\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_numbers.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsz.js\nBoxParser.createFullBoxCtor(\"stsz\", function(stream) {\n\tvar i;\n\tthis.sample_sizes = [];\n\tif (this.version === 0) {\n\t\tthis.sample_size = stream.readUint32();\n\t\tthis.sample_count = stream.readUint32();\n\t\tfor (i = 0; i < this.sample_count; i++) {\n\t\t\tif (this.sample_size === 0) {\n\t\t\t\tthis.sample_sizes.push(stream.readUint32());\n\t\t\t} else {\n\t\t\t\tthis.sample_sizes[i] = this.sample_size;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/stts.js\nBoxParser.createFullBoxCtor(\"stts\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tvar delta;\n\tentry_count = stream.readUint32();\n\tthis.sample_counts = [];\n\tthis.sample_deltas = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\tdelta = stream.readInt32();\n\t\t\tif (delta < 0) {\n\t\t\t\tLog.warn(\"BoxParser\", \"File uses negative stts sample delta, using value 1 instead, sync may be lost!\");\n\t\t\t\tdelta = 1;\n\t\t\t}\n\t\t\tthis.sample_deltas.push(delta);\n\t\t}\n\t}\n});\n\n// file:src/parsing/stvi.js\nBoxParser.createFullBoxCtor(\"stvi\", function(stream) {\n\tvar tmp32 = stream.readUint32();\n\tthis.single_view_allowed = tmp32 & 0x3;\n\tthis.stereo_scheme = stream.readUint32();\n\tvar length = stream.readUint32();\n\tthis.stereo_indication_type = stream.readString(length);\n\tvar ret;\n\tvar box;\n\tthis.boxes = [];\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.boxes.push(box);\n\t\t\tthis[box.type] = box;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/styp.js\nBoxParser.createBoxCtor(\"styp\", function(stream) {\n\tBoxParser.ftypBox.prototype.parse.call(this, stream);\n});\n\n// file:src/parsing/stz2.js\nBoxParser.createFullBoxCtor(\"stz2\", function(stream) {\n\tvar i;\n\tvar sample_size;\n\tvar sample_count;\n\tthis.sample_sizes = [];\n\tif (this.version === 0) {\n\t\tthis.reserved = stream.readUint24();\n\t\tthis.field_size = stream.readUint8();\n\t\tsample_count = stream.readUint32();\n\t\tif (this.field_size === 4) {\n\t\t\tfor (i = 0; i < sample_count; i+=2) {\n\t\t\t\tvar tmp = stream.readUint8();\n\t\t\t\tthis.sample_sizes[i] = (tmp >> 4) & 0xF;\n\t\t\t\tthis.sample_sizes[i+1] = tmp & 0xF;\n\t\t\t}\n\t\t} else if (this.field_size === 8) {\n\t\t\tfor (i = 0; i < sample_count; i++) {\n\t\t\t\tthis.sample_sizes[i] = stream.readUint8();\n\t\t\t}\n\t\t} else if (this.field_size === 16) {\n\t\t\tfor (i = 0; i < sample_count; i++) {\n\t\t\t\tthis.sample_sizes[i] = stream.readUint16();\n\t\t\t}\n\t\t} else {\n\t\t\tLog.error(\"BoxParser\", \"Error in length field in stz2 box\");\n\t\t}\n\t}\n});\n\n// file:src/parsing/subs.js\nBoxParser.createFullBoxCtor(\"subs\", function(stream) {\n\tvar i,j;\n\tvar entry_count;\n\tvar subsample_count;\n\tentry_count = stream.readUint32();\n\tthis.entries = [];\n\tfor (i = 0; i < entry_count; i++) {\n\t\tvar sampleInfo = {};\n\t\tthis.entries[i] = sampleInfo;\n\t\tsampleInfo.sample_delta = stream.readUint32();\n\t\tsampleInfo.subsamples = [];\n\t\tsubsample_count = stream.readUint16();\n\t\tif (subsample_count>0) {\n\t\t\tfor (j = 0; j < subsample_count; j++) {\n\t\t\t\tvar subsample = {};\n\t\t\t\tsampleInfo.subsamples.push(subsample);\n\t\t\t\tif (this.version == 1) {\n\t\t\t\t\tsubsample.size = stream.readUint32();\n\t\t\t\t} else {\n\t\t\t\t\tsubsample.size = stream.readUint16();\n\t\t\t\t}\n\t\t\t\tsubsample.priority = stream.readUint8();\n\t\t\t\tsubsample.discardable = stream.readUint8();\n\t\t\t\tsubsample.codec_specific_parameters = stream.readUint32();\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/tenc.js\nBoxParser.createFullBoxCtor(\"tenc\", function(stream) {\n\tstream.readUint8(); // reserved\n\tif (this.version === 0) {\n\t\tstream.readUint8();\n\t} else {\n\t\tvar tmp = stream.readUint8();\n\t\tthis.default_crypt_byte_block = (tmp >> 4) & 0xF;\n\t\tthis.default_skip_byte_block = tmp & 0xF;\n\t}\n\tthis.default_isProtected = stream.readUint8();\n\tthis.default_Per_Sample_IV_Size = stream.readUint8();\n\tthis.default_KID = BoxParser.parseHex16(stream);\n\tif (this.default_isProtected === 1 && this.default_Per_Sample_IV_Size === 0) {\n\t\tthis.default_constant_IV_size = stream.readUint8();\n\t\tthis.default_constant_IV = stream.readUint8Array(this.default_constant_IV_size);\n\t}\n});// file:src/parsing/tfdt.js\nBoxParser.createFullBoxCtor(\"tfdt\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.baseMediaDecodeTime = stream.readUint64();\n\t} else {\n\t\tthis.baseMediaDecodeTime = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/tfhd.js\nBoxParser.createFullBoxCtor(\"tfhd\", function(stream) {\n\tvar readBytes = 0;\n\tthis.track_id = stream.readUint32();\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET)) {\n\t\tthis.base_data_offset = stream.readUint64();\n\t\treadBytes += 8;\n\t} else {\n\t\tthis.base_data_offset = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC)) {\n\t\tthis.default_sample_description_index = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_description_index = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR)) {\n\t\tthis.default_sample_duration = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_duration = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE)) {\n\t\tthis.default_sample_size = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_size = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS)) {\n\t\tthis.default_sample_flags = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_flags = 0;\n\t}\n});\n\n// file:src/parsing/tfra.js\nBoxParser.createFullBoxCtor(\"tfra\", function(stream) {\n\tthis.track_ID = stream.readUint32();\n\tstream.readUint24();\n\tvar tmp_byte = stream.readUint8();\n\tthis.length_size_of_traf_num = (tmp_byte >> 4) & 0x3;\n\tthis.length_size_of_trun_num = (tmp_byte >> 2) & 0x3;\n\tthis.length_size_of_sample_num = (tmp_byte) & 0x3;\n\tthis.entries = [];\n\tvar number_of_entries = stream.readUint32();\n\tfor (var i = 0; i < number_of_entries; i++) {\n\t\tif (this.version === 1) {\n\t\t\tthis.time = stream.readUint64();\n\t\t\tthis.moof_offset = stream.readUint64();\n\t\t} else {\n\t\t\tthis.time = stream.readUint32();\n\t\t\tthis.moof_offset = stream.readUint32();\n\t\t}\n\t\tthis.traf_number = stream[\"readUint\"+(8*(this.length_size_of_traf_num+1))]();\n\t\tthis.trun_number = stream[\"readUint\"+(8*(this.length_size_of_trun_num+1))]();\n\t\tthis.sample_number = stream[\"readUint\"+(8*(this.length_size_of_sample_num+1))]();\n\t}\n});\n\n// file:src/parsing/tkhd.js\nBoxParser.createFullBoxCtor(\"tkhd\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.track_id = stream.readUint32();\n\t\tstream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.track_id = stream.readUint32();\n\t\tstream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tstream.readUint32Array(2);\n\tthis.layer = stream.readInt16();\n\tthis.alternate_group = stream.readInt16();\n\tthis.volume = stream.readInt16()>>8;\n\tstream.readUint16();\n\tthis.matrix = stream.readInt32Array(9);\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});\n\n// file:src/parsing/tmax.js\nBoxParser.createBoxCtor(\"tmax\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/tmin.js\nBoxParser.createBoxCtor(\"tmin\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/totl.js\nBoxParser.createBoxCtor(\"totl\",function(stream) {\n\tthis.bytessent = stream.readUint32();\n});\n\n// file:src/parsing/tpay.js\nBoxParser.createBoxCtor(\"tpay\", function(stream) {\n\tthis.bytessent = stream.readUint32();\n});\n\n// file:src/parsing/tpyl.js\nBoxParser.createBoxCtor(\"tpyl\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/TrackGroup.js\nBoxParser.TrackGroupTypeBox.prototype.parse = function(stream) {\n\tthis.parseFullHeader(stream);\n\tthis.track_group_id = stream.readUint32();\n}\n\n// file:src/parsing/trackgroups/msrc.js\nBoxParser.createTrackGroupCtor(\"msrc\");// file:src/parsing/TrakReference.js\nBoxParser.TrackReferenceTypeBox = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.TrackReferenceTypeBox.prototype = new BoxParser.Box();\nBoxParser.TrackReferenceTypeBox.prototype.parse = function(stream) {\n\tthis.track_ids = stream.readUint32Array((this.size-this.hdr_size)/4);\n}\n\n// file:src/parsing/tref.js\nBoxParser.trefBox.prototype.parse = function(stream) {\n\tvar ret;\n\tvar box;\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = new BoxParser.TrackReferenceTypeBox(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\t\t\tLog.info(\"BoxParser\", \"TrackReference \"+box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.boxes.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// file:src/parsing/trep.js\nBoxParser.createFullBoxCtor(\"trep\", function(stream) {\n\tthis.track_ID = stream.readUint32();\n\tthis.boxes = [];\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.boxes.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/trex.js\nBoxParser.createFullBoxCtor(\"trex\", function(stream) {\n\tthis.track_id = stream.readUint32();\n\tthis.default_sample_description_index = stream.readUint32();\n\tthis.default_sample_duration = stream.readUint32();\n\tthis.default_sample_size = stream.readUint32();\n\tthis.default_sample_flags = stream.readUint32();\n});\n\n// file:src/parsing/trpy.js\nBoxParser.createBoxCtor(\"trpy\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/trun.js\nBoxParser.createFullBoxCtor(\"trun\", function(stream) {\n\tvar readBytes = 0;\n\tthis.sample_count = stream.readUint32();\n\treadBytes+= 4;\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) ) {\n\t\tthis.data_offset = stream.readInt32(); //signed\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.data_offset = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) ) {\n\t\tthis.first_sample_flags = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.first_sample_flags = 0;\n\t}\n\tthis.sample_duration = [];\n\tthis.sample_size = [];\n\tthis.sample_flags = [];\n\tthis.sample_composition_time_offset = [];\n\tif (this.size - this.hdr_size > readBytes) {\n\t\tfor (var i = 0; i < this.sample_count; i++) {\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\t\tthis.sample_duration[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\t\tthis.sample_size[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\t\tthis.sample_flags[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\t\tif (this.version === 0) {\n\t\t\t\t\tthis.sample_composition_time_offset[i] = stream.readUint32();\n\t\t\t\t} else {\n\t\t\t\t\tthis.sample_composition_time_offset[i] = stream.readInt32(); //signed\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/tsel.js\nBoxParser.createFullBoxCtor(\"tsel\", function(stream) {\n\tthis.switch_group = stream.readUint32();\n\tvar count = (this.size - this.hdr_size - 4)/4;\n\tthis.attribute_list = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.attribute_list[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/txtC.js\nBoxParser.createFullBoxCtor(\"txtC\", function(stream) {\n\tthis.config = stream.readCString();\n});\n\n// file:src/parsing/url.js\nBoxParser.createFullBoxCtor(\"url \", function(stream) {\n\tif (this.flags !== 0x000001) {\n\t\tthis.location = stream.readCString();\n\t}\n});\n\n// file:src/parsing/urn.js\nBoxParser.createFullBoxCtor(\"urn \", function(stream) {\n\tthis.name = stream.readCString();\n\tif (this.size - this.hdr_size - this.name.length - 1 > 0) {\n\t\tthis.location = stream.readCString();\n\t}\n});\n\n// file:src/parsing/uuid/piff/piffLsm.js\nBoxParser.createUUIDBox(\"a5d40b30e81411ddba2f0800200c9a66\", true, false, function(stream) {\n    this.LiveServerManifest = stream.readString(this.size - this.hdr_size)\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\"/g, \"&quot;\")\n        .replace(/'/g, \"&#039;\");\n});// file:src/parsing/uuid/piff/piffPssh.js\nBoxParser.createUUIDBox(\"d08a4f1810f34a82b6c832d8aba183d3\", true, false, function(stream) {\n\tthis.system_id = BoxParser.parseHex16(stream);\n\tvar datasize = stream.readUint32();\n\tif (datasize > 0) {\n\t\tthis.data = stream.readUint8Array(datasize);\n\t}\n});\n\n// file:src/parsing/uuid/piff/piffSenc.js\nBoxParser.createUUIDBox(\"a2394f525a9b4f14a2446c427c648df4\", true, false /*, function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.AlgorithmID = stream.readUint24();\n\t\tthis.IV_size = stream.readUint8();\n\t\tthis.KID = BoxParser.parseHex16(stream);\n\t}\n\tvar sample_count = stream.readUint32();\n\tthis.samples = [];\n\tfor (var i = 0; i < sample_count; i++) {\n\t\tvar sample = {};\n\t\tsample.InitializationVector = this.readUint8Array(this.IV_size*8);\n\t\tif (this.flags & 0x2) {\n\t\t\tsample.subsamples = [];\n\t\t\tsample.NumberOfEntries = stream.readUint16();\n\t\t\tfor (var j = 0; j < sample.NumberOfEntries; j++) {\n\t\t\t\tvar subsample = {};\n\t\t\t\tsubsample.BytesOfClearData = stream.readUint16();\n\t\t\t\tsubsample.BytesOfProtectedData = stream.readUint32();\n\t\t\t\tsample.subsamples.push(subsample);\n\t\t\t}\n\t\t}\n\t\tthis.samples.push(sample);\n\t}\n}*/);\n// file:src/parsing/uuid/piff/piffTenc.js\nBoxParser.createUUIDBox(\"8974dbce7be74c5184f97148f9882554\", true, false, function(stream) {\n\tthis.default_AlgorithmID = stream.readUint24();\n\tthis.default_IV_size = stream.readUint8();\n\tthis.default_KID = BoxParser.parseHex16(stream);\n});// file:src/parsing/uuid/piff/piffTfrf.js\nBoxParser.createUUIDBox(\"d4807ef2ca3946958e5426cb9e46a79f\", true, false, function(stream) {\n    this.fragment_count = stream.readUint8();\n    this.entries = [];\n\n    for (var i = 0; i < this.fragment_count; i++) {\n        var entry = {};\n        var absolute_time = 0;\n        var absolute_duration = 0;\n\n        if (this.version === 1) {\n            absolute_time = stream.readUint64();\n            absolute_duration = stream.readUint64();\n        } else {\n            absolute_time = stream.readUint32();\n            absolute_duration = stream.readUint32();\n        }\n\n        entry.absolute_time = absolute_time;\n        entry.absolute_duration = absolute_duration;\n\n        this.entries.push(entry);\n    }\n});// file:src/parsing/uuid/piff/piffTfxd.js\nBoxParser.createUUIDBox(\"6d1d9b0542d544e680e2141daff757b2\", true, false, function(stream) {\n    if (this.version === 1) {\n       this.absolute_time = stream.readUint64();\n       this.duration = stream.readUint64();\n    } else {\n       this.absolute_time = stream.readUint32();\n       this.duration = stream.readUint32();\n    }\n});// file:src/parsing/vmhd.js\nBoxParser.createFullBoxCtor(\"vmhd\", function(stream) {\n\tthis.graphicsmode = stream.readUint16();\n\tthis.opcolor = stream.readUint16Array(3);\n});\n\n// file:src/parsing/vpcC.js\nBoxParser.createFullBoxCtor(\"vpcC\", function (stream) {\n\tvar tmp;\n\tif (this.version === 1) {\n\t\tthis.profile = stream.readUint8();\n\t\tthis.level = stream.readUint8();\n\t\ttmp = stream.readUint8();\n\t\tthis.bitDepth = tmp >> 4;\n\t\tthis.chromaSubsampling = (tmp >> 1) & 0x7;\n\t\tthis.videoFullRangeFlag = tmp & 0x1;\n\t\tthis.colourPrimaries = stream.readUint8();\n\t\tthis.transferCharacteristics = stream.readUint8();\n\t\tthis.matrixCoefficients = stream.readUint8();\n\t\tthis.codecIntializationDataSize = stream.readUint16();\n\t\tthis.codecIntializationData = stream.readUint8Array(this.codecIntializationDataSize);\n\t} else {\n\t\tthis.profile = stream.readUint8();\n\t\tthis.level = stream.readUint8();\n\t\ttmp = stream.readUint8();\n\t\tthis.bitDepth = (tmp >> 4) & 0xF;\n\t\tthis.colorSpace = tmp & 0xF;\n\t\ttmp = stream.readUint8();\n\t\tthis.chromaSubsampling = (tmp >> 4) & 0xF;\n\t\tthis.transferFunction = (tmp >> 1) & 0x7;\n\t\tthis.videoFullRangeFlag = tmp & 0x1;\n\t\tthis.codecIntializationDataSize = stream.readUint16();\n\t\tthis.codecIntializationData = stream.readUint8Array(this.codecIntializationDataSize);\n\t}\n});// file:src/parsing/vttC.js\nBoxParser.createBoxCtor(\"vttC\", function(stream) {\n\tthis.text = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/box-codecs.js\nBoxParser.SampleEntry.prototype.isVideo = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isAudio = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isSubtitle = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isMetadata = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isHint = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.getCodec = function() {\n\treturn this.type.replace('.','');\n}\n\nBoxParser.SampleEntry.prototype.getWidth = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getHeight = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getChannelCount = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getSampleRate = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getSampleSize = function() {\n\treturn \"\";\n}\n\nBoxParser.VisualSampleEntry.prototype.isVideo = function() {\n\treturn true;\n}\n\nBoxParser.VisualSampleEntry.prototype.getWidth = function() {\n\treturn this.width;\n}\n\nBoxParser.VisualSampleEntry.prototype.getHeight = function() {\n\treturn this.height;\n}\n\nBoxParser.AudioSampleEntry.prototype.isAudio = function() {\n\treturn true;\n}\n\nBoxParser.AudioSampleEntry.prototype.getChannelCount = function() {\n\treturn this.channel_count;\n}\n\nBoxParser.AudioSampleEntry.prototype.getSampleRate = function() {\n\treturn this.samplerate;\n}\n\nBoxParser.AudioSampleEntry.prototype.getSampleSize = function() {\n\treturn this.samplesize;\n}\n\nBoxParser.SubtitleSampleEntry.prototype.isSubtitle = function() {\n\treturn true;\n}\n\nBoxParser.MetadataSampleEntry.prototype.isMetadata = function() {\n\treturn true;\n}\n\n\nBoxParser.decimalToHex = function(d, padding) {\n\tvar hex = Number(d).toString(16);\n\tpadding = typeof (padding) === \"undefined\" || padding === null ? padding = 2 : padding;\n\twhile (hex.length < padding) {\n\t\thex = \"0\" + hex;\n\t}\n\treturn hex;\n}\n\nBoxParser.avc1SampleEntry.prototype.getCodec =\nBoxParser.avc2SampleEntry.prototype.getCodec =\nBoxParser.avc3SampleEntry.prototype.getCodec =\nBoxParser.avc4SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.avcC) {\n\t\treturn baseCodec+\".\"+BoxParser.decimalToHex(this.avcC.AVCProfileIndication)+\n\t\t\t\t\t\t  \"\"+BoxParser.decimalToHex(this.avcC.profile_compatibility)+\n\t\t\t\t\t\t  \"\"+BoxParser.decimalToHex(this.avcC.AVCLevelIndication);\n\t} else {\n\t\treturn baseCodec;\n\t}\n}\n\nBoxParser.hev1SampleEntry.prototype.getCodec =\nBoxParser.hvc1SampleEntry.prototype.getCodec = function() {\n\tvar i;\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.hvcC) {\n\t\tbaseCodec += '.';\n\t\tswitch (this.hvcC.general_profile_space) {\n\t\t\tcase 0:\n\t\t\t\tbaseCodec += '';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tbaseCodec += 'A';\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbaseCodec += 'B';\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbaseCodec += 'C';\n\t\t\t\tbreak;\n\t\t}\n\t\tbaseCodec += this.hvcC.general_profile_idc;\n\t\tbaseCodec += '.';\n\t\tvar val = this.hvcC.general_profile_compatibility;\n\t\tvar reversed = 0;\n\t\tfor (i=0; i<32; i++) {\n\t\t\treversed |= val & 1;\n\t\t\tif (i==31) break;\n\t\t\treversed <<= 1;\n\t\t\tval >>=1;\n\t\t}\n\t\tbaseCodec += BoxParser.decimalToHex(reversed, 0);\n\t\tbaseCodec += '.';\n\t\tif (this.hvcC.general_tier_flag === 0) {\n\t\t\tbaseCodec += 'L';\n\t\t} else {\n\t\t\tbaseCodec += 'H';\n\t\t}\n\t\tbaseCodec += this.hvcC.general_level_idc;\n\t\tvar hasByte = false;\n\t\tvar constraint_string = \"\";\n\t\tfor (i = 5; i >= 0; i--) {\n\t\t\tif (this.hvcC.general_constraint_indicator[i] || hasByte) {\n\t\t\t\tconstraint_string = \".\"+BoxParser.decimalToHex(this.hvcC.general_constraint_indicator[i], 0)+constraint_string;\n\t\t\t\thasByte = true;\n\t\t\t}\n\t\t}\n\t\tbaseCodec += constraint_string;\n\t}\n\treturn baseCodec;\n}\n\nBoxParser.mp4aSampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.esds && this.esds.esd) {\n\t\tvar oti = this.esds.esd.getOTI();\n\t\tvar dsi = this.esds.esd.getAudioConfig();\n\t\treturn baseCodec+\".\"+BoxParser.decimalToHex(oti)+(dsi ? \".\"+dsi: \"\");\n\t} else {\n\t\treturn baseCodec;\n\t}\n}\n\nBoxParser.stxtSampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif(this.mime_format) {\n\t\treturn baseCodec + \".\" + this.mime_format;\n\t} else {\n\t\treturn baseCodec\n\t}\n}\n\nBoxParser.av01SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tvar bitdepth;\n\tif (this.av1C.seq_profile === 2 && this.av1C.high_bitdepth === 1) {\n\t\tbitdepth = (this.av1C.twelve_bit === 1) ? \"12\" : \"10\";\n\t} else if ( this.av1C.seq_profile <= 2 ) {\n\t\tbitdepth = (this.av1C.high_bitdepth === 1) ? \"10\" : \"08\";\n\t}\n\t// TODO need to parse the SH to find color config\n\treturn baseCodec+\".\"+this.av1C.seq_profile+\".\"+this.av1C.seq_level_idx_0+(this.av1C.seq_tier_0?\"H\":\"M\")+\".\"+bitdepth;//+\".\"+this.av1C.monochrome+\".\"+this.av1C.chroma_subsampling_x+\"\"+this.av1C.chroma_subsampling_y+\"\"+this.av1C.chroma_sample_position;\n}\n\n\n// file:src/box-write.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.Box.prototype.writeHeader = function(stream, msg) {\n\tthis.size += 8;\n\tif (this.size > MAX_SIZE) {\n\t\tthis.size += 8;\n\t}\n\tif (this.type === \"uuid\") {\n\t\tthis.size += 16;\n\t}\n\tLog.debug(\"BoxWriter\", \"Writing box \"+this.type+\" of size: \"+this.size+\" at position \"+stream.getPosition()+(msg || \"\"));\n\tif (this.size > MAX_SIZE) {\n\t\tstream.writeUint32(1);\n\t} else {\n\t\tthis.sizePosition = stream.getPosition();\n\t\tstream.writeUint32(this.size);\n\t}\n\tstream.writeString(this.type, null, 4);\n\tif (this.type === \"uuid\") {\n\t\tstream.writeUint8Array(this.uuid);\n\t}\n\tif (this.size > MAX_SIZE) {\n\t\tstream.writeUint64(this.size);\n\t} \n}\n\nBoxParser.FullBox.prototype.writeHeader = function(stream) {\n\tthis.size += 4;\n\tBoxParser.Box.prototype.writeHeader.call(this, stream, \" v=\"+this.version+\" f=\"+this.flags);\n\tstream.writeUint8(this.version);\n\tstream.writeUint24(this.flags);\n}\n\nBoxParser.Box.prototype.write = function(stream) {\n\tif (this.type === \"mdat\") {\n\t\t/* TODO: fix this */\n\t\tif (this.data) {\n\t\t\tthis.size = this.data.length;\n\t\t\tthis.writeHeader(stream);\n\t\t\tstream.writeUint8Array(this.data);\n\t\t}\n\t} else {\n\t\tthis.size = (this.data ? this.data.length : 0);\n\t\tthis.writeHeader(stream);\n\t\tif (this.data) {\n\t\t\tstream.writeUint8Array(this.data);\n\t\t}\n\t}\n}\n\nBoxParser.ContainerBox.prototype.write = function(stream) {\n\tthis.size = 0;\n\tthis.writeHeader(stream);\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tthis.boxes[i].write(stream);\n\t\t\tthis.size += this.boxes[i].size;\n\t\t}\n\t}\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\nBoxParser.TrackReferenceTypeBox.prototype.write = function(stream) {\n\tthis.size = this.track_ids.length*4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32Array(this.track_ids);\n}\n\n// file:src/writing/avcC.js\nBoxParser.avcCBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.size = 7;\n\tfor (i = 0; i < this.SPS.length; i++) {\n\t\tthis.size += 2+this.SPS[i].length;\n\t}\n\tfor (i = 0; i < this.PPS.length; i++) {\n\t\tthis.size += 2+this.PPS[i].length;\n\t}\n\tif (this.ext) {\n\t\tthis.size += this.ext.length;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint8(this.configurationVersion);\n\tstream.writeUint8(this.AVCProfileIndication);\n\tstream.writeUint8(this.profile_compatibility);\n\tstream.writeUint8(this.AVCLevelIndication);\n\tstream.writeUint8(this.lengthSizeMinusOne + (63<<2));\n\tstream.writeUint8(this.SPS.length + (7<<5));\n\tfor (i = 0; i < this.SPS.length; i++) {\n\t\tstream.writeUint16(this.SPS[i].length);\n\t\tstream.writeUint8Array(this.SPS[i].nalu);\n\t}\n\tstream.writeUint8(this.PPS.length);\n\tfor (i = 0; i < this.PPS.length; i++) {\n\t\tstream.writeUint16(this.PPS[i].length);\n\t\tstream.writeUint8Array(this.PPS[i].nalu);\n\t}\n\tif (this.ext) {\n\t\tstream.writeUint8Array(this.ext);\n\t}\n}\n\n// file:src/writing/co64.js\nBoxParser.co64Box.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.chunk_offsets.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.chunk_offsets.length);\n\tfor(i=0; i<this.chunk_offsets.length; i++) {\n\t\tstream.writeUint64(this.chunk_offsets[i]);\n\t}\n}\n\n// file:src/writing/cslg.js\nBoxParser.cslgBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4*5;\n\tthis.writeHeader(stream);\n\tstream.writeInt32(this.compositionToDTSShift);\n\tstream.writeInt32(this.leastDecodeToDisplayDelta);\n\tstream.writeInt32(this.greatestDecodeToDisplayDelta);\n\tstream.writeInt32(this.compositionStartTime);\n\tstream.writeInt32(this.compositionEndTime);\n}\n\n// file:src/writing/ctts.js\nBoxParser.cttsBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.sample_counts.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_counts.length);\n\tfor(i=0; i<this.sample_counts.length; i++) {\n\t\tstream.writeUint32(this.sample_counts[i]);\n\t\tif (this.version === 1) {\n\t\t\tstream.writeInt32(this.sample_offsets[i]); /* signed */\n\t\t} else {\t\t\t\n\t\t\tstream.writeUint32(this.sample_offsets[i]); /* unsigned */\n\t\t}\n\t}\n}\n\n// file:src/writing/dref.js\nBoxParser.drefBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4; //\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tthis.entries[i].write(stream);\n\t\tthis.size += this.entries[i].size;\n\t}\t\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\n// file:src/writing/elng.js\nBoxParser.elngBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = this.extended_language.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.extended_language);\n}\n\n// file:src/writing/elst.js\nBoxParser.elstBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4+12*this.entries.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tvar entry = this.entries[i];\n\t\tstream.writeUint32(entry.segment_duration);\n\t\tstream.writeInt32(entry.media_time);\n\t\tstream.writeInt16(entry.media_rate_integer);\n\t\tstream.writeInt16(entry.media_rate_fraction);\n\t}\n}\n\n// file:src/writing/emsg.js\nBoxParser.emsgBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.scheme_id_uri);\n\tstream.writeCString(this.value);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.presentation_time_delta);\n\tstream.writeUint32(this.event_duration);\n\tstream.writeUint32(this.id);\n\tstream.writeUint8Array(this.message_data);\n}\n\n// file:src/writing/ftyp.js\nBoxParser.ftypBox.prototype.write = function(stream) {\n\tthis.size = 8+4*this.compatible_brands.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.major_brand, null, 4);\n\tstream.writeUint32(this.minor_version);\n\tfor (var i = 0; i < this.compatible_brands.length; i++) {\n\t\tstream.writeString(this.compatible_brands[i], null, 4);\n\t}\n}\n\n// file:src/writing/hdlr.js\nBoxParser.hdlrBox.prototype.write = function(stream) {\n\tthis.size = 5*4+this.name.length+1;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(0);\n\tstream.writeString(this.handler, null, 4);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeCString(this.name);\n}\n\n// file:src/writing/kind.js\nBoxParser.kindBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = (this.schemeURI.length+1)+(this.value.length+1);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.schemeURI);\n\tstream.writeCString(this.value);\n}\n\n// file:src/writing/mdhd.js\nBoxParser.mdhdBox.prototype.write = function(stream) {\n\tthis.size = 4*4+2*2;\n\tthis.flags = 0;\n\tthis.version = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint16(this.language);\n\tstream.writeUint16(0);\n}\n\n// file:src/writing/mehd.js\nBoxParser.mehdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.fragment_duration);\n}\n\n// file:src/writing/mfhd.js\nBoxParser.mfhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sequence_number);\n}\n\n// file:src/writing/mvhd.js\nBoxParser.mvhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 23*4+2*2;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint32(this.rate);\n\tstream.writeUint16(this.volume<<8);\n\tstream.writeUint16(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32Array(this.matrix);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(this.next_track_id);\n}\n\n// file:src/writing/sampleentry.js\nBoxParser.SampleEntry.prototype.writeHeader = function(stream) {\n\tthis.size = 8;\n\tBoxParser.Box.prototype.writeHeader.call(this, stream);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint16(this.data_reference_index);\n}\n\nBoxParser.SampleEntry.prototype.writeFooter = function(stream) {\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tthis.boxes[i].write(stream);\n\t\tthis.size += this.boxes[i].size;\n\t}\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\t\n}\n\nBoxParser.SampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tstream.writeUint8Array(this.data);\n\tthis.size += this.data.length;\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\t\n}\n\nBoxParser.VisualSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += 2*7+6*4+32;\n\tstream.writeUint16(0); \n\tstream.writeUint16(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.width);\n\tstream.writeUint16(this.height);\n\tstream.writeUint32(this.horizresolution);\n\tstream.writeUint32(this.vertresolution);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.frame_count);\n\tstream.writeUint8(Math.min(31, this.compressorname.length));\n\tstream.writeString(this.compressorname, null, 31);\n\tstream.writeUint16(this.depth);\n\tstream.writeInt16(-1);\n\tthis.writeFooter(stream);\n}\n\nBoxParser.AudioSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += 2*4+3*4;\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.channel_count);\n\tstream.writeUint16(this.samplesize);\n\tstream.writeUint16(0);\n\tstream.writeUint16(0);\n\tstream.writeUint32(this.samplerate<<16);\n\tthis.writeFooter(stream);\n}\n\nBoxParser.stppSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += this.namespace.length+1+\n\t\t\t\t this.schema_location.length+1+\n\t\t\t\t this.auxiliary_mime_types.length+1;\n\tstream.writeCString(this.namespace);\n\tstream.writeCString(this.schema_location);\n\tstream.writeCString(this.auxiliary_mime_types);\n\tthis.writeFooter(stream);\n}\n\n// file:src/writing/samplegroups/samplegroup.js\nBoxParser.SampleGroupEntry.prototype.write = function(stream) {\n\tstream.writeUint8Array(this.data);\n}\n\n// file:src/writing/sbgp.js\nBoxParser.sbgpBox.prototype.write = function(stream) {\n\tthis.version = 1;\t\n\tthis.flags = 0;\n\tthis.size = 12+8*this.entries.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.grouping_type, null, 4);\n\tstream.writeUint32(this.grouping_type_parameter);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tvar entry = this.entries[i];\n\t\tstream.writeInt32(entry.sample_count);\n\t\tstream.writeInt32(entry.group_description_index);\n\t}\n}\n\n// file:src/writing/sgpd.js\nBoxParser.sgpdBox.prototype.write = function(stream) {\n\tvar i;\n\tvar entry;\n\t// leave version as read\n\t// this.version;\n\tthis.flags = 0;\n\tthis.size = 12;\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tentry = this.entries[i];\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tthis.size += 4;\n\t\t\t}\n\t\t\tthis.size += entry.data.length;\n\t\t}\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeString(this.grouping_type, null, 4);\n\tif (this.version === 1) {\n\t\tstream.writeUint32(this.default_length);\n\t}\n\tif (this.version >= 2) {\n\t\tstream.writeUint32(this.default_sample_description_index);\n\t}\n\tstream.writeUint32(this.entries.length);\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tentry = this.entries[i];\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tstream.writeUint32(entry.description_length);\n\t\t\t}\n\t\t}\n\t\tentry.write(stream);\n\t}\n}\n\n\n// file:src/writing/sidx.js\nBoxParser.sidxBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4*4+2+2+12*this.references.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.reference_ID);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.earliest_presentation_time);\n\tstream.writeUint32(this.first_offset);\n\tstream.writeUint16(0);\n\tstream.writeUint16(this.references.length);\n\tfor (var i = 0; i < this.references.length; i++) {\n\t\tvar ref = this.references[i];\n\t\tstream.writeUint32(ref.reference_type << 31 | ref.referenced_size);\n\t\tstream.writeUint32(ref.subsegment_duration);\n\t\tstream.writeUint32(ref.starts_with_SAP << 31 | ref.SAP_type << 28 | ref.SAP_delta_time);\n\t}\n}\n\n// file:src/writing/stco.js\nBoxParser.stcoBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+4*this.chunk_offsets.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.chunk_offsets.length);\n\tstream.writeUint32Array(this.chunk_offsets);\n}\n\n// file:src/writing/stsc.js\nBoxParser.stscBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+12*this.first_chunk.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.first_chunk.length);\n\tfor(i=0; i<this.first_chunk.length; i++) {\n\t\tstream.writeUint32(this.first_chunk[i]);\n\t\tstream.writeUint32(this.samples_per_chunk[i]);\n\t\tstream.writeUint32(this.sample_description_index[i]);\n\t}\n}\n\n// file:src/writing/stsd.js\nBoxParser.stsdBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tthis.size += 4;\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tthis.entries[i].write(stream);\n\t\tthis.size += this.entries[i].size;\n\t}\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\n// file:src/writing/stsh.js\nBoxParser.stshBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.shadowed_sample_numbers.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.shadowed_sample_numbers.length);\n\tfor(i=0; i<this.shadowed_sample_numbers.length; i++) {\n\t\tstream.writeUint32(this.shadowed_sample_numbers[i]);\n\t\tstream.writeUint32(this.sync_sample_numbers[i]);\n\t}\n}\n\n// file:src/writing/stss.js\nBoxParser.stssBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+4*this.sample_numbers.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_numbers.length);\n\tstream.writeUint32Array(this.sample_numbers);\n}\n\n// file:src/writing/stsz.js\nBoxParser.stszBox.prototype.write = function(stream) {\n\tvar i;\n\tvar constant = true;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tif (this.sample_sizes.length > 0) {\n\t\ti = 0;\n\t\twhile (i+1 < this.sample_sizes.length) {\n\t\t\tif (this.sample_sizes[i+1] !==  this.sample_sizes[0]) {\n\t\t\t\tconstant = false;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconstant = false;\n\t}\n\tthis.size = 8;\n\tif (!constant) {\n\t\tthis.size += 4*this.sample_sizes.length;\n\t}\n\tthis.writeHeader(stream);\n\tif (!constant) {\n\t\tstream.writeUint32(0);\n\t} else {\n\t\tstream.writeUint32(this.sample_sizes[0]);\n\t}\n\tstream.writeUint32(this.sample_sizes.length);\n\tif (!constant) {\n\t\tstream.writeUint32Array(this.sample_sizes);\n\t}\t\n}\n\n// file:src/writing/stts.js\nBoxParser.sttsBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.sample_counts.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_counts.length);\n\tfor(i=0; i<this.sample_counts.length; i++) {\n\t\tstream.writeUint32(this.sample_counts[i]);\n\t\tstream.writeUint32(this.sample_deltas[i]);\n\t}\n}\n\n// file:src/writing/tfdt.js\nBoxParser.tfdtBox.prototype.write = function(stream) {\n\tvar UINT32_MAX = Math.pow(2, 32) - 1;\n\t// use version 1 if baseMediaDecodeTime does not fit 32 bits\n\tthis.version = this.baseMediaDecodeTime > UINT32_MAX ? 1 : 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tif (this.version === 1) {\n\t\tthis.size += 4;\n\t}\n\tthis.writeHeader(stream);\n\tif (this.version === 1) {\n\t\tstream.writeUint64(this.baseMediaDecodeTime);\n\t} else {\n\t\tstream.writeUint32(this.baseMediaDecodeTime);\n\t}\n}\n\n// file:src/writing/tfhd.js\nBoxParser.tfhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.size = 4;\n\tif (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) {\n\t\tthis.size += 8;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\tthis.size += 4;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.track_id);\n\tif (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) {\n\t\tstream.writeUint64(this.base_data_offset);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\tstream.writeUint32(this.default_sample_description_index);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\tstream.writeUint32(this.default_sample_duration);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\tstream.writeUint32(this.default_sample_size);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\tstream.writeUint32(this.default_sample_flags);\n\t}\n}\n\n// file:src/writing/tkhd.js\nBoxParser.tkhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\t//this.flags = 0;\n\tthis.size = 4*18+2*4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.track_id);\n\tstream.writeUint32(0);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeInt16(this.layer);\n\tstream.writeInt16(this.alternate_group);\n\tstream.writeInt16(this.volume<<8);\n\tstream.writeUint16(0);\n\tstream.writeInt32Array(this.matrix);\n\tstream.writeUint32(this.width);\n\tstream.writeUint32(this.height);\n}\n\n// file:src/writing/trex.js\nBoxParser.trexBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4*5;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.track_id);\n\tstream.writeUint32(this.default_sample_description_index);\n\tstream.writeUint32(this.default_sample_duration);\n\tstream.writeUint32(this.default_sample_size);\n\tstream.writeUint32(this.default_sample_flags);\n}\n\n// file:src/writing/trun.js\nBoxParser.trunBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.size = 4;\n\tif (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\tthis.size += 4*this.sample_duration.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\tthis.size += 4*this.sample_size.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\tthis.size += 4*this.sample_flags.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\tthis.size += 4*this.sample_composition_time_offset.length;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_count);\n\tif (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) {\n\t\tthis.data_offset_position = stream.getPosition();\n\t\tstream.writeInt32(this.data_offset); //signed\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) {\n\t\tstream.writeUint32(this.first_sample_flags);\n\t}\n\tfor (var i = 0; i < this.sample_count; i++) {\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\tstream.writeUint32(this.sample_duration[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\tstream.writeUint32(this.sample_size[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\tstream.writeUint32(this.sample_flags[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\tif (this.version === 0) {\n\t\t\t\tstream.writeUint32(this.sample_composition_time_offset[i]);\n\t\t\t} else {\n\t\t\t\tstream.writeInt32(this.sample_composition_time_offset[i]); //signed\n\t\t\t}\n\t\t}\n\t}\t\t\n}\n\n// file:src/writing/url.js\nBoxParser[\"url Box\"].prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tif (this.location) {\n\t\tthis.flags = 0;\n\t\tthis.size = this.location.length+1;\n\t} else {\n\t\tthis.flags = 0x000001;\n\t\tthis.size = 0;\n\t}\n\tthis.writeHeader(stream);\n\tif (this.location) {\n\t\tstream.writeCString(this.location);\n\t}\n}\n\n// file:src/writing/urn.js\nBoxParser[\"urn Box\"].prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = this.name.length+1+(this.location ? this.location.length+1 : 0);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.name);\n\tif (this.location) {\n\t\tstream.writeCString(this.location);\n\t}\n}\n\n// file:src/writing/vmhd.js\nBoxParser.vmhdBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 1;\n\tthis.size = 8;\n\tthis.writeHeader(stream);\n\tstream.writeUint16(this.graphicsmode);\n\tstream.writeUint16Array(this.opcolor);\n}\n\n// file:src/box-unpack.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.cttsBox.prototype.unpack = function(samples) {\n\tvar i, j, k;\n\tk = 0;\n\tfor (i = 0; i < this.sample_counts.length; i++) {\n\t\tfor (j = 0; j < this.sample_counts[i]; j++) {\n\t\t\tsamples[k].pts = samples[k].dts + this.sample_offsets[i];\n\t\t\tk++;\n\t\t}\n\t}\n}\n\nBoxParser.sttsBox.prototype.unpack = function(samples) {\n\tvar i, j, k;\n\tk = 0;\n\tfor (i = 0; i < this.sample_counts.length; i++) {\n\t\tfor (j = 0; j < this.sample_counts[i]; j++) {\n\t\t\tif (k === 0) {\n\t\t\t\tsamples[k].dts = 0;\n\t\t\t} else {\n\t\t\t\tsamples[k].dts = samples[k-1].dts + this.sample_deltas[i];\n\t\t\t}\n\t\t\tk++;\n\t\t}\n\t}\n}\n\nBoxParser.stcoBox.prototype.unpack = function(samples) {\n\tvar i;\n\tfor (i = 0; i < this.chunk_offsets.length; i++) {\n\t\tsamples[i].offset = this.chunk_offsets[i];\n\t}\n}\n\nBoxParser.stscBox.prototype.unpack = function(samples) {\n\tvar i, j, k, l, m;\n\tl = 0;\n\tm = 0;\n\tfor (i = 0; i < this.first_chunk.length; i++) {\n\t\tfor (j = 0; j < (i+1 < this.first_chunk.length ? this.first_chunk[i+1] : Infinity); j++) {\n\t\t\tm++;\n\t\t\tfor (k = 0; k < this.samples_per_chunk[i]; k++) {\n\t\t\t\tif (samples[l]) {\n\t\t\t\t\tsamples[l].description_index = this.sample_description_index[i];\n\t\t\t\t\tsamples[l].chunk_index = m;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tl++;\n\t\t\t}\t\t\t\n\t\t}\n\t}\n}\n\nBoxParser.stszBox.prototype.unpack = function(samples) {\n\tvar i;\n\tfor (i = 0; i < this.sample_sizes.length; i++) {\n\t\tsamples[i].size = this.sample_sizes[i];\n\t}\n}\n// file:src/box-diff.js\n\nBoxParser.DIFF_BOXES_PROP_NAMES = [ \"boxes\", \"entries\", \"references\", \"subsamples\",\n\t\t\t\t\t \t \"items\", \"item_infos\", \"extents\", \"associations\",\n\t\t\t\t\t \t \"subsegments\", \"ranges\", \"seekLists\", \"seekPoints\",\n\t\t\t\t\t \t \"esd\", \"levels\"];\n\nBoxParser.DIFF_PRIMITIVE_ARRAY_PROP_NAMES = [ \"compatible_brands\", \"matrix\", \"opcolor\", \"sample_counts\", \"sample_counts\", \"sample_deltas\",\n\"first_chunk\", \"samples_per_chunk\", \"sample_sizes\", \"chunk_offsets\", \"sample_offsets\", \"sample_description_index\", \"sample_duration\" ];\n\nBoxParser.boxEqualFields = function(box_a, box_b) {\n\tif (box_a && !box_b) return false;\n\tvar prop;\n\tfor (prop in box_a) {\n\t\tif (BoxParser.DIFF_BOXES_PROP_NAMES.indexOf(prop) > -1) {\n\t\t\tcontinue;\n\t\t// } else if (excluded_fields && excluded_fields.indexOf(prop) > -1) {\n\t\t// \tcontinue;\n\t\t} else if (box_a[prop] instanceof BoxParser.Box || box_b[prop] instanceof BoxParser.Box) {\n\t\t\tcontinue;\n\t\t} else if (typeof box_a[prop] === \"undefined\" || typeof box_b[prop] === \"undefined\") {\n\t\t\tcontinue;\n\t\t} else if (typeof box_a[prop] === \"function\" || typeof box_b[prop] === \"function\") {\n\t\t\tcontinue;\n\t\t} else if (\n\t\t\t(box_a.subBoxNames && box_a.subBoxNames.indexOf(prop.slice(0,4)) > -1) ||\n\t\t\t(box_b.subBoxNames && box_b.subBoxNames.indexOf(prop.slice(0,4)) > -1))  {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tif (prop === \"data\" || prop === \"start\" || prop === \"size\" || prop === \"creation_time\" || prop === \"modification_time\") {\n\t\t\t\tcontinue;\n\t\t\t} else if (BoxParser.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(prop) > -1) {\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\tif (box_a[prop] !== box_b[prop]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nBoxParser.boxEqual = function(box_a, box_b) {\n\tif (!BoxParser.boxEqualFields(box_a, box_b)) {\n\t\treturn false;\n\t}\n\tfor (var j = 0; j < BoxParser.DIFF_BOXES_PROP_NAMES.length; j++) {\n\t\tvar name = BoxParser.DIFF_BOXES_PROP_NAMES[j];\n\t\tif (box_a[name] && box_b[name]) {\n\t\t\tif (!BoxParser.boxEqual(box_a[name], box_b[name])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}// file:src/text-mp4.js\n/* \n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar VTTin4Parser = function() {\t\n}\n\nVTTin4Parser.prototype.parseSample = function(data) {\n\tvar cues, cue;\n\tvar stream = new MP4BoxStream(data.buffer);\n\tcues = [];\n\twhile (!stream.isEos()) {\n\t\tcue = BoxParser.parseOneBox(stream, false);\n\t\tif (cue.code === BoxParser.OK && cue.box.type === \"vttc\") {\n\t\t\tcues.push(cue.box);\n\t\t}\t\t\n\t}\n\treturn cues;\n}\n\nVTTin4Parser.prototype.getText = function (startTime, endTime, data) {\n\tfunction pad(n, width, z) {\n\t  z = z || '0';\n\t  n = n + '';\n\t  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n\t}\n\tfunction secToTimestamp(insec) {\n\t\tvar h = Math.floor(insec/3600);\n\t\tvar m = Math.floor((insec - h*3600)/60);\n\t\tvar s = Math.floor(insec - h*3600 - m*60);\n\t\tvar ms = Math.floor((insec - h*3600 - m*60 - s)*1000);\n\t\treturn \"\"+pad(h, 2)+\":\"+pad(m,2)+\":\"+pad(s, 2)+\".\"+pad(ms, 3);\n\t}\n\tvar cues = this.parseSample(data);\n\tvar string = \"\";\n\tfor (var i = 0; i < cues.length; i++) {\n\t\tvar cueIn4 = cues[i];\n\t\tstring += secToTimestamp(startTime)+\" --> \"+secToTimestamp(endTime)+\"\\r\\n\";\n\t\tstring += cueIn4.payl.text;\n\t}\n\treturn string;\n}\n\nvar XMLSubtitlein4Parser = function() {\t\n}\n\nXMLSubtitlein4Parser.prototype.parseSample = function(sample) {\n\tvar res = {};\t\n\tvar i;\n\tres.resources = [];\n\tvar stream = new MP4BoxStream(sample.data.buffer);\n\tif (!sample.subsamples || sample.subsamples.length === 0) {\n\t\tres.documentString = stream.readString(sample.data.length);\n\t} else {\n\t\tres.documentString = stream.readString(sample.subsamples[0].size);\n\t\tif (sample.subsamples.length > 1) {\n\t\t\tfor (i = 1; i < sample.subsamples.length; i++) {\n\t\t\t\tres.resources[i] = stream.readUint8Array(sample.subsamples[i].size);\n\t\t\t}\n\t\t}\n\t}\n\tif (typeof (DOMParser) !== \"undefined\") {\n\t\tres.document = (new DOMParser()).parseFromString(res.documentString, \"application/xml\");\n\t}\n\treturn res;\n}\n\nvar Textin4Parser = function() {\t\n}\n\nTextin4Parser.prototype.parseSample = function(sample) {\n\tvar textString;\n\tvar stream = new MP4BoxStream(sample.data.buffer);\n\ttextString = stream.readString(sample.data.length);\n\treturn textString;\n}\n\nTextin4Parser.prototype.parseConfig = function(data) {\n\tvar textString;\n\tvar stream = new MP4BoxStream(data.buffer);\n\tstream.readUint32(); // version & flags\n\ttextString = stream.readCString();\n\treturn textString;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.XMLSubtitlein4Parser = XMLSubtitlein4Parser;\n\texports.Textin4Parser = Textin4Parser;\n}\n// file:src/isofile.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar ISOFile = function (stream) {\n\t/* MutiBufferStream object used to parse boxes */\n\tthis.stream = stream || new MultiBufferStream();\n\t/* Array of all boxes (in order) found in the file */\n\tthis.boxes = [];\n\t/* Array of all mdats */\n\tthis.mdats = [];\n\t/* Array of all moofs */\n\tthis.moofs = [];\n\t/* Boolean indicating if the file is compatible with progressive parsing (moov first) */\n\tthis.isProgressive = false;\n\t/* Boolean used to fire moov start event only once */\n\tthis.moovStartFound = false;\n\t/* Callback called when the moov parsing starts */\n\tthis.onMoovStart = null;\n\t/* Boolean keeping track of the call to onMoovStart, to avoid double calls */\n\tthis.moovStartSent = false;\n\t/* Callback called when the moov is entirely parsed */\n\tthis.onReady = null;\n\t/* Boolean keeping track of the call to onReady, to avoid double calls */\n\tthis.readySent = false;\n\t/* Callback to call when segments are ready */\n\tthis.onSegment = null;\n\t/* Callback to call when samples are ready */\n\tthis.onSamples = null;\n\t/* Callback to call when there is an error in the parsing or processing of samples */\n\tthis.onError = null;\n\t/* Boolean indicating if the moov box run-length encoded tables of sample information have been processed */\n\tthis.sampleListBuilt = false;\n\t/* Array of Track objects for which fragmentation of samples is requested */\n\tthis.fragmentedTracks = [];\n\t/* Array of Track objects for which extraction of samples is requested */\n\tthis.extractedTracks = [];\n\t/* Boolean indicating that fragmention is ready */\n\tthis.isFragmentationInitialized = false;\n\t/* Boolean indicating that fragmented has started */\n\tthis.sampleProcessingStarted = false;\n\t/* Number of the next 'moof' to generate when fragmenting */\n\tthis.nextMoofNumber = 0;\n\t/* Boolean indicating if the initial list of items has been produced */\n\tthis.itemListBuilt = false;\n\t/* Callback called when the sidx box is entirely parsed */\n\tthis.onSidx = null;\n\t/* Boolean keeping track of the call to onSidx, to avoid double calls */\n\tthis.sidxSent = false;\n}\n\nISOFile.prototype.setSegmentOptions = function(id, user, options) {\n\tvar trak = this.getTrackById(id);\n\tif (trak) {\n\t\tvar fragTrack = {};\n\t\tthis.fragmentedTracks.push(fragTrack);\n\t\tfragTrack.id = id;\n\t\tfragTrack.user = user;\n\t\tfragTrack.trak = trak;\n\t\ttrak.nextSample = 0;\n\t\tfragTrack.segmentStream = null;\n\t\tfragTrack.nb_samples = 1000;\n\t\tfragTrack.rapAlignement = true;\n\t\tif (options) {\n\t\t\tif (options.nbSamples) fragTrack.nb_samples = options.nbSamples;\n\t\t\tif (options.rapAlignement) fragTrack.rapAlignement = options.rapAlignement;\n\t\t}\n\t}\n}\n\nISOFile.prototype.unsetSegmentOptions = function(id) {\n\tvar index = -1;\n\tfor (var i = 0; i < this.fragmentedTracks.length; i++) {\n\t\tvar fragTrack = this.fragmentedTracks[i];\n\t\tif (fragTrack.id == id) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\tif (index > -1) {\n\t\tthis.fragmentedTracks.splice(index, 1);\n\t}\n}\n\nISOFile.prototype.setExtractionOptions = function(id, user, options) {\n\tvar trak = this.getTrackById(id);\n\tif (trak) {\n\t\tvar extractTrack = {};\n\t\tthis.extractedTracks.push(extractTrack);\n\t\textractTrack.id = id;\n\t\textractTrack.user = user;\n\t\textractTrack.trak = trak;\n\t\ttrak.nextSample = 0;\n\t\textractTrack.nb_samples = 1000;\n\t\textractTrack.samples = [];\n\t\tif (options) {\n\t\t\tif (options.nbSamples) extractTrack.nb_samples = options.nbSamples;\n\t\t}\n\t}\n}\n\nISOFile.prototype.unsetExtractionOptions = function(id) {\n\tvar index = -1;\n\tfor (var i = 0; i < this.extractedTracks.length; i++) {\n\t\tvar extractTrack = this.extractedTracks[i];\n\t\tif (extractTrack.id == id) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\tif (index > -1) {\n\t\tthis.extractedTracks.splice(index, 1);\n\t}\n}\n\nISOFile.prototype.parse = function() {\n\tvar found;\n\tvar ret;\n\tvar box;\n\tvar parseBoxHeadersOnly = false;\n\n\tif (this.restoreParsePosition)\t{\n\t\tif (!this.restoreParsePosition()) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\twhile (true) {\n\n\t\tif (this.hasIncompleteMdat && this.hasIncompleteMdat()) {\n\t\t\tif (this.processIncompleteMdat()) {\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.saveParsePosition)\t{\n\t\t\t\tthis.saveParsePosition();\n\t\t\t}\n\t\t\tret = BoxParser.parseOneBox(this.stream, parseBoxHeadersOnly);\n\t\t\tif (ret.code === BoxParser.ERR_NOT_ENOUGH_DATA) {\n\t\t\t\tif (this.processIncompleteBox) {\n\t\t\t\t\tif (this.processIncompleteBox(ret)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar box_type;\n\t\t\t\t/* the box is entirely parsed */\n\t\t\t\tbox = ret.box;\n\t\t\t\tbox_type = (box.type !== \"uuid\" ? box.type : box.uuid);\n\t\t\t\t/* store the box in the 'boxes' array to preserve box order (for file rewrite if needed)  */\n\t\t\t\tthis.boxes.push(box);\n\t\t\t\t/* but also store box in a property for more direct access */\n\t\t\t\tswitch (box_type) {\n\t\t\t\t\tcase \"mdat\":\n\t\t\t\t\t\tthis.mdats.push(box);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"moof\":\n\t\t\t\t\t\tthis.moofs.push(box);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"moov\":\n\t\t\t\t\t\tthis.moovStartFound = true;\n\t\t\t\t\t\tif (this.mdats.length === 0) {\n\t\t\t\t\t\t\tthis.isProgressive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/* no break */\n\t\t\t\t\t\t/* falls through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (this[box_type] !== undefined) {\n\t\t\t\t\t\t\tLog.warn(\"ISOFile\", \"Duplicate Box of type: \"+box_type+\", overriding previous occurrence\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis[box_type] = box;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this.updateUsedBytes) {\n\t\t\t\t\tthis.updateUsedBytes(box, ret);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.prototype.checkBuffer = function (ab) {\n\tif (ab === null || ab === undefined) {\n\t\tthrow(\"Buffer must be defined and non empty\");\n\t}\n\tif (ab.fileStart === undefined) {\n\t\tthrow(\"Buffer must have a fileStart property\");\n\t}\n\tif (ab.byteLength === 0) {\n\t\tLog.warn(\"ISOFile\", \"Ignoring empty buffer (fileStart: \"+ab.fileStart+\")\");\n\t\tthis.stream.logBufferLevel();\n\t\treturn false;\n\t}\n\tLog.info(\"ISOFile\", \"Processing buffer (fileStart: \"+ab.fileStart+\")\");\n\n\t/* mark the bytes in the buffer as not being used yet */\n\tab.usedBytes = 0;\n\tthis.stream.insertBuffer(ab);\n\tthis.stream.logBufferLevel();\n\n\tif (!this.stream.initialized()) {\n\t\tLog.warn(\"ISOFile\", \"Not ready to start parsing\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n/* Processes a new ArrayBuffer (with a fileStart property)\n   Returns the next expected file position, or undefined if not ready to parse */\nISOFile.prototype.appendBuffer = function(ab, last) {\n\tvar nextFileStart;\n\tif (!this.checkBuffer(ab)) {\n\t\treturn;\n\t}\n\n\t/* Parse whatever is in the existing buffers */\n\tthis.parse();\n\n\t/* Check if the moovStart callback needs to be called */\n\tif (this.moovStartFound && !this.moovStartSent) {\n\t\tthis.moovStartSent = true;\n\t\tif (this.onMoovStart) this.onMoovStart();\n\t}\n\n\tif (this.moov) {\n\t\t/* A moov box has been entirely parsed */\n\n\t\t/* if this is the first call after the moov is found we initialize the list of samples (may be empty in fragmented files) */\n\t\tif (!this.sampleListBuilt) {\n\t\t\tthis.buildSampleLists();\n\t\t\tthis.sampleListBuilt = true;\n\t\t}\n\n\t\t/* We update the sample information if there are any new moof boxes */\n\t\tthis.updateSampleLists();\n\n\t\t/* If the application needs to be informed that the 'moov' has been found,\n\t\t   we create the information object and callback the application */\n\t\tif (this.onReady && !this.readySent) {\n\t\t\tthis.readySent = true;\n\t\t\tthis.onReady(this.getInfo());\n\t\t}\n\n\t\t/* See if any sample extraction or segment creation needs to be done with the available samples */\n\t\tthis.processSamples(last);\n\n\t\t/* Inform about the best range to fetch next */\n\t\tif (this.nextSeekPosition) {\n\t\t\tnextFileStart = this.nextSeekPosition;\n\t\t\tthis.nextSeekPosition = undefined;\n\t\t} else {\n\t\t\tnextFileStart = this.nextParsePosition;\n\t\t}\n\t\tif (this.stream.getEndFilePositionAfter) {\n\t\t\tnextFileStart = this.stream.getEndFilePositionAfter(nextFileStart);\n\t\t}\n\t} else {\n\t\tif (this.nextParsePosition) {\n\t\t\t/* moov has not been parsed but the first buffer was received,\n\t\t\t   the next fetch should probably be the next box start */\n\t\t\tnextFileStart = this.nextParsePosition;\n\t\t} else {\n\t\t\t/* No valid buffer has been parsed yet, we cannot know what to parse next */\n\t\t\tnextFileStart = 0;\n\t\t}\n\t}\n\tif (this.sidx) {\n\t\tif (this.onSidx && !this.sidxSent) {\n\t\t\tthis.onSidx(this.sidx);\n\t\t\tthis.sidxSent = true;\n\t\t}\n\t}\n\tif (this.meta) {\n\t\tif (this.flattenItemInfo && !this.itemListBuilt) {\n\t\t\tthis.flattenItemInfo();\n\t\t\tthis.itemListBuilt = true;\n\t\t}\n\t\tif (this.processItems) {\n\t\t\tthis.processItems(this.onItem);\n\t\t}\n\t}\n\n\tif (this.stream.cleanBuffers) {\n\t\tLog.info(\"ISOFile\", \"Done processing buffer (fileStart: \"+ab.fileStart+\") - next buffer to fetch should have a fileStart position of \"+nextFileStart);\n\t\tthis.stream.logBufferLevel();\n\t\tthis.stream.cleanBuffers();\n\t\tthis.stream.logBufferLevel(true);\n\t\tLog.info(\"ISOFile\", \"Sample data size in memory: \"+this.getAllocatedSampleDataSize());\n\t}\n\treturn nextFileStart;\n}\n\nISOFile.prototype.getInfo = function() {\n\tvar i, j;\n\tvar movie = {};\n\tvar trak;\n\tvar track;\n\tvar sample_desc;\n\tvar _1904 = (new Date('1904-01-01T00:00:00Z').getTime());\n\n\tif (this.moov) {\n\t\tmovie.hasMoov = true;\n\t\tmovie.duration = this.moov.mvhd.duration;\n\t\tmovie.timescale = this.moov.mvhd.timescale;\n\t\tmovie.isFragmented = (this.moov.mvex != null);\n\t\tif (movie.isFragmented && this.moov.mvex.mehd) {\n\t\t\tmovie.fragment_duration = this.moov.mvex.mehd.fragment_duration;\n\t\t}\n\t\tmovie.isProgressive = this.isProgressive;\n\t\tmovie.hasIOD = (this.moov.iods != null);\n\t\tmovie.brands = [];\n\t\tmovie.brands.push(this.ftyp.major_brand);\n\t\tmovie.brands = movie.brands.concat(this.ftyp.compatible_brands);\n\t\tmovie.created = new Date(_1904+this.moov.mvhd.creation_time*1000);\n\t\tmovie.modified = new Date(_1904+this.moov.mvhd.modification_time*1000);\n\t\tmovie.tracks = [];\n\t\tmovie.audioTracks = [];\n\t\tmovie.videoTracks = [];\n\t\tmovie.subtitleTracks = [];\n\t\tmovie.metadataTracks = [];\n\t\tmovie.hintTracks = [];\n\t\tmovie.otherTracks = [];\n\t\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\t\ttrak = this.moov.traks[i];\n\t\t\tsample_desc = trak.mdia.minf.stbl.stsd.entries[0];\n\t\t\ttrack = {};\n\t\t\tmovie.tracks.push(track);\n\t\t\ttrack.id = trak.tkhd.track_id;\n\t\t\ttrack.name = trak.mdia.hdlr.name;\n\t\t\ttrack.references = [];\n\t\t\tif (trak.tref) {\n\t\t\t\tfor (j = 0; j < trak.tref.boxes.length; j++) {\n\t\t\t\t\tref = {};\n\t\t\t\t\ttrack.references.push(ref);\n\t\t\t\t\tref.type = trak.tref.boxes[j].type;\n\t\t\t\t\tref.track_ids = trak.tref.boxes[j].track_ids;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (trak.edts) {\n\t\t\t\ttrack.edits = trak.edts.elst.entries;\n\t\t\t}\n\t\t\ttrack.created = new Date(_1904+trak.tkhd.creation_time*1000);\n\t\t\ttrack.modified = new Date(_1904+trak.tkhd.modification_time*1000);\n\t\t\ttrack.movie_duration = trak.tkhd.duration;\n\t\t\ttrack.movie_timescale = movie.timescale;\n\t\t\ttrack.layer = trak.tkhd.layer;\n\t\t\ttrack.alternate_group = trak.tkhd.alternate_group;\n\t\t\ttrack.volume = trak.tkhd.volume;\n\t\t\ttrack.matrix = trak.tkhd.matrix;\n\t\t\ttrack.track_width = trak.tkhd.width/(1<<16);\n\t\t\ttrack.track_height = trak.tkhd.height/(1<<16);\n\t\t\ttrack.timescale = trak.mdia.mdhd.timescale;\n\t\t\ttrack.cts_shift = trak.mdia.minf.stbl.cslg;\n\t\t\ttrack.duration = trak.mdia.mdhd.duration;\n\t\t\ttrack.samples_duration = trak.samples_duration;\n\t\t\ttrack.codec = sample_desc.getCodec();\n\t\t\ttrack.kind = (trak.udta && trak.udta.kinds.length ? trak.udta.kinds[0] : { schemeURI: \"\", value: \"\"});\n\t\t\ttrack.language = (trak.mdia.elng ? trak.mdia.elng.extended_language : trak.mdia.mdhd.languageString);\n\t\t\ttrack.nb_samples = trak.samples.length;\n\t\t\ttrack.size = trak.samples_size;\n\t\t\ttrack.bitrate = (track.size*8*track.timescale)/track.samples_duration;\n\t\t\tif (sample_desc.isAudio()) {\n\t\t\t\ttrack.type = \"audio\";\n\t\t\t\tmovie.audioTracks.push(track);\n\t\t\t\ttrack.audio = {};\n\t\t\t\ttrack.audio.sample_rate = sample_desc.getSampleRate();\n\t\t\t\ttrack.audio.channel_count = sample_desc.getChannelCount();\n\t\t\t\ttrack.audio.sample_size = sample_desc.getSampleSize();\n\t\t\t} else if (sample_desc.isVideo()) {\n\t\t\t\ttrack.type = \"video\";\n\t\t\t\tmovie.videoTracks.push(track);\n\t\t\t\ttrack.video = {};\n\t\t\t\ttrack.video.width = sample_desc.getWidth();\n\t\t\t\ttrack.video.height = sample_desc.getHeight();\n\t\t\t} else if (sample_desc.isSubtitle()) {\n\t\t\t\ttrack.type = \"subtitles\";\n\t\t\t\tmovie.subtitleTracks.push(track);\n\t\t\t} else if (sample_desc.isHint()) {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.hintTracks.push(track);\n\t\t\t} else if (sample_desc.isMetadata()) {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.metadataTracks.push(track);\n\t\t\t} else {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.otherTracks.push(track);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tmovie.hasMoov = false;\n\t}\n\tmovie.mime = \"\";\n\tif (movie.hasMoov && movie.tracks) {\n\t\tif (movie.videoTracks && movie.videoTracks.length > 0) {\n\t\t\tmovie.mime += 'video/mp4; codecs=\\\"';\n\t\t} else if (movie.audioTracks && movie.audioTracks.length > 0) {\n\t\t\tmovie.mime += 'audio/mp4; codecs=\\\"';\n\t\t} else {\n\t\t\tmovie.mime += 'application/mp4; codecs=\\\"';\n\t\t}\n\t\tfor (i = 0; i < movie.tracks.length; i++) {\n\t\t\tif (i !== 0) movie.mime += ',';\n\t\t\tmovie.mime+= movie.tracks[i].codec;\n\t\t}\n\t\tmovie.mime += '\\\"; profiles=\\\"';\n\t\tmovie.mime += this.ftyp.compatible_brands.join();\n\t\tmovie.mime += '\\\"';\n\t}\n\treturn movie;\n}\n\nISOFile.prototype.processSamples = function(last) {\n\tvar i;\n\tvar trak;\n\tif (!this.sampleProcessingStarted) return;\n\n\t/* For each track marked for fragmentation,\n\t   check if the next sample is there (i.e. if the sample information is known (i.e. moof has arrived) and if it has been downloaded)\n\t   and create a fragment with it */\n\tif (this.isFragmentationInitialized && this.onSegment !== null) {\n\t\tfor (i = 0; i < this.fragmentedTracks.length; i++) {\n\t\t\tvar fragTrak = this.fragmentedTracks[i];\n\t\t\ttrak = fragTrak.trak;\n\t\t\twhile (trak.nextSample < trak.samples.length && this.sampleProcessingStarted) {\n\t\t\t\t/* The sample information is there (either because the file is not fragmented and this is not the last sample,\n\t\t\t\tor because the file is fragmented and the moof for that sample has been received */\n\t\t\t\tLog.debug(\"ISOFile\", \"Creating media fragment on track #\"+fragTrak.id +\" for sample \"+trak.nextSample);\n\t\t\t\tvar result = this.createFragment(fragTrak.id, trak.nextSample, fragTrak.segmentStream);\n\t\t\t\tif (result) {\n\t\t\t\t\tfragTrak.segmentStream = result;\n\t\t\t\t\ttrak.nextSample++;\n\t\t\t\t} else {\n\t\t\t\t\t/* The fragment could not be created because the media data is not there (not downloaded), wait for it */\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t/* A fragment is created by sample, but the segment is the accumulation in the buffer of these fragments.\n\t\t\t\t   It is flushed only as requested by the application (nb_samples) to avoid too many callbacks */\n\t\t\t\tif (trak.nextSample % fragTrak.nb_samples === 0 || (last || trak.nextSample >= trak.samples.length)) {\n\t\t\t\t\tLog.info(\"ISOFile\", \"Sending fragmented data on track #\"+fragTrak.id+\" for samples [\"+Math.max(0,trak.nextSample-fragTrak.nb_samples)+\",\"+(trak.nextSample-1)+\"]\");\n\t\t\t\t\tLog.info(\"ISOFile\", \"Sample data size in memory: \"+this.getAllocatedSampleDataSize());\n\t\t\t\t\tif (this.onSegment) {\n\t\t\t\t\t\tthis.onSegment(fragTrak.id, fragTrak.user, fragTrak.segmentStream.buffer, trak.nextSample, (last || trak.nextSample >= trak.samples.length));\n\t\t\t\t\t}\n\t\t\t\t\t/* force the creation of a new buffer */\n\t\t\t\t\tfragTrak.segmentStream = null;\n\t\t\t\t\tif (fragTrak !== this.fragmentedTracks[i]) {\n\t\t\t\t\t\t/* make sure we can stop fragmentation if needed */\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (this.onSamples !== null) {\n\t\t/* For each track marked for data export,\n\t\t   check if the next sample is there (i.e. has been downloaded) and send it */\n\t\tfor (i = 0; i < this.extractedTracks.length; i++) {\n\t\t\tvar extractTrak = this.extractedTracks[i];\n\t\t\ttrak = extractTrak.trak;\n\t\t\twhile (trak.nextSample < trak.samples.length && this.sampleProcessingStarted) {\n\t\t\t\tLog.debug(\"ISOFile\", \"Exporting on track #\"+extractTrak.id +\" sample #\"+trak.nextSample);\n\t\t\t\tvar sample = this.getSample(trak, trak.nextSample);\n\t\t\t\tif (sample) {\n\t\t\t\t\ttrak.nextSample++;\n\t\t\t\t\textractTrak.samples.push(sample);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (trak.nextSample % extractTrak.nb_samples === 0 || trak.nextSample >= trak.samples.length) {\n\t\t\t\t\tLog.debug(\"ISOFile\", \"Sending samples on track #\"+extractTrak.id+\" for sample \"+trak.nextSample);\n\t\t\t\t\tif (this.onSamples) {\n\t\t\t\t\t\tthis.onSamples(extractTrak.id, extractTrak.user, extractTrak.samples);\n\t\t\t\t\t}\n\t\t\t\t\textractTrak.samples = [];\n\t\t\t\t\tif (extractTrak !== this.extractedTracks[i]) {\n\t\t\t\t\t\t/* check if the extraction needs to be stopped */\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/* Find and return specific boxes using recursion and early return */\nISOFile.prototype.getBox = function(type) {\n  var result = this.getBoxes(type, true);\n  return (result.length ? result[0] : null);\n}\n\nISOFile.prototype.getBoxes = function(type, returnEarly) {\n  var result = [];\n  ISOFile._sweep.call(this, type, result, returnEarly);\n  return result;\n}\n\nISOFile._sweep = function(type, result, returnEarly) {\n  if (this.type && this.type == type) result.push(this);\n  for (var box in this.boxes) {\n    if (result.length && returnEarly) return;\n    ISOFile._sweep.call(this.boxes[box], type, result, returnEarly);\n  }\n}\n\nISOFile.prototype.getTrackSamplesInfo = function(track_id) {\n\tvar track = this.getTrackById(track_id);\n\tif (track) {\n\t\treturn track.samples;\n\t} else {\n\t\treturn;\n\t}\n}\n\nISOFile.prototype.getTrackSample = function(track_id, number) {\n\tvar track = this.getTrackById(track_id);\n\tvar sample = this.getSample(track, number);\n\treturn sample;\n}\n\n/* Called by the application to release the resources associated to samples already forwarded to the application */\nISOFile.prototype.releaseUsedSamples = function (id, sampleNum) {\n\tvar size = 0;\n\tvar trak = this.getTrackById(id);\n\tif (!trak.lastValidSample) trak.lastValidSample = 0;\n\tfor (var i = trak.lastValidSample; i < sampleNum; i++) {\n\t\tsize+=this.releaseSample(trak, i);\n\t}\n\tLog.info(\"ISOFile\", \"Track #\"+id+\" released samples up to \"+sampleNum+\" (released size: \"+size+\", remaining: \"+this.samplesDataSize+\")\");\n\ttrak.lastValidSample = sampleNum;\n}\n\nISOFile.prototype.start = function() {\n\tthis.sampleProcessingStarted = true;\n\tthis.processSamples(false);\n}\n\nISOFile.prototype.stop = function() {\n\tthis.sampleProcessingStarted = false;\n}\n\n/* Called by the application to flush the remaining samples (e.g. once the download is finished or when no more samples will be added) */\nISOFile.prototype.flush = function() {\n\tLog.info(\"ISOFile\", \"Flushing remaining samples\");\n\tthis.updateSampleLists();\n\tthis.processSamples(true);\n\tthis.stream.cleanBuffers();\n\tthis.stream.logBufferLevel(true);\n}\n\n/* Finds the byte offset for a given time on a given track\n   also returns the time of the previous rap */\nISOFile.prototype.seekTrack = function(time, useRap, trak) {\n\tvar j;\n\tvar sample;\n\tvar seek_offset = Infinity;\n\tvar rap_seek_sample_num = 0;\n\tvar seek_sample_num = 0;\n\tvar timescale;\n\n\tif (trak.samples.length === 0) {\n\t\tLog.info(\"ISOFile\", \"No sample in track, cannot seek! Using time \"+Log.getDurationString(0, 1) +\" and offset: \"+0);\n\t\treturn { offset: 0, time: 0 };\n\t}\n\n\tfor (j = 0; j < trak.samples.length; j++) {\n\t\tsample = trak.samples[j];\n\t\tif (j === 0) {\n\t\t\tseek_sample_num = 0;\n\t\t\ttimescale = sample.timescale;\n\t\t} else if (sample.cts > time * sample.timescale) {\n\t\t\tseek_sample_num = j-1;\n\t\t\tbreak;\n\t\t}\n\t\tif (useRap && sample.is_sync) {\n\t\t\trap_seek_sample_num = j;\n\t\t}\n\t}\n\tif (useRap) {\n\t\tseek_sample_num = rap_seek_sample_num;\n\t}\n\ttime = trak.samples[seek_sample_num].cts;\n\ttrak.nextSample = seek_sample_num;\n\twhile (trak.samples[seek_sample_num].alreadyRead === trak.samples[seek_sample_num].size) {\n\t\t// No remaining samples to look for, all are downloaded.\n\t\tif (!trak.samples[seek_sample_num + 1]) {\n\t\t\tbreak;\n\t\t}\n\t\tseek_sample_num++;\n\t}\n\tseek_offset = trak.samples[seek_sample_num].offset+trak.samples[seek_sample_num].alreadyRead;\n\tLog.info(\"ISOFile\", \"Seeking to \"+(useRap ? \"RAP\": \"\")+\" sample #\"+trak.nextSample+\" on track \"+trak.tkhd.track_id+\", time \"+Log.getDurationString(time, timescale) +\" and offset: \"+seek_offset);\n\treturn { offset: seek_offset, time: time/timescale };\n}\n\n/* Finds the byte offset in the file corresponding to the given time or to the time of the previous RAP */\nISOFile.prototype.seek = function(time, useRap) {\n\tvar moov = this.moov;\n\tvar trak;\n\tvar trak_seek_info;\n\tvar i;\n\tvar seek_info = { offset: Infinity, time: Infinity };\n\tif (!this.moov) {\n\t\tthrow \"Cannot seek: moov not received!\";\n\t} else {\n\t\tfor (i = 0; i<moov.traks.length; i++) {\n\t\t\ttrak = moov.traks[i];\n\t\t\ttrak_seek_info = this.seekTrack(time, useRap, trak);\n\t\t\tif (trak_seek_info.offset < seek_info.offset) {\n\t\t\t\tseek_info.offset = trak_seek_info.offset;\n\t\t\t}\n\t\t\tif (trak_seek_info.time < seek_info.time) {\n\t\t\t\tseek_info.time = trak_seek_info.time;\n\t\t\t}\n\t\t}\n\t\tLog.info(\"ISOFile\", \"Seeking at time \"+Log.getDurationString(seek_info.time, 1)+\" needs a buffer with a fileStart position of \"+seek_info.offset);\n\t\tif (seek_info.offset === Infinity) {\n\t\t\t/* No sample info, in all tracks, cannot seek */\n\t\t\tseek_info = { offset: this.nextParsePosition, time: 0 };\n\t\t} else {\n\t\t\t/* check if the seek position is already in some buffer and\n\t\t\t in that case return the end of that buffer (or of the last contiguous buffer) */\n\t\t\t/* TODO: Should wait until append operations are done */\n\t\t\tseek_info.offset = this.stream.getEndFilePositionAfter(seek_info.offset);\n\t\t}\n\t\tLog.info(\"ISOFile\", \"Adjusted seek position (after checking data already in buffer): \"+seek_info.offset);\n\t\treturn seek_info;\n\t}\n}\n\nISOFile.prototype.equal = function(b) {\n\tvar box_index = 0;\n\twhile (box_index < this.boxes.length && box_index < b.boxes.length) {\n\t\tvar a_box = this.boxes[box_index];\n\t\tvar b_box = b.boxes[box_index];\n\t\tif (!BoxParser.boxEqual(a_box, b_box)) {\n\t\t\treturn false;\n\t\t}\n\t\tbox_index++;\n\t}\n\treturn true;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.ISOFile = ISOFile;\n}\n// file:src/isofile-advanced-parsing.js\n/* position in the current buffer of the beginning of the last box parsed */\nISOFile.prototype.lastBoxStartPosition = 0;\n/* indicator if the parsing is stuck in the middle of an mdat box */\nISOFile.prototype.parsingMdat = null;\n/* next file position that the parser needs:\n    - 0 until the first buffer (i.e. fileStart ===0) has been received \n    - otherwise, the next box start until the moov box has been parsed\n    - otherwise, the position of the next sample to fetch\n */\nISOFile.prototype.nextParsePosition = 0;\n/* keep mdat data */\nISOFile.prototype.discardMdatData = false;\n\nISOFile.prototype.processIncompleteBox = function(ret) {\n\tvar box;\n\tvar merged;\n\tvar found;\n\t\n\t/* we did not have enough bytes in the current buffer to parse the entire box */\n\tif (ret.type === \"mdat\") { \n\t\t/* we had enough bytes to get its type and size and it's an 'mdat' */\n\t\t\n\t\t/* special handling for mdat boxes, since we don't actually need to parse it linearly \n\t\t   we create the box */\n\t\tbox = new BoxParser[ret.type+\"Box\"](ret.size);\t\n\t\tthis.parsingMdat = box;\n\t\tthis.boxes.push(box);\n\t\tthis.mdats.push(box);\t\t\t\n\t\tbox.start = ret.start;\n\t\tbox.hdr_size = ret.hdr_size;\n\t\tthis.stream.addUsedBytes(box.hdr_size);\n\n\t\t/* indicate that the parsing should start from the end of the box */\n\t\tthis.lastBoxStartPosition = box.start + box.size;\n \t\t/* let's see if we have the end of the box in the other buffers */\n\t\tfound = this.stream.seek(box.start + box.size, false, this.discardMdatData);\n\t\tif (found) {\n\t\t\t/* found the end of the box */\n\t\t\tthis.parsingMdat = null;\n\t\t\t/* let's see if we can parse more in this buffer */\n\t\t\treturn true;\n\t\t} else {\n\t\t\t/* 'mdat' end not found in the existing buffers */\n\t\t\t/* determine the next position in the file to start parsing from */\n\t\t\tif (!this.moovStartFound) {\n\t\t\t\t/* moov not find yet, \n\t\t\t\t   the file probably has 'mdat' at the beginning, and 'moov' at the end, \n\t\t\t\t   indicate that the downloader should not try to download those bytes now */\n\t\t\t\tthis.nextParsePosition = box.start + box.size;\n\t\t\t} else {\n\t\t\t\t/* we have the start of the moov box, \n\t\t\t\t   the next bytes should try to complete the current 'mdat' */\n\t\t\t\tthis.nextParsePosition = this.stream.findEndContiguousBuf();\n\t\t\t}\n\t\t\t/* not much we can do, wait for more buffers to arrive */\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\t/* box is incomplete, we may not even know its type */\n\t\tif (ret.type === \"moov\") { \n\t\t\t/* the incomplete box is a 'moov' box */\n\t\t\tthis.moovStartFound = true;\n\t\t\tif (this.mdats.length === 0) {\n\t\t\t\tthis.isProgressive = true;\n\t\t\t}\n\t\t}\n\t\t/* either it's not an mdat box (and we need to parse it, we cannot skip it)\n\t\t   (TODO: we could skip 'free' boxes ...)\n\t\t\t   or we did not have enough data to parse the type and size of the box, \n\t\t   we try to concatenate the current buffer with the next buffer to restart parsing */\n\t\tmerged = (this.stream.mergeNextBuffer ? this.stream.mergeNextBuffer() : false);\n\t\tif (merged) {\n\t\t\t/* The next buffer was contiguous, the merging succeeded,\n\t\t\t   we can now continue parsing, \n\t\t\t   the next best position to parse is at the end of this new buffer */\n\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\treturn true;\n\t\t} else {\n\t\t\t/* we cannot concatenate existing buffers because they are not contiguous or because there is no additional buffer */\n\t\t\t/* The next best position to parse is still at the end of this old buffer */\n\t\t\tif (!ret.type) {\n\t\t\t\t/* There were not enough bytes in the buffer to parse the box type and length,\n\t\t\t\t   the next fetch should retrieve those missing bytes, i.e. the next bytes after this buffer */\n\t\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\t} else {\n\t\t\t\t/* we had enough bytes to parse size and type of the incomplete box\n\t\t\t\t   if we haven't found yet the moov box, skip this one and try the next one \n\t\t\t\t   if we have found the moov box, let's continue linear parsing */\n\t\t\t\tif (this.moovStartFound) {\n\t\t\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\t\t} else {\n\t\t\t\t\tthis.nextParsePosition = this.stream.getPosition() + ret.size;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nISOFile.prototype.hasIncompleteMdat = function () {\n\treturn (this.parsingMdat !== null);\n}\n\nISOFile.prototype.processIncompleteMdat = function () {\n\tvar box;\n\tvar found;\n\t\n\t/* we are in the parsing of an incomplete mdat box */\n\tbox = this.parsingMdat;\n\n\tfound = this.stream.seek(box.start + box.size, false, this.discardMdatData);\n\tif (found) {\n\t\tLog.debug(\"ISOFile\", \"Found 'mdat' end in buffered data\");\n\t\t/* the end of the mdat has been found */ \n\t\tthis.parsingMdat = null;\n\t\t/* we can parse more in this buffer */\n\t\treturn true;\n\t} else {\n\t\t/* we don't have the end of this mdat yet, \n\t\t   indicate that the next byte to fetch is the end of the buffers we have so far, \n\t\t   return and wait for more buffer to come */\n\t\tthis.nextParsePosition = this.stream.findEndContiguousBuf();\n\t\treturn false;\n\t}\n}\n\nISOFile.prototype.restoreParsePosition = function() {\n\t/* Reposition at the start position of the previous box not entirely parsed */\n\treturn this.stream.seek(this.lastBoxStartPosition, true, this.discardMdatData);\n}\n\nISOFile.prototype.saveParsePosition = function() {\n\t/* remember the position of the box start in case we need to roll back (if the box is incomplete) */\n\tthis.lastBoxStartPosition = this.stream.getPosition();\t\n}\n\nISOFile.prototype.updateUsedBytes = function(box, ret) {\n\tif (this.stream.addUsedBytes) {\n\t\tif (box.type === \"mdat\") {\n\t\t\t/* for an mdat box, only its header is considered used, other bytes will be used when sample data is requested */\n\t\t\tthis.stream.addUsedBytes(box.hdr_size);\n\t\t\tif (this.discardMdatData) {\n\t\t\t\tthis.stream.addUsedBytes(box.size-box.hdr_size);\n\t\t\t}\n\t\t} else {\n\t\t\t/* for all other boxes, the entire box data is considered used */\n\t\t\tthis.stream.addUsedBytes(box.size);\n\t\t}\t\n\t}\n}\n// file:src/isofile-advanced-creation.js\nISOFile.prototype.add = BoxParser.Box.prototype.add;\nISOFile.prototype.addBox = BoxParser.Box.prototype.addBox;\n\nISOFile.prototype.init = function (_options) {\n\tvar options = _options || {}; \n\tvar ftyp = this.add(\"ftyp\").set(\"major_brand\", (options.brands && options.brands[0]) || \"iso4\")\n\t\t\t\t\t\t\t   .set(\"minor_version\", 0)\n\t\t\t\t\t\t\t   .set(\"compatible_brands\", options.brands || [\"iso4\"]);\n\tvar moov = this.add(\"moov\");\n\tmoov.add(\"mvhd\").set(\"timescale\", options.timescale || 600)\n\t\t\t\t\t.set(\"rate\", options.rate || 1<<16)\n\t\t\t\t\t.set(\"creation_time\", 0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"duration\", options.duration || 0)\n\t\t\t\t\t.set(\"volume\", (options.width) ? 0 : 0x0100)\n\t\t\t\t\t.set(\"matrix\", [ 1<<16, 0, 0, 0, 1<<16, 0, 0, 0, 0x40000000])\n\t\t\t\t\t.set(\"next_track_id\", 1);\n\tmoov.add(\"mvex\");\n\treturn this;\n}\n\nISOFile.prototype.addTrack = function (_options) {\n\tif (!this.moov) {\n\t\tthis.init(_options);\n\t}\n\n\tvar options = _options || {}; \n\toptions.width = options.width || 320;\n\toptions.height = options.height || 320;\n\toptions.id = options.id || this.moov.mvhd.next_track_id;\n\toptions.type = options.type || \"avc1\";\n\n\tvar trak = this.moov.add(\"trak\");\n\tthis.moov.mvhd.next_track_id = options.id+1;\n\ttrak.add(\"tkhd\").set(\"flags\",BoxParser.TKHD_FLAG_ENABLED | \n\t\t\t\t\t\t\t\t BoxParser.TKHD_FLAG_IN_MOVIE | \n\t\t\t\t\t\t\t\t BoxParser.TKHD_FLAG_IN_PREVIEW)\n\t\t\t\t\t.set(\"creation_time\",0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"track_id\", options.id)\n\t\t\t\t\t.set(\"duration\", options.duration || 0)\n\t\t\t\t\t.set(\"layer\", options.layer || 0)\n\t\t\t\t\t.set(\"alternate_group\", 0)\n\t\t\t\t\t.set(\"volume\", 1)\n\t\t\t\t\t.set(\"matrix\", [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ])\n\t\t\t\t\t.set(\"width\", options.width)\n\t\t\t\t\t.set(\"height\", options.height);\n\n\tvar mdia = trak.add(\"mdia\");\n\tmdia.add(\"mdhd\").set(\"creation_time\", 0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"timescale\", options.timescale || 1)\n\t\t\t\t\t.set(\"duration\", options.media_duration || 0)\n\t\t\t\t\t.set(\"language\", options.language || \"und\");\n\n\tmdia.add(\"hdlr\").set(\"handler\", options.hdlr || \"vide\")\n\t\t\t\t\t.set(\"name\", options.name || \"Track created with MP4Box.js\");\n\n\tmdia.add(\"elng\").set(\"extended_language\", options.language || \"fr-FR\");\n\n\tvar minf = mdia.add(\"minf\");\n\tif (BoxParser[options.type+\"SampleEntry\"] === undefined) return;\n\tvar sample_description_entry = new BoxParser[options.type+\"SampleEntry\"]();\n\tsample_description_entry.data_reference_index = 1;\n\tvar media_type = \"\";\n\tfor (var mediaType in BoxParser.sampleEntryCodes) {\n\t\tvar codes = BoxParser.sampleEntryCodes[mediaType];\n\t\tfor (var i = 0; i < codes.length; i++) {\n\t\t\tif (codes.indexOf(options.type) > -1) {\n\t\t\t\tmedia_type = mediaType;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tswitch(media_type) {\n\t\tcase \"Visual\":\n\t\t\tminf.add(\"vmhd\").set(\"graphicsmode\",0).set(\"opcolor\", [ 0, 0, 0 ]);\n\t\t\tsample_description_entry.set(\"width\", options.width)\n\t\t\t\t\t\t.set(\"height\", options.height)\n\t\t\t\t\t\t.set(\"horizresolution\", 0x48<<16)\n\t\t\t\t\t\t.set(\"vertresolution\", 0x48<<16)\n\t\t\t\t\t\t.set(\"frame_count\", 1)\n\t\t\t\t\t\t.set(\"compressorname\", options.type+\" Compressor\")\n\t\t\t\t\t\t.set(\"depth\", 0x18);\n\t\t\tif (options.avcDecoderConfigRecord) {\n\t\t\t\tvar avcC = new BoxParser.avcCBox();\n\t\t\t\tvar stream = new MP4BoxStream(options.avcDecoderConfigRecord);\n\t\t\t\tavcC.parse(stream);\n\t\t\t\tsample_description_entry.addBox(avcC);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"Audio\":\n\t\t\tminf.add(\"smhd\").set(\"balance\", options.balance || 0);\n\t\t\tsample_description_entry.set(\"channel_count\", options.channel_count || 2)\n\t\t\t\t\t\t.set(\"samplesize\", options.samplesize || 16)\n\t\t\t\t\t\t.set(\"samplerate\", options.samplerate || 1<<16);\n\t\t\tbreak;\n\t\tcase \"Hint\":\n\t\t\tminf.add(\"hmhd\"); // TODO: add properties\n\t\t\tbreak;\n\t\tcase \"Subtitle\":\n\t\t\tminf.add(\"sthd\");\n\t\t\tswitch (options.type) {\n\t\t\t\tcase \"stpp\":\n\t\t\t\t\tsample_description_entry.set(\"namespace\", options.namespace || \"nonamespace\")\n\t\t\t\t\t\t\t\t.set(\"schema_location\", options.schema_location || \"\")\n\t\t\t\t\t\t\t\t.set(\"auxiliary_mime_types\", options.auxiliary_mime_types || \"\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"Metadata\":\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t\tcase \"System\":\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t}\n\tif (options.description) {\n\t\tsample_description_entry.addBox(options.description);\n\t}\n\tif (options.description_boxes) {\n\t\toptions.description_boxes.forEach(function (b) {\n\t\t\tsample_description_entry.addBox(b);\n\t\t});\n\t}\n\tminf.add(\"dinf\").add(\"dref\").addEntry((new BoxParser[\"url Box\"]()).set(\"flags\", 0x1));\n\tvar stbl = minf.add(\"stbl\");\n\tstbl.add(\"stsd\").addEntry(sample_description_entry);\n\tstbl.add(\"stts\").set(\"sample_counts\", [])\n\t\t\t\t\t.set(\"sample_deltas\", []);\n\tstbl.add(\"stsc\").set(\"first_chunk\", [])\n\t\t\t\t\t.set(\"samples_per_chunk\", [])\n\t\t\t\t\t.set(\"sample_description_index\", []);\n\tstbl.add(\"stco\").set(\"chunk_offsets\", []);\n\tstbl.add(\"stsz\").set(\"sample_sizes\", []);\n\n\tthis.moov.mvex.add(\"trex\").set(\"track_id\", options.id)\n\t\t\t\t\t\t\t  .set(\"default_sample_description_index\", options.default_sample_description_index || 1)\n\t\t\t\t\t\t\t  .set(\"default_sample_duration\", options.default_sample_duration || 0)\n\t\t\t\t\t\t\t  .set(\"default_sample_size\", options.default_sample_size || 0)\n\t\t\t\t\t\t\t  .set(\"default_sample_flags\", options.default_sample_flags || 0);\n\tthis.buildTrakSampleLists(trak);\n\treturn options.id;\n}\n\nBoxParser.Box.prototype.computeSize = function(stream_) {\n\tvar stream = stream_ || new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n}\n\nISOFile.prototype.addSample = function (track_id, data, _options) {\n\tvar options = _options || {};\n\tvar sample = {};\n\tvar trak = this.getTrackById(track_id);\n\tif (trak === null) return;\n    sample.number = trak.samples.length;\n\tsample.track_id = trak.tkhd.track_id;\n\tsample.timescale = trak.mdia.mdhd.timescale;\n\tsample.description_index = (options.sample_description_index ? options.sample_description_index - 1: 0);\n\tsample.description = trak.mdia.minf.stbl.stsd.entries[sample.description_index];\n\tsample.data = data;\n\tsample.size = data.byteLength;\n\tsample.alreadyRead = sample.size;\n\tsample.duration = options.duration || 1;\n\tsample.cts = options.cts || 0;\n\tsample.dts = options.dts || 0;\n\tsample.is_sync = options.is_sync || false;\n\tsample.is_leading = options.is_leading || 0;\n\tsample.depends_on = options.depends_on || 0;\n\tsample.is_depended_on = options.is_depended_on || 0;\n\tsample.has_redundancy = options.has_redundancy || 0;\n\tsample.degradation_priority = options.degradation_priority || 0;\n\tsample.offset = 0;\n\tsample.subsamples = options.subsamples;\n\ttrak.samples.push(sample);\n\ttrak.samples_size += sample.size;\n\ttrak.samples_duration += sample.duration;\n\tif (!trak.first_dts) {\n\t\ttrak.first_dts = options.dts;\n\t}\n\n\tthis.processSamples();\n\t\n\tvar moof = this.createSingleSampleMoof(sample);\n\tthis.addBox(moof);\n\tmoof.computeSize();\n\t/* adjusting the data_offset now that the moof size is known*/\n\tmoof.trafs[0].truns[0].data_offset = moof.size+8; //8 is mdat header\n\tthis.add(\"mdat\").data = new Uint8Array(data);\n\treturn sample;\n}\n\nISOFile.prototype.createSingleSampleMoof = function(sample) {\n\tvar sample_flags = 0;\n\tif (sample.is_sync)\n\t\tsample_flags = (1 << 25);  // sample_depends_on_none (I picture)\n\telse\n\t\tsample_flags = (1 << 16);  // non-sync\n\n\tvar moof = new BoxParser.moofBox();\n\tmoof.add(\"mfhd\").set(\"sequence_number\", this.nextMoofNumber);\n\tthis.nextMoofNumber++;\n\tvar traf = moof.add(\"traf\");\n\tvar trak = this.getTrackById(sample.track_id);\n\ttraf.add(\"tfhd\").set(\"track_id\", sample.track_id)\n\t\t\t\t\t.set(\"flags\", BoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF);\n\ttraf.add(\"tfdt\").set(\"baseMediaDecodeTime\", (sample.dts - trak.first_dts));\n\ttraf.add(\"trun\").set(\"flags\", BoxParser.TRUN_FLAGS_DATA_OFFSET | BoxParser.TRUN_FLAGS_DURATION | \n\t\t\t\t \t\t\t\t  BoxParser.TRUN_FLAGS_SIZE | BoxParser.TRUN_FLAGS_FLAGS | \n\t\t\t\t \t\t\t\t  BoxParser.TRUN_FLAGS_CTS_OFFSET)\n\t\t\t\t\t.set(\"data_offset\",0)\n\t\t\t\t\t.set(\"first_sample_flags\",0)\n\t\t\t\t\t.set(\"sample_count\",1)\n\t\t\t\t\t.set(\"sample_duration\",[sample.duration])\n\t\t\t\t\t.set(\"sample_size\",[sample.size])\n\t\t\t\t\t.set(\"sample_flags\",[sample_flags])\n\t\t\t\t\t.set(\"sample_composition_time_offset\", [sample.cts - sample.dts]);\n\treturn moof;\n}\n\n// file:src/isofile-sample-processing.js\n/* Index of the last moof box received */\nISOFile.prototype.lastMoofIndex = 0;\n\n/* size of the buffers allocated for samples */\nISOFile.prototype.samplesDataSize = 0;\n\n/* Resets all sample tables */\nISOFile.prototype.resetTables = function () {\n\tvar i;\n\tvar trak, stco, stsc, stsz, stts, ctts, stss;\n\tthis.initial_duration = this.moov.mvhd.duration;\n\tthis.moov.mvhd.duration = 0;\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\ttrak = this.moov.traks[i];\n\t\ttrak.tkhd.duration = 0;\n\t\ttrak.mdia.mdhd.duration = 0;\n\t\tstco = trak.mdia.minf.stbl.stco || trak.mdia.minf.stbl.co64;\n\t\tstco.chunk_offsets = [];\n\t\tstsc = trak.mdia.minf.stbl.stsc;\n\t\tstsc.first_chunk = [];\n\t\tstsc.samples_per_chunk = [];\n\t\tstsc.sample_description_index = [];\n\t\tstsz = trak.mdia.minf.stbl.stsz || trak.mdia.minf.stbl.stz2;\n\t\tstsz.sample_sizes = [];\n\t\tstts = trak.mdia.minf.stbl.stts;\n\t\tstts.sample_counts = [];\n\t\tstts.sample_deltas = [];\n\t\tctts = trak.mdia.minf.stbl.ctts;\n\t\tif (ctts) {\n\t\t\tctts.sample_counts = [];\n\t\t\tctts.sample_offsets = [];\n\t\t}\n\t\tstss = trak.mdia.minf.stbl.stss;\n\t\tvar k = trak.mdia.minf.stbl.boxes.indexOf(stss);\n\t\tif (k != -1) trak.mdia.minf.stbl.boxes[k] = null;\n\t}\n}\n\nISOFile.initSampleGroups = function(trak, traf, sbgps, trak_sgpds, traf_sgpds) {\n\tvar l;\n\tvar k;\n\tvar sample_groups_info;\n\tvar sample_group_info;\n\tvar sample_group_key;\n\tfunction SampleGroupInfo(_type, _parameter, _sbgp) {\n\t\tthis.grouping_type = _type;\n\t\tthis.grouping_type_parameter = _parameter;\n\t\tthis.sbgp = _sbgp;\n\t\tthis.last_sample_in_run = -1;\n\t\tthis.entry_index = -1;\t\t\n\t}\n\tif (traf) {\n\t\ttraf.sample_groups_info = [];\n\t} \n\tif (!trak.sample_groups_info) {\n\t\ttrak.sample_groups_info = [];\n\t}\n\tfor (k = 0; k < sbgps.length; k++) {\n\t\tsample_group_key = sbgps[k].grouping_type +\"/\"+ sbgps[k].grouping_type_parameter;\n\t\tsample_group_info = new SampleGroupInfo(sbgps[k].grouping_type, sbgps[k].grouping_type_parameter, sbgps[k]);\n\t\tif (traf) {\n\t\t\ttraf.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t}\n\t\tif (!trak.sample_groups_info[sample_group_key]) {\n\t\t\ttrak.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t}\n\t\tfor (l=0; l <trak_sgpds.length; l++) {\n\t\t\tif (trak_sgpds[l].grouping_type === sbgps[k].grouping_type) {\n\t\t\t\tsample_group_info.description = trak_sgpds[l];\n\t\t\t\tsample_group_info.description.used = true;\n\t\t\t}\n\t\t}\n\t\tif (traf_sgpds) {\n\t\t\tfor (l=0; l <traf_sgpds.length; l++) {\n\t\t\t\tif (traf_sgpds[l].grouping_type === sbgps[k].grouping_type) {\n\t\t\t\t\tsample_group_info.fragment_description = traf_sgpds[l];\n\t\t\t\t\tsample_group_info.fragment_description.used = true;\n\t\t\t\t\tsample_group_info.is_fragment = true;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\tif (!traf) {\n\t\tfor (k = 0; k < trak_sgpds.length; k++) {\n\t\t\tif (!trak_sgpds[k].used && trak_sgpds[k].version >= 2) {\n\t\t\t\tsample_group_key = trak_sgpds[k].grouping_type +\"/0\";\n\t\t\t\tsample_group_info = new SampleGroupInfo(trak_sgpds[k].grouping_type, 0);\n\t\t\t\tif (!trak.sample_groups_info[sample_group_key]) {\n\t\t\t\t\ttrak.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (traf_sgpds) {\n\t\t\tfor (k = 0; k < traf_sgpds.length; k++) {\n\t\t\t\tif (!traf_sgpds[k].used && traf_sgpds[k].version >= 2) {\n\t\t\t\t\tsample_group_key = traf_sgpds[k].grouping_type +\"/0\";\n\t\t\t\t\tsample_group_info = new SampleGroupInfo(traf_sgpds[k].grouping_type, 0);\n\t\t\t\t\tsample_group_info.is_fragment = true;\n\t\t\t\t\tif (!traf.sample_groups_info[sample_group_key]) {\n\t\t\t\t\t\ttraf.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.setSampleGroupProperties = function(trak, sample, sample_number, sample_groups_info) {\n\tvar k;\n\tvar index;\n\tsample.sample_groups = [];\n\tfor (k in sample_groups_info) {\n\t\tsample.sample_groups[k] = {};\n\t\tsample.sample_groups[k].grouping_type = sample_groups_info[k].grouping_type;\n\t\tsample.sample_groups[k].grouping_type_parameter = sample_groups_info[k].grouping_type_parameter;\n\t\tif (sample_number >= sample_groups_info[k].last_sample_in_run) {\n\t\t\tif (sample_groups_info[k].last_sample_in_run < 0) {\n\t\t\t\tsample_groups_info[k].last_sample_in_run = 0;\n\t\t\t}\n\t\t\tsample_groups_info[k].entry_index++;\t\n\t\t\tif (sample_groups_info[k].entry_index <= sample_groups_info[k].sbgp.entries.length - 1) {\n\t\t\t\tsample_groups_info[k].last_sample_in_run += sample_groups_info[k].sbgp.entries[sample_groups_info[k].entry_index].sample_count;\n\t\t\t}\n\t\t}\n\t\tif (sample_groups_info[k].entry_index <= sample_groups_info[k].sbgp.entries.length - 1) {\n\t\t\tsample.sample_groups[k].group_description_index = sample_groups_info[k].sbgp.entries[sample_groups_info[k].entry_index].group_description_index;\n\t\t} else {\n\t\t\tsample.sample_groups[k].group_description_index = -1; // special value for not defined\n\t\t}\n\t\tif (sample.sample_groups[k].group_description_index !== 0) {\n\t\t\tvar description;\n\t\t\tif (sample_groups_info[k].fragment_description) {\n\t\t\t\tdescription = sample_groups_info[k].fragment_description;\n\t\t\t} else {\n\t\t\t\tdescription = sample_groups_info[k].description;\n\t\t\t}\n\t\t\tif (sample.sample_groups[k].group_description_index > 0) {\n\t\t\t\tif (sample.sample_groups[k].group_description_index > 65535) {\n\t\t\t\t\tindex = (sample.sample_groups[k].group_description_index >> 16)-1;\n\t\t\t\t} else {\n\t\t\t\t\tindex = sample.sample_groups[k].group_description_index-1;\n\t\t\t\t}\n\t\t\t\tif (description && index >= 0) {\n\t\t\t\t\tsample.sample_groups[k].description = description.entries[index];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (description && description.version >= 2) {\n\t\t\t\t\tif (description.default_group_description_index > 0) {\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tsample.sample_groups[k].description = description.entries[description.default_group_description_index-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.process_sdtp = function (sdtp, sample, number) {\n\tif (!sample) {\n\t\treturn;\n\t}\n\tif (sdtp) {\n\t\tsample.is_leading = sdtp.is_leading[number];\n\t\tsample.depends_on = sdtp.sample_depends_on[number];\n\t\tsample.is_depended_on = sdtp.sample_is_depended_on[number];\n\t\tsample.has_redundancy = sdtp.sample_has_redundancy[number];\n\t} else {\n\t\tsample.is_leading = 0;\n\t\tsample.depends_on = 0;\n\t\tsample.is_depended_on = 0\n\t\tsample.has_redundancy = 0;\n\t}\t\n}\n\n/* Build initial sample list from  sample tables */\nISOFile.prototype.buildSampleLists = function() {\t\n\tvar i;\n\tvar trak;\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\ttrak = this.moov.traks[i];\n\t\tthis.buildTrakSampleLists(trak);\n\t}\n}\n\nISOFile.prototype.buildTrakSampleLists = function(trak) {\t\n\tvar j, k;\n\tvar stco, stsc, stsz, stts, ctts, stss, stsd, subs, sbgps, sgpds, stdp;\n\tvar chunk_run_index, chunk_index, last_chunk_in_run, offset_in_chunk, last_sample_in_chunk;\n\tvar last_sample_in_stts_run, stts_run_index, last_sample_in_ctts_run, ctts_run_index, last_stss_index, last_subs_index, subs_entry_index, last_subs_sample_index;\n\n\ttrak.samples = [];\n\ttrak.samples_duration = 0;\n\ttrak.samples_size = 0;\n\tstco = trak.mdia.minf.stbl.stco || trak.mdia.minf.stbl.co64;\n\tstsc = trak.mdia.minf.stbl.stsc;\n\tstsz = trak.mdia.minf.stbl.stsz || trak.mdia.minf.stbl.stz2;\n\tstts = trak.mdia.minf.stbl.stts;\n\tctts = trak.mdia.minf.stbl.ctts;\n\tstss = trak.mdia.minf.stbl.stss;\n\tstsd = trak.mdia.minf.stbl.stsd;\n\tsubs = trak.mdia.minf.stbl.subs;\n\tstdp = trak.mdia.minf.stbl.stdp;\n\tsbgps = trak.mdia.minf.stbl.sbgps;\n\tsgpds = trak.mdia.minf.stbl.sgpds;\n\t\n\tlast_sample_in_stts_run = -1;\n\tstts_run_index = -1;\n\tlast_sample_in_ctts_run = -1;\n\tctts_run_index = -1;\n\tlast_stss_index = 0;\n\tsubs_entry_index = 0;\n\tlast_subs_sample_index = 0;\t\t\n\n\tISOFile.initSampleGroups(trak, null, sbgps, sgpds);\n\n\tif (typeof stsz === \"undefined\") {\n\t\treturn;\n\t}\n\n\t/* we build the samples one by one and compute their properties */\n\tfor (j = 0; j < stsz.sample_sizes.length; j++) {\n\t\tvar sample = {};\n\t\tsample.number = j;\n\t\tsample.track_id = trak.tkhd.track_id;\n\t\tsample.timescale = trak.mdia.mdhd.timescale;\n\t\tsample.alreadyRead = 0;\n\t\ttrak.samples[j] = sample;\n\t\t/* size can be known directly */\n\t\tsample.size = stsz.sample_sizes[j];\n\t\ttrak.samples_size += sample.size;\n\t\t/* computing chunk-based properties (offset, sample description index)*/\n\t\tif (j === 0) {\t\t\t\t\n\t\t\tchunk_index = 1; /* the first sample is in the first chunk (chunk indexes are 1-based) */\n\t\t\tchunk_run_index = 0; /* the first chunk is the first entry in the first_chunk table */\n\t\t\tsample.chunk_index = chunk_index;\n\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\tlast_sample_in_chunk = stsc.samples_per_chunk[chunk_run_index];\n\t\t\toffset_in_chunk = 0;\n\n\t\t\t/* Is there another entry in the first_chunk table ? */\n\t\t\tif (chunk_run_index + 1 < stsc.first_chunk.length) {\n\t\t\t\t/* The last chunk in the run is the chunk before the next first chunk */\n\t\t\t\tlast_chunk_in_run = stsc.first_chunk[chunk_run_index+1]-1; \t\n\t\t\t} else {\n\t\t\t\t/* There is only one entry in the table, it is valid for all future chunks*/\n\t\t\t\tlast_chunk_in_run = Infinity;\n\t\t\t}\n\t\t} else {\n\t\t\tif (j < last_sample_in_chunk) {\n\t\t\t\t/* the sample is still in the current chunk */\n\t\t\t\tsample.chunk_index = chunk_index;\n\t\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\t} else {\n\t\t\t\t/* the sample is in the next chunk */\n\t\t\t\tchunk_index++;\n\t\t\t\tsample.chunk_index = chunk_index;\n\t\t\t\t/* reset the accumulated offset in the chunk */\n\t\t\t\toffset_in_chunk = 0;\n\t\t\t\tif (chunk_index <= last_chunk_in_run) {\n\t\t\t\t\t/* stay in the same entry of the first_chunk table */\n\t\t\t\t\t/* chunk_run_index unmodified */\n\t\t\t\t} else {\n\t\t\t\t\tchunk_run_index++;\n\t\t\t\t\t/* Is there another entry in the first_chunk table ? */\n\t\t\t\t\tif (chunk_run_index + 1 < stsc.first_chunk.length) {\n\t\t\t\t\t\t/* The last chunk in the run is the chunk before the next first chunk */\n\t\t\t\t\t\tlast_chunk_in_run = stsc.first_chunk[chunk_run_index+1]-1; \t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* There is only one entry in the table, it is valid for all future chunks*/\n\t\t\t\t\t\tlast_chunk_in_run = Infinity;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\t\tlast_sample_in_chunk += stsc.samples_per_chunk[chunk_run_index];\n\t\t\t}\n\t\t}\n\n\t\tsample.description_index = stsc.sample_description_index[sample.chunk_run_index]-1;\n\t\tsample.description = stsd.entries[sample.description_index];\n\t\tsample.offset = stco.chunk_offsets[sample.chunk_index-1] + offset_in_chunk; /* chunk indexes are 1-based */\n\t\toffset_in_chunk += sample.size;\n\n\t\t/* setting dts, cts, duration and rap flags */\n\t\tif (j > last_sample_in_stts_run) {\n\t\t\tstts_run_index++;\n\t\t\tif (last_sample_in_stts_run < 0) {\n\t\t\t\tlast_sample_in_stts_run = 0;\n\t\t\t}\n\t\t\tlast_sample_in_stts_run += stts.sample_counts[stts_run_index];\t\t\t\t\n\t\t}\n\t\tif (j > 0) {\n\t\t\ttrak.samples[j-1].duration = stts.sample_deltas[stts_run_index];\n\t\t\ttrak.samples_duration += trak.samples[j-1].duration;\n\t\t\tsample.dts = trak.samples[j-1].dts + trak.samples[j-1].duration;\n\t\t} else {\n\t\t\tsample.dts = 0;\n\t\t}\n\t\tif (ctts) {\n\t\t\tif (j >= last_sample_in_ctts_run) {\n\t\t\t\tctts_run_index++;\n\t\t\t\tif (last_sample_in_ctts_run < 0) {\n\t\t\t\t\tlast_sample_in_ctts_run = 0;\n\t\t\t\t}\n\t\t\t\tlast_sample_in_ctts_run += ctts.sample_counts[ctts_run_index];\t\t\t\t\n\t\t\t}\n\t\t\tsample.cts = trak.samples[j].dts + ctts.sample_offsets[ctts_run_index];\n\t\t} else {\n\t\t\tsample.cts = sample.dts;\n\t\t}\n\t\tif (stss) {\n\t\t\tif (j == stss.sample_numbers[last_stss_index] - 1) { // sample numbers are 1-based\n\t\t\t\tsample.is_sync = true;\n\t\t\t\tlast_stss_index++;\n\t\t\t} else {\n\t\t\t\tsample.is_sync = false;\t\t\t\t\n\t\t\t\tsample.degradation_priority = 0;\n\t\t\t}\n\t\t\tif (subs) {\n\t\t\t\tif (subs.entries[subs_entry_index].sample_delta + last_subs_sample_index == j+1) {\n\t\t\t\t\tsample.subsamples = subs.entries[subs_entry_index].subsamples;\n\t\t\t\t\tlast_subs_sample_index += subs.entries[subs_entry_index].sample_delta;\n\t\t\t\t\tsubs_entry_index++;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tsample.is_sync = true;\n\t\t}\n\t\tISOFile.process_sdtp(trak.mdia.minf.stbl.sdtp, sample, sample.number);\n\t\tif (stdp) {\n\t\t\tsample.degradation_priority = stdp.priority[j];\n\t\t} else {\n\t\t\tsample.degradation_priority = 0;\n\t\t}\n\t\tif (subs) {\n\t\t\tif (subs.entries[subs_entry_index].sample_delta + last_subs_sample_index == j) {\n\t\t\t\tsample.subsamples = subs.entries[subs_entry_index].subsamples;\n\t\t\t\tlast_subs_sample_index += subs.entries[subs_entry_index].sample_delta;\n\t\t\t}\n\t\t}\n\t\tif (sbgps.length > 0 || sgpds.length > 0) {\n\t\t\tISOFile.setSampleGroupProperties(trak, sample, j, trak.sample_groups_info);\n\t\t}\n\t}\n\tif (j>0) {\n\t\ttrak.samples[j-1].duration = Math.max(trak.mdia.mdhd.duration - trak.samples[j-1].dts, 0);\n\t\ttrak.samples_duration += trak.samples[j-1].duration;\n\t}\n}\n\n/* Update sample list when new 'moof' boxes are received */\nISOFile.prototype.updateSampleLists = function() {\t\n\tvar i, j, k;\n\tvar default_sample_description_index, default_sample_duration, default_sample_size, default_sample_flags;\n\tvar last_run_position;\n\tvar box, moof, traf, trak, trex;\n\tvar sample;\n\tvar sample_flags;\n\t\n\tif (this.moov === undefined) {\n\t\treturn;\n\t}\n\t/* if the input file is fragmented and fetched in multiple downloads, we need to update the list of samples */\n\twhile (this.lastMoofIndex < this.moofs.length) {\n\t\tbox = this.moofs[this.lastMoofIndex];\n\t\tthis.lastMoofIndex++;\n\t\tif (box.type == \"moof\") {\n\t\t\tmoof = box;\n\t\t\tfor (i = 0; i < moof.trafs.length; i++) {\n\t\t\t\ttraf = moof.trafs[i];\n\t\t\t\ttrak = this.getTrackById(traf.tfhd.track_id);\n\t\t\t\ttrex = this.getTrexById(traf.tfhd.track_id);\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\t\t\t\tdefault_sample_description_index = traf.tfhd.default_sample_description_index;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_description_index = (trex ? trex.default_sample_description_index: 1);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\t\t\t\tdefault_sample_duration = traf.tfhd.default_sample_duration;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_duration = (trex ? trex.default_sample_duration : 0);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\t\t\t\tdefault_sample_size = traf.tfhd.default_sample_size;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_size = (trex ? trex.default_sample_size : 0);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\t\t\t\tdefault_sample_flags = traf.tfhd.default_sample_flags;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_flags = (trex ? trex.default_sample_flags : 0);\n\t\t\t\t}\n\t\t\t\ttraf.sample_number = 0;\n\t\t\t\t/* process sample groups */\n\t\t\t\tif (traf.sbgps.length > 0) {\n\t\t\t\t\tISOFile.initSampleGroups(trak, traf, traf.sbgps, trak.mdia.minf.stbl.sgpds, traf.sgpds);\n\t\t\t\t}\n\t\t\t\tfor (j = 0; j < traf.truns.length; j++) {\n\t\t\t\t\tvar trun = traf.truns[j];\n\t\t\t\t\tfor (k = 0; k < trun.sample_count; k++) {\n\t\t\t\t\t\tsample = {};\n\t\t\t\t\t\tsample.moof_number = this.lastMoofIndex;\n\t\t\t\t\t\tsample.number_in_traf = traf.sample_number;\n\t\t\t\t\t\ttraf.sample_number++;\n\t\t\t            sample.number = trak.samples.length;\n\t\t\t\t\t\ttraf.first_sample_index = trak.samples.length;\n\t\t\t\t\t\ttrak.samples.push(sample);\n\t\t\t\t\t\tsample.track_id = trak.tkhd.track_id;\n\t\t\t\t\t\tsample.timescale = trak.mdia.mdhd.timescale;\n\t\t\t\t\t\tsample.description_index = default_sample_description_index-1;\n\t\t\t\t\t\tsample.description = trak.mdia.minf.stbl.stsd.entries[sample.description_index];\n\t\t\t\t\t\tsample.size = default_sample_size;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\t\t\t\t\tsample.size = trun.sample_size[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrak.samples_size += sample.size;\n\t\t\t\t\t\tsample.duration = default_sample_duration;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\t\t\t\t\tsample.duration = trun.sample_duration[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrak.samples_duration += sample.duration;\n\t\t\t\t\t\tif (trak.first_traf_merged || k > 0) {\n\t\t\t\t\t\t\tsample.dts = trak.samples[trak.samples.length-2].dts+trak.samples[trak.samples.length-2].duration;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (traf.tfdt) {\n\t\t\t\t\t\t\t\tsample.dts = traf.tfdt.baseMediaDecodeTime;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsample.dts = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttrak.first_traf_merged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample.cts = sample.dts;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\t\t\t\t\tsample.cts = sample.dts + trun.sample_composition_time_offset[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample_flags = default_sample_flags;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\t\t\t\t\tsample_flags = trun.sample_flags[k];\n\t\t\t\t\t\t} else if (k === 0 && (trun.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG)) {\n\t\t\t\t\t\t\tsample_flags = trun.first_sample_flags;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample.is_sync = ((sample_flags >> 16 & 0x1) ? false : true);\n\t\t\t\t\t\tsample.is_leading = (sample_flags >> 26 & 0x3);\n\t\t\t\t\t\tsample.depends_on = (sample_flags >> 24 & 0x3);\n\t\t\t\t\t\tsample.is_depended_on = (sample_flags >> 22 & 0x3);\n\t\t\t\t\t\tsample.has_redundancy = (sample_flags >> 20 & 0x3);\n\t\t\t\t\t\tsample.degradation_priority = (sample_flags & 0xFFFF);\n\t\t\t\t\t\t//ISOFile.process_sdtp(traf.sdtp, sample, sample.number_in_traf);\n\t\t\t\t\t\tvar bdop = (traf.tfhd.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) ? true : false;\n\t\t\t\t\t\tvar dbim = (traf.tfhd.flags & BoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF) ? true : false;\n\t\t\t\t\t\tvar dop = (trun.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) ? true : false;\n\t\t\t\t\t\tvar bdo = 0;\n\t\t\t\t\t\tif (!bdop) {\n\t\t\t\t\t\t\tif (!dbim) {\n\t\t\t\t\t\t\t\tif (j === 0) { // the first track in the movie fragment\n\t\t\t\t\t\t\t\t\tbdo = moof.start; // the position of the first byte of the enclosing Movie Fragment Box\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tbdo = last_run_position; // end of the data defined by the preceding *track* (irrespective of the track id) fragment in the moof\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbdo = moof.start;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbdo = traf.tfhd.base_data_offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j === 0 && k === 0) {\n\t\t\t\t\t\t\tif (dop) {\n\t\t\t\t\t\t\t\tsample.offset = bdo + trun.data_offset; // If the data-offset is present, it is relative to the base-data-offset established in the track fragment header\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsample.offset = bdo; // the data for this run starts the base-data-offset defined by the track fragment header\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsample.offset = last_run_position; // this run starts immediately after the data of the previous run\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlast_run_position = sample.offset + sample.size;\n\t\t\t\t\t\tif (traf.sbgps.length > 0 || traf.sgpds.length > 0 ||\n\t\t\t\t\t\t\ttrak.mdia.minf.stbl.sbgps.length > 0 || trak.mdia.minf.stbl.sgpds.length > 0) {\n\t\t\t\t\t\t\tISOFile.setSampleGroupProperties(trak, sample, sample.number_in_traf, traf.sample_groups_info);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (traf.subs) {\n\t\t\t\t\ttrak.has_fragment_subsamples = true;\n\t\t\t\t\tvar sample_index = traf.first_sample_index;\n\t\t\t\t\tfor (j = 0; j < traf.subs.entries.length; j++) {\n\t\t\t\t\t\tsample_index += traf.subs.entries[j].sample_delta;\n\t\t\t\t\t\tsample = trak.samples[sample_index-1];\n\t\t\t\t\t\tsample.subsamples = traf.subs.entries[j].subsamples;\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\n}\n\n/* Try to get sample data for a given sample:\n   returns null if not found\n   returns the same sample if already requested\n */\nISOFile.prototype.getSample = function(trak, sampleNum) {\t\n\tvar buffer;\n\tvar sample = trak.samples[sampleNum];\n\t\n\tif (!this.moov) {\n\t\treturn null;\n\t}\n\n\tif (!sample.data) {\n\t\t/* Not yet fetched */\n\t\tsample.data = new Uint8Array(sample.size);\n\t\tsample.alreadyRead = 0;\n\t\tthis.samplesDataSize += sample.size;\n\t\tLog.debug(\"ISOFile\", \"Allocating sample #\"+sampleNum+\" on track #\"+trak.tkhd.track_id+\" of size \"+sample.size+\" (total: \"+this.samplesDataSize+\")\");\n\t} else if (sample.alreadyRead == sample.size) {\n\t\t/* Already fetched entirely */\n\t\treturn sample;\n\t}\n\n\t/* The sample has only been partially fetched, we need to check in all buffers */\n\twhile(true) {\n\t\tvar index =\tthis.stream.findPosition(true, sample.offset + sample.alreadyRead, false);\n\t\tif (index > -1) {\n\t\t\tbuffer = this.stream.buffers[index];\n\t\t\tvar lengthAfterStart = buffer.byteLength - (sample.offset + sample.alreadyRead - buffer.fileStart);\n\t\t\tif (sample.size - sample.alreadyRead <= lengthAfterStart) {\n\t\t\t\t/* the (rest of the) sample is entirely contained in this buffer */\n\n\t\t\t\tLog.debug(\"ISOFile\",\"Getting sample #\"+sampleNum+\" data (alreadyRead: \"+sample.alreadyRead+\" offset: \"+\n\t\t\t\t\t(sample.offset+sample.alreadyRead - buffer.fileStart)+\" read size: \"+(sample.size - sample.alreadyRead)+\" full size: \"+sample.size+\")\");\n\n\t\t\t\tDataStream.memcpy(sample.data.buffer, sample.alreadyRead,\n\t\t\t\t                  buffer, sample.offset+sample.alreadyRead - buffer.fileStart, sample.size - sample.alreadyRead);\n\n\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\tbuffer.usedBytes += sample.size - sample.alreadyRead;\n\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\tsample.alreadyRead = sample.size;\n\n\t\t\t\treturn sample;\n\t\t\t} else {\n\t\t\t\t/* the sample does not end in this buffer */\n\n\t\t\t\tif (lengthAfterStart === 0) return null;\n\n\t\t\t\tLog.debug(\"ISOFile\",\"Getting sample #\"+sampleNum+\" partial data (alreadyRead: \"+sample.alreadyRead+\" offset: \"+\n\t\t\t\t\t(sample.offset+sample.alreadyRead - buffer.fileStart)+\" read size: \"+lengthAfterStart+\" full size: \"+sample.size+\")\");\n\n\t\t\t\tDataStream.memcpy(sample.data.buffer, sample.alreadyRead,\n\t\t\t\t                  buffer, sample.offset+sample.alreadyRead - buffer.fileStart, lengthAfterStart);\n\t\t\t\tsample.alreadyRead += lengthAfterStart;\n\n\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\tbuffer.usedBytes += lengthAfterStart;\n\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\t/* keep looking in the next buffer */\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\n/* Release the memory used to store the data of the sample */\nISOFile.prototype.releaseSample = function(trak, sampleNum) {\t\n\tvar sample = trak.samples[sampleNum];\n\tif (sample.data) {\n\t\tthis.samplesDataSize -= sample.size;\n\t\tsample.data = null;\n\t\tsample.alreadyRead = 0;\n\t\treturn sample.size;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\nISOFile.prototype.getAllocatedSampleDataSize = function() {\n\treturn this.samplesDataSize;\n}\n\n/* Builds the MIME Type 'codecs' sub-parameters for the whole file */\nISOFile.prototype.getCodecs = function() {\t\n\tvar i;\n\tvar codecs = \"\";\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\tvar trak = this.moov.traks[i];\n\t\tif (i>0) {\n\t\t\tcodecs+=\",\"; \n\t\t}\n\t\tcodecs += trak.mdia.minf.stbl.stsd.entries[0].getCodec();\t\t\n\t}\n\treturn codecs;\n}\n\n/* Helper function */\nISOFile.prototype.getTrexById = function(id) {\t\n\tvar i;\n\tif (!this.moov || !this.moov.mvex) return null;\n\tfor (i = 0; i < this.moov.mvex.trexs.length; i++) {\n\t\tvar trex = this.moov.mvex.trexs[i];\n\t\tif (trex.track_id == id) return trex;\n\t}\n\treturn null;\n}\n\n/* Helper function */\nISOFile.prototype.getTrackById = function(id) {\n\tif (this.moov === undefined) {\n\t\treturn null;\n\t}\n\tfor (var j = 0; j < this.moov.traks.length; j++) {\n\t\tvar trak = this.moov.traks[j];\n\t\tif (trak.tkhd.track_id == id) return trak;\n\t}\n\treturn null;\n}\n// file:src/isofile-item-processing.js\nISOFile.prototype.items = [];\n/* size of the buffers allocated for samples */\nISOFile.prototype.itemsDataSize = 0;\n\nISOFile.prototype.flattenItemInfo = function() {\t\n\tvar items = this.items;\n\tvar i, j;\n\tvar item;\n\tvar meta = this.meta;\n\tif (meta === null || meta === undefined) return;\n\tif (meta.hdlr === undefined) return;\n\tif (meta.iinf === undefined) return;\n\tfor (i = 0; i < meta.iinf.item_infos.length; i++) {\n\t\titem = {};\n\t\titem.id = meta.iinf.item_infos[i].item_ID;\n\t\titems[item.id] = item;\n\t\titem.ref_to = [];\n\t\titem.name = meta.iinf.item_infos[i].item_name;\n\t\tif (meta.iinf.item_infos[i].protection_index > 0) {\n\t\t\titem.protection = meta.ipro.protections[meta.iinf.item_infos[i].protection_index-1];\n\t\t}\n\t\tif (meta.iinf.item_infos[i].item_type) {\n\t\t\titem.type = meta.iinf.item_infos[i].item_type;\n\t\t} else {\n\t\t\titem.type = \"mime\";\n\t\t}\n\t\titem.content_type = meta.iinf.item_infos[i].content_type;\n\t\titem.content_encoding = meta.iinf.item_infos[i].content_encoding;\n\t}\n\tif (meta.iloc) {\n\t\tfor(i = 0; i < meta.iloc.items.length; i++) {\n\t\t\tvar offset;\n\t\t\tvar itemloc = meta.iloc.items[i];\n\t\t\titem = items[itemloc.item_ID];\n\t\t\tif (itemloc.data_reference_index !== 0) {\n\t\t\t\tLog.warn(\"Item storage with reference to other files: not supported\");\n\t\t\t\titem.source = meta.dinf.boxes[itemloc.data_reference_index-1];\n\t\t\t}\n\t\t\tswitch(itemloc.construction_method) {\n\t\t\t\tcase 0: // offset into the file referenced by the data reference index\n\t\t\t\tbreak;\n\t\t\t\tcase 1: // offset into the idat box of this meta box\n\t\t\t\tLog.warn(\"Item storage with construction_method : not supported\");\n\t\t\t\tbreak;\n\t\t\t\tcase 2: // offset into another item\n\t\t\t\tLog.warn(\"Item storage with construction_method : not supported\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\titem.extents = [];\n\t\t\titem.size = 0;\n\t\t\tfor (j = 0; j < itemloc.extents.length; j++) {\n\t\t\t\titem.extents[j] = {};\n\t\t\t\titem.extents[j].offset = itemloc.extents[j].extent_offset + itemloc.base_offset;\n\t\t\t\titem.extents[j].length = itemloc.extents[j].extent_length;\n\t\t\t\titem.extents[j].alreadyRead = 0;\n\t\t\t\titem.size += item.extents[j].length;\n\t\t\t}\n\t\t}\n\t}\n\tif (meta.pitm) {\n\t\titems[meta.pitm.item_id].primary = true;\n\t}\n\tif (meta.iref) {\n\t\tfor (i=0; i <meta.iref.references.length; i++) {\n\t\t\tvar ref = meta.iref.references[i];\n\t\t\tfor (j=0; j<ref.references.length; j++) {\n\t\t\t\titems[ref.from_item_ID].ref_to.push({type: ref.type, id: ref.references[j]});\n\t\t\t}\n\t\t}\n\t}\n\tif (meta.iprp) {\n\t\tfor (var k = 0; k < meta.iprp.ipmas.length; k++) {\n\t\t\tvar ipma = meta.iprp.ipmas[k];\n\t\t\tfor (i = 0; i < ipma.associations.length; i++) {\n\t\t\t\tvar association = ipma.associations[i];\n\t\t\t\titem = items[association.id];\n\t\t\t\tif (item.properties === undefined) {\n\t\t\t\t\titem.properties = {};\n\t\t\t\t\titem.properties.boxes = [];\n\t\t\t\t}\n\t\t\t\tfor (j = 0; j < association.props.length; j++) {\n\t\t\t\t\tvar propEntry = association.props[j];\n\t\t\t\t\tif (propEntry.property_index > 0 && propEntry.property_index-1 < meta.iprp.ipco.boxes.length) {\n\t\t\t\t\t\tvar propbox = meta.iprp.ipco.boxes[propEntry.property_index-1];\n\t\t\t\t\t\titem.properties[propbox.type] = propbox;\n\t\t\t\t\t\titem.properties.boxes.push(propbox);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.prototype.getItem = function(item_id) {\t\n\tvar buffer;\n\tvar item;\n\t\n\tif (!this.meta) {\n\t\treturn null;\n\t}\n\n \titem = this.items[item_id];\n\tif (!item.data && item.size) {\n\t\t/* Not yet fetched */\n\t\titem.data = new Uint8Array(item.size);\n\t\titem.alreadyRead = 0;\n\t\tthis.itemsDataSize += item.size;\n\t\tLog.debug(\"ISOFile\", \"Allocating item #\"+item_id+\" of size \"+item.size+\" (total: \"+this.itemsDataSize+\")\");\n\t} else if (item.alreadyRead === item.size) {\n\t\t/* Already fetched entirely */\n\t\treturn item;\n\t}\n\n\t/* The item has only been partially fetched, we need to check in all buffers to find the remaining extents*/\n\n\tfor (var i = 0; i < item.extents.length; i++) {\n\t\tvar extent = item.extents[i];\n\t\tif (extent.alreadyRead === extent.length) {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tvar index =\tthis.stream.findPosition(true, extent.offset + extent.alreadyRead, false);\n\t\t\tif (index > -1) {\n\t\t\t\tbuffer = this.stream.buffers[index];\n\t\t\t\tvar lengthAfterStart = buffer.byteLength - (extent.offset + extent.alreadyRead - buffer.fileStart);\n\t\t\t\tif (extent.length - extent.alreadyRead <= lengthAfterStart) {\n\t\t\t\t\t/* the (rest of the) extent is entirely contained in this buffer */\n\n\t\t\t\t\tLog.debug(\"ISOFile\",\"Getting item #\"+item_id+\" extent #\"+i+\" data (alreadyRead: \"+extent.alreadyRead+\n\t\t\t\t\t\t\" offset: \"+(extent.offset+extent.alreadyRead - buffer.fileStart)+\" read size: \"+(extent.length - extent.alreadyRead)+\n\t\t\t\t\t\t\" full extent size: \"+extent.length+\" full item size: \"+item.size+\")\");\n\n\t\t\t\t\tDataStream.memcpy(item.data.buffer, item.alreadyRead, \n\t\t\t\t\t                  buffer, extent.offset+extent.alreadyRead - buffer.fileStart, extent.length - extent.alreadyRead);\n\n\t\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\t\tbuffer.usedBytes += extent.length - extent.alreadyRead;\n\t\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\t\titem.alreadyRead += (extent.length - extent.alreadyRead);\n\t\t\t\t\textent.alreadyRead = extent.length;\n\t\t\t\t} else {\n\t\t\t\t\t/* the sample does not end in this buffer */\n\n\t\t\t\t\tLog.debug(\"ISOFile\",\"Getting item #\"+item_id+\" extent #\"+i+\" partial data (alreadyRead: \"+extent.alreadyRead+\" offset: \"+\n\t\t\t\t\t\t(extent.offset+extent.alreadyRead - buffer.fileStart)+\" read size: \"+lengthAfterStart+\n\t\t\t\t\t\t\" full extent size: \"+extent.length+\" full item size: \"+item.size+\")\");\n\n\t\t\t\t\tDataStream.memcpy(item.data.buffer, item.alreadyRead, \n\t\t\t\t\t                  buffer, extent.offset+extent.alreadyRead - buffer.fileStart, lengthAfterStart);\n\t\t\t\t\textent.alreadyRead += lengthAfterStart;\n\t\t\t\t\titem.alreadyRead += lengthAfterStart;\n\n\t\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\t\tbuffer.usedBytes += lengthAfterStart;\n\t\t\t\t\tthis.stream.logBufferLevel();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\tif (item.alreadyRead === item.size) {\n\t\t/* fetched entirely */\n\t\treturn item;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n/* Release the memory used to store the data of the item */\nISOFile.prototype.releaseItem = function(item_id) {\t\n\tvar item = this.items[item_id];\n\tif (item.data) {\n\t\tthis.itemsDataSize -= item.size;\n\t\titem.data = null;\n\t\titem.alreadyRead = 0;\n\t\tfor (var i = 0; i < item.extents.length; i++) {\n\t\t\tvar extent = item.extents[i];\n\t\t\textent.alreadyRead = 0;\n\t\t}\n\t\treturn item.size;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\n\nISOFile.prototype.processItems = function(callback) {\n\tfor(var i in this.items) {\n\t\tvar item = this.items[i];\n\t\tthis.getItem(item.id);\n\t\tif (callback && !item.sent) {\n\t\t\tcallback(item);\n\t\t\titem.sent = true;\n\t\t\titem.data = null;\n\t\t}\n\t}\n}\n\nISOFile.prototype.hasItem = function(name) {\n\tfor(var i in this.items) {\n\t\tvar item = this.items[i];\n\t\tif (item.name === name) {\n\t\t\treturn item.id;\n\t\t}\n\t}\n\treturn -1;\n}\n\nISOFile.prototype.getMetaHandler = function() {\n\tif (!this.meta) {\n\t\treturn null;\n\t} else {\n\t\treturn this.meta.hdlr.handler;\t\t\n\t}\n}\n\nISOFile.prototype.getPrimaryItem = function() {\n\tif (!this.meta || !this.meta.pitm) {\n\t\treturn null;\n\t} else {\n\t\treturn this.getItem(this.meta.pitm.item_id);\n\t}\n}\n\nISOFile.prototype.itemToFragmentedTrackFile = function(_options) {\n\tvar options = _options || {};\n\tvar item = null;\n\tif (options.itemId) {\n\t\titem = this.getItem(options.itemId);\n\t} else {\n\t\titem = this.getPrimaryItem();\n\t}\n\tif (item == null) return null;\n\n\tvar file = new ISOFile();\n\tfile.discardMdatData = false;\n\t// assuming the track type is the same as the item type\n\tvar trackOptions = { type: item.type, description_boxes: item.properties.boxes};\n\tif (item.properties.ispe) {\n\t\ttrackOptions.width = item.properties.ispe.image_width;\n\t\ttrackOptions.height = item.properties.ispe.image_height;\n\t}\n\tvar trackId = file.addTrack(trackOptions);\n\tif (trackId) {\n\t\tfile.addSample(trackId, item.data);\n\t\treturn file;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n// file:src/isofile-write.js\n/* Rewrite the entire file */\nISOFile.prototype.write = function(outstream) {\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tthis.boxes[i].write(outstream);\n\t}\n}\n\nISOFile.prototype.createFragment = function(track_id, sampleNumber, stream_) {\n\tvar trak = this.getTrackById(track_id);\n\tvar sample = this.getSample(trak, sampleNumber);\n\tif (sample == null) {\n\t\tsample = trak.samples[sampleNumber];\n\t\tif (this.nextSeekPosition) {\n\t\t\tthis.nextSeekPosition = Math.min(sample.offset+sample.alreadyRead,this.nextSeekPosition);\n\t\t} else {\n\t\t\tthis.nextSeekPosition = trak.samples[sampleNumber].offset+sample.alreadyRead;\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tvar stream = stream_ || new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\n\tvar moof = this.createSingleSampleMoof(sample);\n\tmoof.write(stream);\n\n\t/* adjusting the data_offset now that the moof size is known*/\n\tmoof.trafs[0].truns[0].data_offset = moof.size+8; //8 is mdat header\n\tLog.debug(\"MP4Box\", \"Adjusting data_offset with new value \"+moof.trafs[0].truns[0].data_offset);\n\tstream.adjustUint32(moof.trafs[0].truns[0].data_offset_position, moof.trafs[0].truns[0].data_offset);\n\t\t\n\tvar mdat = new BoxParser.mdatBox();\n\tmdat.data = sample.data;\n\tmdat.write(stream);\n\treturn stream;\n}\n\n/* Modify the file and create the initialization segment */\nISOFile.writeInitializationSegment = function(ftyp, moov, total_duration, sample_duration) {\n\tvar i;\n\tvar index;\n\tvar mehd;\n\tvar trex;\n\tvar box;\n\tLog.debug(\"ISOFile\", \"Generating initialization segment\");\n\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tftyp.write(stream);\n\t\n\t/* we can now create the new mvex box */\n\tvar mvex = moov.add(\"mvex\");\n\tif (total_duration) {\n\t\tmvex.add(\"mehd\").set(\"fragment_duration\", total_duration);\n\t}\n\tfor (i = 0; i < moov.traks.length; i++) {\n\t\tmvex.add(\"trex\").set(\"track_id\", moov.traks[i].tkhd.track_id)\n\t\t\t\t\t\t.set(\"default_sample_description_index\", 1)\n\t\t\t\t\t\t.set(\"default_sample_duration\", sample_duration)\n\t\t\t\t\t\t.set(\"default_sample_size\", 0)\n\t\t\t\t\t\t.set(\"default_sample_flags\", 1<<16)\n\t}\n\tmoov.write(stream);\n\n\treturn stream.buffer;\n\n}\n\nISOFile.prototype.save = function(name) {\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n\tstream.save(name);\t\n}\n\nISOFile.prototype.getBuffer = function() {\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n\treturn stream.buffer;\n}\n\nISOFile.prototype.initializeSegmentation = function() {\n\tvar i;\n\tvar j;\n\tvar box;\n\tvar initSegs;\n\tvar trak;\n\tvar seg;\n\tif (this.onSegment === null) {\n\t\tLog.warn(\"MP4Box\", \"No segmentation callback set!\");\n\t}\n\tif (!this.isFragmentationInitialized) {\n\t\tthis.isFragmentationInitialized = true;\t\t\n\t\tthis.nextMoofNumber = 0;\n\t\tthis.resetTables();\n\t}\t\n\tinitSegs = [];\t\n\tfor (i = 0; i < this.fragmentedTracks.length; i++) {\n\t\tvar moov = new BoxParser.moovBox();\n\t\tmoov.mvhd = this.moov.mvhd;\n\t    moov.boxes.push(moov.mvhd);\n\t\ttrak = this.getTrackById(this.fragmentedTracks[i].id);\n\t\tmoov.boxes.push(trak);\n\t\tmoov.traks.push(trak);\n\t\tseg = {};\n\t\tseg.id = trak.tkhd.track_id;\n\t\tseg.user = this.fragmentedTracks[i].user;\n\t\tseg.buffer = ISOFile.writeInitializationSegment(this.ftyp, moov, (this.moov.mvex && this.moov.mvex.mehd ? this.moov.mvex.mehd.fragment_duration: undefined), (this.moov.traks[i].samples.length>0 ? this.moov.traks[i].samples[0].duration: 0));\n\t\tinitSegs.push(seg);\n\t}\n\treturn initSegs;\n}\n\n// file:src/box-print.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.Box.prototype.printHeader = function(output) {\n\tthis.size += 8;\n\tif (this.size > MAX_SIZE) {\n\t\tthis.size += 8;\n\t}\n\tif (this.type === \"uuid\") {\n\t\tthis.size += 16;\n\t}\n\toutput.log(output.indent+\"size:\"+this.size);\n\toutput.log(output.indent+\"type:\"+this.type);\n}\n\nBoxParser.FullBox.prototype.printHeader = function(output) {\n\tthis.size += 4;\n\tBoxParser.Box.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"version:\"+this.version);\n\toutput.log(output.indent+\"flags:\"+this.flags);\n}\n\nBoxParser.Box.prototype.print = function(output) {\n\tthis.printHeader(output);\n}\n\nBoxParser.ContainerBox.prototype.print = function(output) {\n\tthis.printHeader(output);\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tvar prev_indent = output.indent;\n\t\t\toutput.indent += \" \";\n\t\t\tthis.boxes[i].print(output);\n\t\t\toutput.indent = prev_indent;\n\t\t}\n\t}\n}\n\nISOFile.prototype.print = function(output) {\n\toutput.indent = \"\";\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tthis.boxes[i].print(output);\n\t\t}\n\t}\t\n}\n\nBoxParser.mvhdBox.prototype.print = function(output) {\n\tBoxParser.FullBox.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"creation_time: \"+this.creation_time);\n\toutput.log(output.indent+\"modification_time: \"+this.modification_time);\n\toutput.log(output.indent+\"timescale: \"+this.timescale);\n\toutput.log(output.indent+\"duration: \"+this.duration);\n\toutput.log(output.indent+\"rate: \"+this.rate);\n\toutput.log(output.indent+\"volume: \"+(this.volume>>8));\n\toutput.log(output.indent+\"matrix: \"+this.matrix.join(\", \"));\n\toutput.log(output.indent+\"next_track_id: \"+this.next_track_id);\n}\n\nBoxParser.tkhdBox.prototype.print = function(output) {\n\tBoxParser.FullBox.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"creation_time: \"+this.creation_time);\n\toutput.log(output.indent+\"modification_time: \"+this.modification_time);\n\toutput.log(output.indent+\"track_id: \"+this.track_id);\n\toutput.log(output.indent+\"duration: \"+this.duration);\n\toutput.log(output.indent+\"volume: \"+(this.volume>>8));\n\toutput.log(output.indent+\"matrix: \"+this.matrix.join(\", \"));\n\toutput.log(output.indent+\"layer: \"+this.layer);\n\toutput.log(output.indent+\"alternate_group: \"+this.alternate_group);\n\toutput.log(output.indent+\"width: \"+this.width);\n\toutput.log(output.indent+\"height: \"+this.height);\n}// file:src/mp4box.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar MP4Box = {};\n\nMP4Box.createFile = function (_keepMdatData, _stream) {\n\t/* Boolean indicating if bytes containing media data should be kept in memory */\n\tvar keepMdatData = (_keepMdatData !== undefined ? _keepMdatData : true);\n\tvar file = new ISOFile(_stream);\n\tfile.discardMdatData = (keepMdatData ? false : true);\n\treturn file;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.createFile = MP4Box.createFile;\n}\n","/* eslint-disable no-undef */\nimport MP4Box from 'mp4box';\n\n/**\n * Taken from https://github.com/w3c/webcodecs/blob/main/samples/mp4-decode/mp4_demuxer.js\n */\nclass Writer {\n  constructor(size) {\n    this.data = new Uint8Array(size);\n    this.idx = 0;\n    this.size = size;\n  }\n\n  getData() {\n    if (this.idx !== this.size) throw new Error('Mismatch between size reserved and sized used');\n    return this.data.slice(0, this.idx);\n  }\n\n  writeUint8(value) {\n    this.data.set([value], this.idx);\n    this.idx += 1;\n  }\n\n  writeUint16(value) {\n    const arr = new Uint16Array(1);\n    arr[0] = value;\n    const buffer = new Uint8Array(arr.buffer);\n    this.data.set([buffer[1], buffer[0]], this.idx);\n    this.idx += 2;\n  }\n\n  writeUint8Array(value) {\n    this.data.set(value, this.idx);\n    this.idx += value.length;\n  }\n}\n\n/**\n * Taken from https://github.com/w3c/webcodecs/blob/main/samples/mp4-decode/mp4_demuxer.js\n *\n * @param avccBox\n * @returns {*}\n */\nconst getExtradata = (avccBox) => {\n  let i;\n  let size = 7;\n  for (i = 0; i < avccBox.SPS.length; i += 1) {\n    // nalu length is encoded as a uint16.\n    size += 2 + avccBox.SPS[i].length;\n  }\n  for (i = 0; i < avccBox.PPS.length; i += 1) {\n    // nalu length is encoded as a uint16.\n    size += 2 + avccBox.PPS[i].length;\n  }\n\n  const writer = new Writer(size);\n\n  writer.writeUint8(avccBox.configurationVersion);\n  writer.writeUint8(avccBox.AVCProfileIndication);\n  writer.writeUint8(avccBox.profile_compatibility);\n  writer.writeUint8(avccBox.AVCLevelIndication);\n  // eslint-disable-next-line no-bitwise\n  writer.writeUint8(avccBox.lengthSizeMinusOne + (63 << 2));\n\n  // eslint-disable-next-line no-bitwise\n  writer.writeUint8(avccBox.nb_SPS_nalus + (7 << 5));\n  for (i = 0; i < avccBox.SPS.length; i += 1) {\n    writer.writeUint16(avccBox.SPS[i].length);\n    writer.writeUint8Array(avccBox.SPS[i].nalu);\n  }\n\n  writer.writeUint8(avccBox.nb_PPS_nalus);\n  for (i = 0; i < avccBox.PPS.length; i += 1) {\n    writer.writeUint16(avccBox.PPS[i].length);\n    writer.writeUint8Array(avccBox.PPS[i].nalu);\n  }\n\n  return writer.getData();\n};\n\n/**\n * decodeVideo takes an url to a mp4 file and converts it into frames.\n *\n * The steps for this are:\n *  1. Determine the codec for this video file and demux it into chunks.\n *  2. Read the chunks with VideoDecoder as fast as possible.\n *  3. Return an array of frames that we can efficiently draw to a canvas.\n *\n * @param src\n * @param VideoDecoder\n * @param EncodedVideoChunk\n * @param emitFrame\n * @param debug\n * @returns {Promise<unknown>}\n */\nconst decodeVideo = (src, emitFrame, { VideoDecoder, EncodedVideoChunk, debug }) => new Promise(\n  (resolve, reject) => {\n    if (debug) console.info('Decoding video from', src);\n\n    try {\n      // Uses mp4box for demuxing\n      const mp4boxfile = MP4Box.createFile();\n\n      // Holds the codec value\n      let codec;\n\n      // Creates a VideoDecoder instance\n      const decoder = new VideoDecoder({\n        output: (frame) => {\n          createImageBitmap(frame, { resizeQuality: 'low' })\n            .then((bitmap) => {\n              emitFrame(bitmap);\n              frame.close();\n\n              if (decoder.decodeQueueSize <= 0) {\n                // Give it an extra half second to finish everything\n                setTimeout(() => {\n                  if (decoder.state !== 'closed') {\n                    decoder.close();\n                    resolve();\n                  }\n                }, 500);\n              }\n            });\n        },\n        error: (e) => {\n          // eslint-disable-next-line no-console\n          console.error(e);\n          reject(e);\n        },\n      });\n\n      mp4boxfile.onReady = (info) => {\n        if (info && info.videoTracks && info.videoTracks[0]) {\n          ([{ codec }] = info.videoTracks);\n          if (debug) console.info('Video with codec:', codec);\n\n          // Gets the avccbox used for reading extradata\n          const avccBox = mp4boxfile.moov.traks[0].mdia.minf.stbl.stsd.entries[0].avcC;\n          const extradata = getExtradata(avccBox);\n\n          // configure decoder\n          decoder.configure({ codec, description: extradata });\n\n          // Setup mp4box file for breaking it into chunks\n          mp4boxfile.setExtractionOptions(info.videoTracks[0].id);\n          mp4boxfile.start();\n        } else reject(new Error('URL provided is not a valid mp4 video file.'));\n      };\n\n      mp4boxfile.onSamples = (track_id, ref, samples) => {\n        for (let i = 0; i < samples.length; i += 1) {\n          const sample = samples[i];\n          const type = sample.is_sync ? 'key' : 'delta';\n\n          const chunk = new EncodedVideoChunk({\n            type,\n            timestamp: sample.cts,\n            duration: sample.duration,\n            data: sample.data,\n          });\n\n          decoder.decode(chunk);\n        }\n      };\n\n      // Fetches the file into arraybuffers\n      fetch(src)\n        .then((res) => {\n          const reader = res.body.getReader();\n          let offset = 0;\n\n          function appendBuffers({ done, value }) {\n            if (done) {\n              mp4boxfile.flush();\n              return null;\n            }\n\n            const buf = value.buffer;\n            buf.fileStart = offset;\n            offset += buf.byteLength;\n            mp4boxfile.appendBuffer(buf);\n\n            return reader.read().then(appendBuffers);\n          }\n\n          return reader.read().then(appendBuffers);\n        });\n    } catch (e) {\n      reject(e);\n    }\n  },\n);\n\n/**\n * The main function for decoding video. Deals with the polyfill cases first,\n * then calls our decodeVideo.\n *\n * @param src\n * @param emitFrame\n * @param debug\n * @returns {Promise<never>|Promise<void>|*}\n */\nexport default (src, emitFrame, debug) => {\n  // If our browser supports WebCodecs natively\n  if (typeof VideoDecoder === 'function' && typeof EncodedVideoChunk === 'function') {\n    if (debug) console.info('WebCodecs is natively supported, using native version...');\n    return decodeVideo(src, emitFrame, { VideoDecoder, EncodedVideoChunk, debug });\n  }\n\n  // If our browser doesn't support WebCodecs, but we have a polyfill available\n  if (typeof LibAVWebCodecs === 'object' && typeof LibAVWebCodecs.load === 'function') {\n    if (debug) {\n      console.info(\n        'WebCodecs is not natively supported, but LibAVWebCodecs polyfill detected. Using polyfill...',\n      );\n    }\n    return ((typeof LibAV === 'object') ? LibAV.LibAV() : Promise.resolve())\n      .then(LibAVWebCodecs.load)\n      .then(() => decodeVideo(src, emitFrame, { ...LibAVWebCodecs, debug }));\n  }\n\n  // Otherwise, we do a promise reject\n  return Promise.reject(new Error(\n    'WebCodecs is not available, please try a different browser or supply the LibAVWebCodecs polyfill.',\n  ));\n};\n","<svelte:options tag=\"scrolly-video\" />\n\n<script>\n  import UAParser from 'ua-parser-js';\n  import videoDecoder from './videoDecoder';\n\n  // transitionSpeed sets the upper limit for playbackRate.\n  // Must be a number between >2 and <16.\n  export let transitionspeed = 8;\n\n  // Allows a way to specify display options, for instance adding 'cover'\n  // will tell this component to \"cover\" in its container.\n  export let cover = true;\n  export let sticky = true;\n  export let full = true;\n\n  // Use the WebCodecs API for even better performance, but will only work\n  // if the WebCodecs API is available, either natively in the browser or\n  // via a polyfill (which is not included by default)\n  export let usewebcodecs = false;\n\n  // The src of the video\n  export let src;\n\n  // Allow a debug flag\n  export let debug;\n\n  //Allow custom start height\n  export let startheight = 0;\n  export let endheight = 0;\n\n  // Stop the animation when we are within 0.1 seconds of the target.\n  // Close enough for floating point video shenanigans\n  const frameThreshold = 0.1;\n\n  // variable to hold the DOM video element\n  let video;\n\n  // variable to hold the canvas element\n  let canvas;\n  $: context = canvas && canvas.getContext('2d');\n\n  // number of videoFrames\n  let numVideoFrames = 0;\n  let frameRate = 0;\n\n  // The targetTime in seconds for the video to transition to\n  let targetTime = 0;\n\n  // Video status variables\n  let transitioning = false;\n  let currentTime = 0;\n  let paused = true;\n  let playbackRate = 1;\n  let muted = true;\n\n  // Document status variables\n  let innerHeight = 0;\n  let scrollY = 0;\n\n  // Webcodecs has given us frames for this video, try to go faster\n  const frames = [];\n  const emitFrame = (frame) => { frames.push(frame); };\n\n  // Browser\n  const browserEngine = (new UAParser()).getEngine();\n  // If we want to use WebCodecs to split apart the frames.\n  if (usewebcodecs) {\n    videoDecoder(src, emitFrame, debug).then(() => {\n      const { duration } = video;\n      numVideoFrames = frames.length;\n      frameRate = numVideoFrames / duration;\n      console.log(numVideoFrames)\n      if (debug) console.info('Received', numVideoFrames, 'frames');\n\n      // Waits for canvas to be available, and then draws the initial image.\n      const waitForCanvas = setInterval(() => {\n        if (!canvas) return;\n\n        clearInterval(waitForCanvas);\n        const currFrame = frames[Math.floor(currentTime * frameRate)];\n        if (currFrame) {\n          canvas.width = currFrame.width;\n          canvas.height = currFrame.height;\n          context.drawImage(currFrame, 0, 0, currFrame.width, currFrame.height);\n        }\n      }, 10);\n    });\n  }\n\n  $: {\n    if (video || canvas) {\n    // Use JS to reach up to the shadow root host and set the styles if\n    // this element is supposed to be sticky.\n      const host = (video && video.parentNode.host) || (canvas && canvas.parentNode.host);\n      if (host) {\n        if (sticky) {\n          host.style.display = 'block';\n          host.style.position = 'sticky';\n          host.style.top = '0';\n        }\n\n        if (full) {\n          host.style.width = '100%';\n          host.style.height = '100vh';\n          host.style.overflow = 'hidden';\n        }\n      }\n    }\n  }\n\n  // Recursively transition to the target time\n  const transitionToTargetTime = () => {\n    // If we are already close enough to our target, pause the video and return.\n    // This is the base case of the recursive function\n    if (Math.abs(currentTime - targetTime) < frameThreshold) {\n      paused = true;\n      transitioning = false;\n      return;\n    }\n\n    // Detect safari\n    // eslint-disable-next-line no-undef\n    const isSafari = browserEngine.name === 'WebKit';\n\n    if (canvas) {\n      const transitionForward = targetTime - currentTime;\n      currentTime += transitionForward / (64 / transitionspeed);\n      const currFrame = frames[Math.floor(currentTime * frameRate)];\n      if (currFrame) {\n        canvas.width = currFrame.width;\n        canvas.height = currFrame.height;\n        context.drawImage(currFrame, 0, 0, currFrame.width, currFrame.height);\n      }\n    } else if (isSafari || targetTime - currentTime < 0) {\n      // We can't use a negative playbackRate, so if the video needs to go backwards,\n      // We have to use the inefficient method of modifying currentTime rapidly to\n      // get an effect.\n      paused = true;\n      const transitionForward = targetTime - currentTime;\n      currentTime += transitionForward / (64 / transitionspeed);\n    } else {\n      // Otherwise, we play the video and adjust the playbackRate to get a smoother\n      // animation effect.\n      playbackRate = Math.max(Math.min((targetTime - currentTime) * 4, transitionspeed, 16), 1);\n      paused = false;\n    }\n\n    // Recursively calls ourselves until the animation is done.\n    // eslint-disable-next-line no-undef\n    if (typeof requestAnimationFrame === 'function') { requestAnimationFrame(transitionToTargetTime); }\n  };\n\n  /**\n   * Sets the currentTime as a number of seconds in the video.\n   *\n   * @param setTime\n   */\n  export function setCurrentTime(setTime) {\n    targetTime = Math.max(Math.min(setTime, video.duration), 0);\n    if (transitioning) return;\n    paused = false;\n    transitioning = true;\n    transitionToTargetTime();\n  }\n\n  /**\n   * Sets the currentTime as a percentage of the video duration.\n   *\n   * @param setPercentage\n   */\n  export function setCurrentTimePercent(setPercentage) {\n    targetTime = Math.max(Math.min(setPercentage, 1), 0)\n      * (numVideoFrames / frameRate || video.duration);\n    if (transitioning) return;\n    paused = false;\n    transitioning = true;\n    transitionToTargetTime();\n  }\n\n  // Used for internally setting the scroll percentage based on built-in listeners\n  // TODO make this configurable\n  const updateScrollPercentage = () => {\n    console.log(usewebcodecs, numVideoFrames)\n    const start = parseFloat(startheight)\n    const end = parseFloat(endheight);\n    if (scrollY + innerHeight > start) {\n      const percent = (scrollY - start + innerHeight) / (end - start + innerHeight) * 2\n      console.log(percent)\n      setCurrentTimePercent(percent)\n    } \n  };\n</script>\n\n<style>\n  video {\n    display: block;\n    position: sticky;\n    object-fit: cover;\n  }\n\n  .cover {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    min-width: 101%;\n    min-height: 101%;\n    width: auto;\n    height: 100vh;\n  }\n</style>\n\n<svelte:window on:scroll={updateScrollPercentage} bind:innerHeight bind:scrollY />\n\n{#if usewebcodecs && numVideoFrames}\n  <!--\n  Will automatically switch over to a canvas if using webCodecs\n  and it has finished loading\n  -->\n  <canvas class:cover bind:this={canvas} />\n{:else}\n<!-- preload=\"metadata\" is super important for safari ios! -->\n  <video\n    tabindex=\"0\"\n    preload=\"metadata\"\n    autobuffer\n    playsinline\n    webkit-playsinline\n    class:cover\n    {...$$props}\n    bind:this={video}\n    bind:muted\n    bind:paused\n    bind:currentTime\n    bind:playbackRate\n  />\n{/if}\n"],"names":["noop","assign","tar","src","k","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","exclude_internal_props","props","result","current_component","raf","window","cb","requestAnimationFrame","insert","target","node","anchor","insertBefore","detach","parentNode","removeChild","element","name","document","createElement","empty","data","createTextNode","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","value","removeAttribute","getAttribute","setAttribute","set_attributes","attributes","descriptors","getOwnPropertyDescriptors","__proto__","key","style","cssText","set","toggle_class","toggle","classList","attribute_to_object","set_current_component","component","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","push","seen_callbacks","Set","flushidx","flush","saved_component","length","update","$$","pop","i","callback","has","add","clear","fragment","before_update","dirty","p","ctx","after_update","outroing","make_dirty","then","fill","init","instance","create_fragment","not_equal","append_styles","parent_component","bound","on_mount","on_destroy","on_disconnect","context","Map","callbacks","skip_bound","root","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","c","intro","block","delete","local","customElement","m","new_on_destroy","map","filter","mount_component","SvelteElement","HTMLElement","constructor","super","this","attachShadow","mode","connectedCallback","slotted","appendChild","attributeChangedCallback","_oldValue","newValue","disconnectedCallback","$destroy","detaching","d","destroy_component","$on","type","index","indexOf","splice","$set","$$props","obj","$$set","keys","undefined","FUNC_TYPE","UNDEF_TYPE","OBJ_TYPE","STR_TYPE","MODEL","NAME","TYPE","VENDOR","VERSION","ARCHITECTURE","CONSOLE","MOBILE","TABLET","SMARTTV","WEARABLE","EMBEDDED","AMAZON","APPLE","ASUS","BLACKBERRY","FIREFOX","GOOGLE","HUAWEI","LG","MICROSOFT","MOTOROLA","OPERA","SAMSUNG","SONY","XIAOMI","ZEBRA","FACEBOOK","enumerize","arr","enums","toUpperCase","str1","str2","lowerize","str","toLowerCase","trim","len","replace","substring","rgxMapper","ua","arrays","j","q","matches","match","regex","exec","call","test","strMapper","windowsVersionMap","ME","XP","Vista","RT","regexes","browser","CHROME","cpu","device","engine","EDGE","os","UAParser","extensions","getResult","_ua","navigator","userAgent","_rgxmap","mergedRegexes","concat","extend","getBrowser","version","_browser","major","split","getCPU","_cpu","getDevice","_device","getEngine","_engine","getOS","_os","getUA","setUA","BROWSER","CPU","DEVICE","ENGINE","OS","module","exports","$","jQuery","Zepto","parser","get","prop","start","log_level","logObject","Log","Date","setLogLevel","level","debug","info","warn","error","msg","console","log","getDurationString","duration","_timescale","neg","pad","number","join","duration_sec","hours","Math","floor","minutes","msec","printRanges","ranges","end","MP4BoxStream","arrayBuffer","ArrayBuffer","buffer","dataview","DataView","position","prototype","getPosition","getEndPosition","byteLength","getLength","seek","pos","npos","max","min","isNaN","isFinite","isEos","readAnyInt","size","signed","res","getInt8","getUint8","getInt16","getUint16","getInt32","getUint32","readUint8","readUint16","readUint24","readUint32","readUint64","readString","s","String","fromCharCode","readCString","apply","readInt8","readInt16","readInt32","readInt64","readUint8Array","Uint8Array","readInt16Array","Int16Array","readUint16Array","readUint32Array","Uint32Array","readInt32Array","Int32Array","DataStream","byteOffset","endianness","_byteOffset","dataView","LITTLE_ENDIAN","_realloc","extra","_dynamicSize","req","blen","_buffer","_byteLength","buf","_trimAlloc","dst","BIG_ENDIAN","defineProperty","v","_dataView","isEof","mapUint8Array","e","memcpy","BYTES_PER_ELEMENT","arrayToNative","readInt8Array","Int8Array","Uint16Array","readFloat64Array","Float64Array","readFloat32Array","Float32Array","readFloat32","getFloat32","readFloat64","getFloat64","dstOffset","srcOffset","dstU8","srcU8","array","arrayIsLittleEndian","flipArrayEndianness","nativeToEndian","littleEndian","u8","tmp","failurePosition","fromCharCodeUint8","uint8arr","encoding","TextDecoder","decode","MAX_SIZE","pow","save","filename","blob","Blob","URL","createObjectURL","url","body","click","revokeObjectURL","shift","offset","writeInt32Array","mapInt32Array","writeInt32","writeInt16Array","mapInt16Array","writeInt16","writeInt8Array","mapInt8Array","writeInt8","writeUint32Array","mapUint32Array","writeUint32","writeUint16Array","mapUint16Array","writeUint16","writeUint8Array","writeUint8","writeFloat64Array","mapFloat64Array","writeFloat64","writeFloat32Array","mapFloat32Array","writeFloat32","setInt32","setInt16","setInt8","setUint32","setUint16","setUint8","setFloat32","setFloat64","writeUCS2String","lengthOverride","charCodeAt","writeString","TextEncoder","encode","writeCString","writeStruct","structDefinition","struct","t","writeType","tp","charset","parseInt","ta","writeUint64","h","writeUint24","adjustUint32","MultiBufferStream","buffers","bufferIndex","insertBuffer","initialized","firstBuffer","fileStart","logBufferLevel","buffer1","buffer2","reduceBuffer","newLength","smallB","usedBytes","ab","to_add","used","total","range","bufferedString","cleanBuffers","mergeNextBuffer","next_buffer","oldLength","oldUsedBytes","oldFileStart","findPosition","fromStart","filePosition","markAsUsed","abuffer","findEndContiguousBuf","inputindex","currentBuf","nextBuf","getEndFilePositionAfter","addUsedBytes","nbBytes","setAllUsedBytes","MPEG4DescriptorParser","descTagToName","getDescriptorName","tag","that","classes","parseOneDescriptor","stream","desc","byteRead","Descriptor","parse","_tag","_size","descs","findDescriptor","parseRemainingDescriptors","ES_Descriptor","ES_ID","flags","dependsOn_ES_ID","OCR_ES_ID","getOTI","dcd","oti","getAudioConfig","dsi","audioObjectType","DecoderConfigDescriptor","streamType","bufferSize","maxBitrate","avgBitrate","DecoderSpecificInfo","SLConfigDescriptor","BoxParser","ERR_INVALID_DATA","ERR_NOT_ENOUGH_DATA","OK","BASIC_BOXES","FULL_BOXES","CONTAINER_BOXES","boxCodes","fullBoxCodes","containerBoxCodes","sampleEntryCodes","sampleGroupEntryCodes","trackGroupTypes","UUIDBoxes","UUIDs","initialize","FullBox","Box","ContainerBox","SampleEntry","TrackGroupTypeBox","createBoxCtor","createFullBoxCtor","types","createContainerBoxCtor","_type","_uuid","uuid","boxes","hdr_size","SampleGroupEntry","grouping_type","parseMethod","parseFullHeader","addSubBoxArrays","subBoxNames","nbSubBoxes","createMediaSampleEntryCtor","mediaType","createSampleEntryCtor","createEncryptedSampleEntryCtor","createSampleGroupCtor","createTrackGroupCtor","createUUIDBox","isFullBox","isContainerBox","TKHD_FLAG_ENABLED","TKHD_FLAG_IN_MOVIE","TKHD_FLAG_IN_PREVIEW","TFHD_FLAG_BASE_DATA_OFFSET","TFHD_FLAG_SAMPLE_DESC","TFHD_FLAG_SAMPLE_DUR","TFHD_FLAG_SAMPLE_SIZE","TFHD_FLAG_SAMPLE_FLAGS","TFHD_FLAG_DUR_EMPTY","TFHD_FLAG_DEFAULT_BASE_IS_MOOF","TRUN_FLAGS_DATA_OFFSET","TRUN_FLAGS_FIRST_FLAG","TRUN_FLAGS_DURATION","TRUN_FLAGS_SIZE","TRUN_FLAGS_FLAGS","TRUN_FLAGS_CTS_OFFSET","addBox","box","addEntry","_prop","parseUUID","parseHex16","hex16","hex","toString","parseOneBox","headerOnly","parentSize","diff","code","box_type","has_unparsed_data","write","parseDataAndRewind","parseLanguage","language","chars","languageString","SAMPLE_ENTRY_TYPE_VISUAL","SAMPLE_ENTRY_TYPE_AUDIO","SAMPLE_ENTRY_TYPE_HINT","SAMPLE_ENTRY_TYPE_METADATA","SAMPLE_ENTRY_TYPE_SUBTITLE","SAMPLE_ENTRY_TYPE_SYSTEM","SAMPLE_ENTRY_TYPE_TEXT","parseHeader","data_reference_index","parseFooter","compressorname_length","width","height","horizresolution","vertresolution","frame_count","compressorname","depth","channel_count","samplesize","samplerate","FieldLength","layer_size","op_index","aux_type","aux_subtype_length","aux_subtype","seq_profile","seq_level_idx_0","seq_tier_0","high_bitdepth","twelve_bit","monochrome","chroma_subsampling_x","chroma_subsampling_y","chroma_sample_position","reserved_1","initial_presentation_delay_present","initial_presentation_delay_minus_one","reserved_2","configOBUs_length","configOBUs","toparse","configurationVersion","AVCProfileIndication","profile_compatibility","AVCLevelIndication","lengthSizeMinusOne","nb_SPS_nalus","SPS","nalu","nb_PPS_nalus","PPS","ext","bufferSizeDB","cleanApertureWidthN","cleanApertureWidthD","cleanApertureHeightN","cleanApertureHeightD","horizOffN","horizOffD","vertOffN","vertOffD","max_content_light_level","max_pic_average_light_level","entry_count","chunk_offsets","maxCLL","maxFALL","colour_type","colour_primaries","transfer_characteristics","matrix_coefficients","full_range_flag","ICC_profile","notice","compositionToDTSShift","leastDecodeToDisplayDelta","greatestDecodeToDisplayDelta","compositionStartTime","compositionEndTime","sample_counts","sample_offsets","tmp_byte1","tmp_byte2","tmp_byte3","fscod","bsid","bsmod","acmod","lfeon","bit_rate_code","tmp_16","data_rate","num_ind_sub","ind_subs","ind_sub","num_dep_sub","chan_loc","boxesFound","knownBlockTypes","flagAndType","numMetadataBlocks","bytessent","time","entries","extended_language","entry","segment_duration","media_time","media_rate_integer","media_rate_fraction","timescale","presentation_time","event_duration","id","scheme_id_uri","presentation_time_delta","message_size","message_data","esd_data","esd_parser","esd","fieldCount","fieldOrdering","data_format","major_brand","minor_version","compatible_brands","slice","tmp_byte","general_profile_space","general_tier_flag","general_profile_idc","general_profile_compatibility","general_constraint_indicator","general_level_idc","min_spatial_segmentation_idc","parallelismType","chroma_format_idc","bit_depth_luma_minus8","bit_depth_chroma_minus8","avgFrameRate","constantFrameRate","numTemporalLayers","temporalIdNested","nalu_arrays","numOfArrays","nalu_array","completeness","nalu_type","numNalus","item_infos","byte","offset_size","length_size","base_offset_size","index_size","items","item_count","item","item_ID","construction_method","base_offset","extent_count","extents","extent","extent_index","extent_offset","extent_length","reserved","axis","item_protection_index","item_name","content_type","content_encoding","extension_type","item_type","item_uri_type","associations","item_assoc","association_count","essential","property_index","references","SingleItemTypeReferenceBox","SingleItemTypeReferenceBoxLarge","angle","image_width","image_height","schemeURI","count","levels","track_ID","padding_flag","assignment_type","grouping_type_parameter","sub_track_id","layer_id","period","bytes","display_primaries","x","y","white_point","max_display_mastering_luminance","min_display_mastering_luminance","creation_time","modification_time","fragment_duration","sequence_number","rate","volume","matrix","next_track_id","packetssent","sample_count","padbits","hSpacing","vSpacing","text","payloadID","rtpmap_string","initial_delay","item_id","num_channels","bits_per_channels","ref_track_id","ntp_timestamp","system_id","kid","datasize","descriptionformat","sdptext","aux_info_type","aux_info_type_parameter","default_sample_info_size","sample_info_size","mime_format","namespace","schema_location","auxiliary_mime_types","displayFlags","horizontal_justification","vertical_justification","bg_color_rgba","box_record","style_record","roll_count","first_output_sample","sample_offset","remaining","description_length","num_output_samples","num_total_samples","layerNumber","accurateStatisticsFlag","avgBitRate","subSequenceIdentifier","durationFlag","avgRateFlag","dependency","numReferences","dependencyInfo","subSeqDirectionFlag","roll_distance","num_leading_samples_known","num_leading_samples","operation_point_count","target_rate_share","available_bitrate","maximum_bitrate","minimum_bitrate","discard_priority","crypt_byte_block","skip_byte_block","isProtected","Per_Sample_IV_Size","KID","constant_IV_size","constant_IV","NAL_unit_type","level_independently_decodable","group_description_index","scheme_type","scheme_version","scheme_uri","is_leading","sample_depends_on","sample_is_depended_on","sample_has_redundancy","default_length","default_group_description_index","reference_ID","earliest_presentation_time","first_offset","ref","tmp_32","reference_type","referenced_size","subsegment_duration","starts_with_SAP","SAP_type","SAP_delta_time","from_item_ID","primaryRChromaticity_x","primaryRChromaticity_y","primaryGChromaticity_x","primaryGChromaticity_y","primaryBChromaticity_x","primaryBChromaticity_y","whitePointChromaticity_x","whitePointChromaticity_y","luminanceMax","luminanceMin","balance","subsegments","subsegment_count","subsegment","range_count","range_size","priority","switch_group","alternate_group","attribute_list","first_chunk","samples_per_chunk","sample_description_index","entryCount","shadowed_sample_numbers","sync_sample_numbers","sample_numbers","sample_sizes","sample_size","delta","sample_deltas","tmp32","single_view_allowed","stereo_scheme","stereo_indication_type","ftypBox","field_size","subsample_count","sampleInfo","sample_delta","subsamples","subsample","discardable","codec_specific_parameters","default_crypt_byte_block","default_skip_byte_block","default_isProtected","default_Per_Sample_IV_Size","default_KID","default_constant_IV_size","default_constant_IV","baseMediaDecodeTime","readBytes","track_id","base_data_offset","default_sample_description_index","default_sample_duration","default_sample_size","default_sample_flags","length_size_of_traf_num","length_size_of_trun_num","length_size_of_sample_num","number_of_entries","moof_offset","traf_number","trun_number","sample_number","layer","track_group_id","TrackReferenceTypeBox","track_ids","trefBox","data_offset","first_sample_flags","sample_duration","sample_flags","sample_composition_time_offset","config","location","LiveServerManifest","default_AlgorithmID","default_IV_size","fragment_count","absolute_time","absolute_duration","graphicsmode","opcolor","profile","bitDepth","chromaSubsampling","videoFullRangeFlag","colourPrimaries","transferCharacteristics","matrixCoefficients","codecIntializationDataSize","codecIntializationData","colorSpace","transferFunction","isVideo","isAudio","isSubtitle","isMetadata","isHint","getCodec","getWidth","getHeight","getChannelCount","getSampleRate","getSampleSize","VisualSampleEntry","AudioSampleEntry","SubtitleSampleEntry","MetadataSampleEntry","decimalToHex","padding","Number","avc1SampleEntry","avc2SampleEntry","avc3SampleEntry","avc4SampleEntry","baseCodec","avcC","hev1SampleEntry","hvc1SampleEntry","hvcC","val","reversed","hasByte","constraint_string","mp4aSampleEntry","esds","stxtSampleEntry","av01SampleEntry","bitdepth","av1C","writeHeader","sizePosition","avcCBox","co64Box","cslgBox","cttsBox","drefBox","elngBox","elstBox","emsgBox","hdlrBox","kindBox","mdhdBox","mehdBox","mfhdBox","mvhdBox","writeFooter","stppSampleEntry","sbgpBox","sgpdBox","sidxBox","stcoBox","stscBox","stsdBox","stshBox","stssBox","stszBox","constant","sttsBox","tfdtBox","UINT32_MAX","tfhdBox","tkhdBox","trexBox","trunBox","data_offset_position","vmhdBox","unpack","samples","pts","dts","Infinity","description_index","chunk_index","DIFF_BOXES_PROP_NAMES","DIFF_PRIMITIVE_ARRAY_PROP_NAMES","boxEqualFields","box_a","box_b","boxEqual","XMLSubtitlein4Parser","parseSample","sample","resources","documentString","DOMParser","parseFromString","Textin4Parser","parseConfig","ISOFile","mdats","moofs","isProgressive","moovStartFound","onMoovStart","moovStartSent","onReady","readySent","onSegment","onSamples","onError","sampleListBuilt","fragmentedTracks","extractedTracks","isFragmentationInitialized","sampleProcessingStarted","nextMoofNumber","itemListBuilt","onSidx","sidxSent","setSegmentOptions","user","trak","getTrackById","fragTrack","nextSample","segmentStream","nb_samples","rapAlignement","nbSamples","unsetSegmentOptions","setExtractionOptions","extractTrack","unsetExtractionOptions","restoreParsePosition","hasIncompleteMdat","processIncompleteMdat","saveParsePosition","processIncompleteBox","updateUsedBytes","checkBuffer","appendBuffer","last","nextFileStart","moov","buildSampleLists","updateSampleLists","getInfo","processSamples","nextSeekPosition","nextParsePosition","sidx","meta","flattenItemInfo","processItems","onItem","getAllocatedSampleDataSize","track","sample_desc","movie","_1904","getTime","hasMoov","mvhd","isFragmented","mvex","mehd","hasIOD","iods","brands","ftyp","created","modified","tracks","audioTracks","videoTracks","subtitleTracks","metadataTracks","hintTracks","otherTracks","traks","mdia","minf","stbl","stsd","tkhd","hdlr","tref","edts","edits","elst","movie_duration","movie_timescale","track_width","track_height","mdhd","cts_shift","cslg","samples_duration","codec","kind","udta","kinds","elng","samples_size","bitrate","audio","sample_rate","video","mime","fragTrak","createFragment","extractTrak","getSample","getBox","getBoxes","returnEarly","_sweep","getTrackSamplesInfo","getTrackSample","releaseUsedSamples","sampleNum","lastValidSample","releaseSample","samplesDataSize","stop","seekTrack","useRap","seek_offset","rap_seek_sample_num","seek_sample_num","cts","is_sync","alreadyRead","trak_seek_info","seek_info","equal","box_index","a_box","b_box","lastBoxStartPosition","parsingMdat","discardMdatData","_options","addTrack","media_duration","sample_description_entry","media_type","codes","avcDecoderConfigRecord","description","description_boxes","buildTrakSampleLists","computeSize","stream_","addSample","depends_on","is_depended_on","has_redundancy","degradation_priority","first_dts","moof","createSingleSampleMoof","trafs","truns","moofBox","traf","lastMoofIndex","resetTables","stsc","stts","ctts","stss","initial_duration","stco","co64","stsz","stz2","initSampleGroups","sbgps","trak_sgpds","traf_sgpds","sample_group_info","sample_group_key","SampleGroupInfo","_parameter","_sbgp","sbgp","last_sample_in_run","entry_index","sample_groups_info","fragment_description","is_fragment","setSampleGroupProperties","sample_groups","process_sdtp","sdtp","subs","sgpds","stdp","chunk_run_index","last_chunk_in_run","offset_in_chunk","last_sample_in_chunk","last_sample_in_stts_run","stts_run_index","last_sample_in_ctts_run","ctts_run_index","last_stss_index","subs_entry_index","last_subs_sample_index","last_run_position","trex","tfhd","getTrexById","trun","moof_number","number_in_traf","first_sample_index","first_traf_merged","tfdt","bdop","dbim","dop","bdo","has_fragment_subsamples","sample_index","lengthAfterStart","getCodecs","codecs","trexs","itemsDataSize","iinf","ref_to","protection_index","protection","ipro","protections","iloc","itemloc","source","dinf","pitm","primary","iref","iprp","ipmas","ipma","association","properties","propEntry","ipco","propbox","getItem","releaseItem","sent","hasItem","getMetaHandler","getPrimaryItem","itemToFragmentedTrackFile","itemId","file","trackOptions","ispe","trackId","outstream","sampleNumber","mdat","mdatBox","writeInitializationSegment","total_duration","getBuffer","initializeSegmentation","initSegs","seg","moovBox","printHeader","output","indent","print","prev_indent","MP4Box","_keepMdatData","_stream","keepMdatData","createFile","Writer","idx","getData","Error","decodeVideo","emitFrame","VideoDecoder","EncodedVideoChunk","reject","mp4boxfile","decoder","frame","createImageBitmap","resizeQuality","bitmap","close","decodeQueueSize","setTimeout","state","extradata","avccBox","writer","getExtradata","configure","chunk","timestamp","fetch","reader","getReader","read","appendBuffers","done","updates","to_null_out","accounted_for","$$scope","o","n","canvas","transitionspeed","cover","sticky","full","usewebcodecs","startheight","endheight","numVideoFrames","frameRate","targetTime","transitioning","currentTime","paused","playbackRate","muted","innerHeight","scrollY","frames","browserEngine","LibAVWebCodecs","load","LibAV","videoDecoder","waitForCanvas","setInterval","clearInterval","currFrame","drawImage","transitionToTargetTime","abs","isSafari","setCurrentTimePercent","setPercentage","getContext","host","display","top","overflow","parseFloat","percent","setTime"],"mappings":"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"}